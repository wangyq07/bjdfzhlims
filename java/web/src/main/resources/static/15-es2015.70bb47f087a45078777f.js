(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"873N":function(t,e,s){"use strict";s.d(e,"a",(function(){return r}));var i=s("ofXK"),n=s("fXoL");let r=(()=>{class t{}return t.\u0275mod=n.Gb({type:t}),t.\u0275inj=n.Fb({factory:function(e){return new(e||t)},imports:[[i.c]]}),t})()},MOn6:function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));var i=s("XNiG"),n=s("3pM9"),r=s("1G5W"),c=s("ofXK"),o=s("fXoL");let a=(()=>{class t{constructor(t,e,s){this.elementRef=t,this.renderer=e,this.doc=s,this.outerHeight=0,this._unSubject=new i.a}ngAfterViewInit(){this.setSubject()}ngOnDestroy(){var t;this._unSubject.next(),this._unSubject.unsubscribe(),null===(t=this._resizeObserver)||void 0===t||t.disconnect()}setSubject(){Object(n.A)(this.container,this.doc.documentElement).pipe(Object(r.a)(this._unSubject)).subscribe(t=>{this._resizeObserver=t.resizeObserver,this.setAdaptionHeight()})}setAdaptionHeight(){this.renderer.setStyle(this.elementRef.nativeElement,"height",this.doc.documentElement.clientHeight-this.outerHeight+"px")}}return t.\u0275fac=function(e){return new(e||t)(o.Ib(o.l),o.Ib(o.D),o.Ib(c.e))},t.\u0275dir=o.Db({type:t,selectors:[["","au-adaption",""]],inputs:{outerHeight:"outerHeight",container:"container"}}),t})()},aMyR:function(t,e,s){"use strict";s.d(e,"a",(function(){return g}));var i=s("ofXK"),n=s("gjGi"),r=s("GvSL"),c=s("oJeN"),o=s("/pOC"),a=s("l5Yv"),b=s("qN0K"),u=s("4h90"),h=s("P0lq"),d=s("Prn+"),l=s("hHlV"),p=s("873N"),m=s("iaau"),f=s("fXoL");let g=(()=>{class t{}return t.\u0275mod=f.Gb({type:t}),t.\u0275inj=f.Fb({factory:function(e){return new(e||t)},imports:[[i.c,n.a,r.b,l.a,p.a,m.a,c.b,o.b,a.b,b.b,u.b,h.b,d.b],i.c]}),t})()},iaau:function(t,e,s){"use strict";s.d(e,"a",(function(){return n}));var i=s("fXoL");let n=(()=>{class t{}return t.\u0275mod=i.Gb({type:t}),t.\u0275inj=i.Fb({factory:function(e){return new(e||t)}}),t})()},jA2P:function(t,e,s){"use strict";s.r(e),s.d(e,"ContactauditModule",(function(){return L}));var i=s("ofXK"),n=s("tyNb"),r=s("wTjX"),c=s("TPaT"),o=s("pDPc"),a=s("LZRM"),b=s("Puy/"),u=s("K7LP"),h=s("rdXg"),d=s("ZnW5"),l=s("BzWU"),p=s("fXoL"),m=s("qMpK"),f=s("SfH5"),g=s("GvSL"),x=s("MOn6");const O=["iframeprint"],C=["tablecom"];function y(t,e){if(1&t&&(p.Ob(0,"td"),p.xc(1),p.Nb()),2&t){const t=p.Yb().$implicit;p.zb("rowspan",t.projectrowspan),p.yb(1),p.yc(t.projectname)}}function v(t,e){if(1&t&&(p.Ob(0,"td"),p.xc(1),p.Nb()),2&t){const t=p.Yb().$implicit;p.zb("rowspan",t.projectrowspan),p.yb(1),p.yc(t.reportcount)}}function N(t,e){if(1&t&&(p.Ob(0,"td"),p.xc(1),p.Nb()),2&t){const t=p.Yb().$implicit;p.zb("rowspan",t.projectrowspan),p.yb(1),p.yc(t.domain)}}function w(t,e){if(1&t&&(p.Ob(0,"td"),p.xc(1),p.Nb()),2&t){const t=p.Yb().$implicit;p.zb("rowspan",t.samplerowspan),p.yb(1),p.yc(t.samplename)}}function j(t,e){if(1&t&&(p.Ob(0,"td"),p.xc(1),p.Nb()),2&t){const t=p.Yb().$implicit;p.zb("rowspan",t.samplerowspan),p.yb(1),p.yc(t.sampleprice)}}function M(t,e){if(1&t&&(p.Ob(0,"tr"),p.vc(1,y,2,2,"td",19),p.vc(2,v,2,2,"td",19),p.vc(3,N,2,2,"td",19),p.vc(4,w,2,2,"td",19),p.vc(5,j,2,2,"td",19),p.Ob(6,"td"),p.xc(7),p.Nb(),p.Ob(8,"td"),p.xc(9),p.Nb(),p.Ob(10,"td"),p.xc(11),p.Nb(),p.Ob(12,"td"),p.xc(13),p.Nb(),p.Ob(14,"td"),p.xc(15),p.Nb(),p.Nb()),2&t){const t=e.$implicit,s=e.index;p.yb(1),p.ec("ngIf",t.projectindex==s),p.yb(1),p.ec("ngIf",t.projectindex==s),p.yb(1),p.ec("ngIf",t.projectindex==s),p.yb(1),p.ec("ngIf",t.sampleindex==s),p.yb(1),p.ec("ngIf",t.sampleindex==s),p.yb(2),p.yc(t.testproject),p.yb(2),p.yc(t.standardname),p.yb(2),p.yc(t.price),p.yb(2),p.yc(t.extern),p.yb(2),p.yc(t.testcount)}}const P=[{path:"",component:(()=>{class t extends u.a{constructor(t,e,s,i,n,r,c,o){super(t),this.indexService=t,this.flowservice=e,this.roleauditservice=s,this.contactservice=i,this.actroute=n,this.router=r,this.globalaudit=c,this.msg=o,this.index=1,this.submitdisable=!1,this.size=1e4,this.total=0,this.query={},this.columns=[{id:"index",label:"\u5e8f\u53f7",width:80,type:"index"},{id:"name",label:"\u4efb\u52a1",width:100,sort:!0},{id:"customername",label:"\u5ba2\u6237",width:150,sort:!0},{id:"preuser",label:"\u524d\u7f6e\u5904\u7406\u4eba",width:200,sort:!0},{id:"createtime",label:"\u521b\u5efa\u65e5\u671f",width:200,sort:!0},{id:"from",label:"\u4e0a\u4e00\u8282\u70b9",width:100,sort:!0}],this.taskid="",this.delegatecustomer="",this.testcustomer="",this.paycustomer="",this.servicetype="",this.ispanding="",this.seal="",this.reportcount=2,this.samplesource="",this.businessfee=0,this.collectionfee=0,this.testfee=0,this.standfee=0,this.externfee=0,this.discount=0,this.totalfee=0,this.showprice=!1,this.showtablecel="none",this.auditaddvice="",this.projects=[],this.currenttask={},this.CurrentContact={},this.sampledata=[],null==n?this.getData():n.params.subscribe(t=>{this.taskid=t.taskid,this.getData()});for(var a=0;a<t.auth.user.organizations.length;a++)if(1==t.auth.user.organizations[a].checkprice){this.showprice=!0,this.showtablecel="table-cell";break}}acction(t){this.roleauditservice.getauditvariable(this.indexService.auth.user.roles,t,this.auditaddvice).subscribe(t=>{var e=this.currenttask;null!=e&&(t.username=this.indexService.auth.user.name,t.userid=this.indexService.auth.user.id,t.contactid=e.contactid,t.qupricediscount=this.CurrentContact.discount,t.customername=e.customername,t.standardfee=this.CurrentContact.standardfee,t.roles=this.indexService.auth.user.roles,this.flowservice.excutetask(e.taskid+"",t).subscribe(t=>{this.cleardata(),this.msg.success("\u63d0\u4ea4\u6210\u529f"),this.submitdisable=!0}))})}ngAfterViewInit(){}ngOnInit(){}getroundvalue(t,e){var s=Math.round(t/e*100)/100;return null!=this.CurrentContact&&(this.CurrentContact.standardfee=e,this.CurrentContact.discount=s),s}cleardata(){this.projects=[],this.servicetype="",this.seal="",this.samplesource="",this.delegatecustomer="",this.paycustomer="",this.testcustomer="",this.standfee=0,this.totalfee=0,this.testfee=0,this.discount=0,this.externfee=0,this.businessfee=0,this.sampledata=[]}setproject(t){this.currenttask=t,this.cleardata(),this.contactservice.getcontactproject(t.contactid+"").subscribe(t=>{var e,s;if(this.CurrentContact=t.contact,this.projects=t.projects,this.iframe.setprojects(this.projects,this.CurrentContact),null!=this.CurrentContact&&null!=this.CurrentContact.contactcustomers){this.delegatecustomer="",this.testcustomer="",this.paycustomer="";var i=this.CurrentContact.contactcustomers.filter(t=>1==t.customertype);if(i.length>0)for(var n=0;n<i.length;n++)0!=n&&(this.delegatecustomer=this.delegatecustomer+","),this.delegatecustomer=this.delegatecustomer+i[n].customername;var r=this.CurrentContact.contactcustomers.find(t=>2==t.customertype);if(this.paycustomer=(null==r?void 0:r.customername)+"",r=this.CurrentContact.contactcustomers.find(t=>3==t.customertype),this.testcustomer=(null==r?void 0:r.customername)+"",this.servicetype="",this.servicetype=(null===(e=this.CurrentContact.service)||void 0===e?void 0:e.label)+"",this.ispanding=1==this.CurrentContact.isjudgement?"\u662f":"\u5426",this.seal="",null!=this.CurrentContact.seal)for(n=0;n<this.CurrentContact.seal.length;n++)this.seal=this.seal+this.CurrentContact.seal[n].label+",";this.samplesource=(null===(s=this.CurrentContact.samplesource)||void 0===s?void 0:s.label)+"",this.businessfee=Number(this.CurrentContact.businessfee),this.collectionfee=Number(this.CurrentContact.collectionfee),this.testfee=Number(this.CurrentContact.testfee),this.standfee=Number(this.CurrentContact.standardfee),this.discount=Number(this.CurrentContact.discount),this.totalfee=Number(this.CurrentContact.totalfee),this.externfee=Number(this.CurrentContact.externfee)}console.log(this.projects),this.sampledata=l.a.getMareData(this.projects,this.ispanding)})}genera(t){this.contactservice.updateprojectnumer(this.CurrentContact.id+"",this.standfee).subscribe(t=>{this.sampledata=l.a.getMareData(t.projects,this.ispanding),this.iframe.setprojects(t.projects,t.contact),setTimeout(()=>{h({printable:"iframeprint",type:"html",maxWidth:"98%",targetStyles:["*"],style:"@media print{@page {size:portrait}}"})},10*t.projects.length)})}sendcomplete(){h("iframeprint","html")}activatedRow(t){this.setproject(t)}getData(){null!=this.indexService.auth.user.roles&&this.flowservice.getTaskListByRoleId(this.indexService.auth.user.roles).subscribe(t=>{if([this.data,this.total]=[t.list.filter(t=>"task_customerserviceaudit"==t.taskdefinid),t.list.length],null!=this.taskid&&""!=this.taskid){var e=this.data.findIndex(t=>t.taskid==this.taskid);-1!=e&&this.setproject(this.data[e])}})}indexChange(t){this.index=t,this.getData()}sortChange(t){this.query.sort=t,this.getData()}}return t.\u0275fac=function(e){return new(e||t)(p.Ib(r.a),p.Ib(c.a),p.Ib(o.a),p.Ib(a.a),p.Ib(n.a),p.Ib(n.e),p.Ib(b.a),p.Ib(m.c))},t.\u0275cmp=p.Cb({type:t,selectors:[["app-contactaudit"]],viewQuery:function(t,e){var s;1&t&&(p.Cc(O,!0),p.Cc(C,!0)),2&t&&(p.jc(s=p.Wb())&&(e.iframe=s.first),p.jc(s=p.Wb())&&(e.tablecom=s.first))},features:[p.vb],decls:76,vars:20,consts:[["span","24"],["au-adaption","",1,"au-panel","au-content",3,"outerHeight"],[2,"height","20px"],["span","5"],["icon","ado-check","plain","","type","primary",2,"color","green",3,"disabled","click"],["icon","ado-check","plain","","type","primary",2,"color","green",3,"click"],["span","12"],["span","6"],["span","4"],[2,"height","20"],[3,"hidden"],["id","sampledata","border","1",2,"height","100%","width","100%"],[2,"width","10%","text-align","center"],[2,"width","5%","text-align","center"],[2,"width","40%","text-align","center"],[4,"ngFor","ngForOf"],[2,"display","none"],["id","iframeprint",2,"width","100%","height","100%",3,"sendcomplete"],["iframeprint",""],[4,"ngIf"]],template:function(t,e){1&t&&(p.Ob(0,"x-row"),p.Ob(1,"x-col",0),p.Ob(2,"div",1),p.Jb(3,"x-row",2),p.Ob(4,"x-row"),p.Ob(5,"x-col",3),p.Ob(6,"x-button",4),p.Vb("click",(function(){return e.acction(1)})),p.xc(7,"\u63d0\u4ea4"),p.Nb(),p.Nb(),p.Ob(8,"x-col",3),p.Ob(9,"x-button",5),p.Vb("click",(function(){return e.genera(1)})),p.xc(10,"\u751f\u6210\u534f\u8bae\u4e66"),p.Nb(),p.Nb(),p.Nb(),p.Jb(11,"x-row",2),p.Ob(12,"x-row"),p.Ob(13,"x-col",6),p.xc(14),p.Nb(),p.Ob(15,"x-col",7),p.xc(16),p.Nb(),p.Ob(17,"x-col",7),p.xc(18),p.Nb(),p.Nb(),p.Jb(19,"x-row",2),p.Ob(20,"x-row"),p.Ob(21,"x-col",8),p.xc(22),p.Nb(),p.Ob(23,"x-col",8),p.xc(24),p.Nb(),p.Ob(25,"x-col",8),p.xc(26),p.Nb(),p.Ob(27,"x-col",8),p.xc(28),p.Nb(),p.Nb(),p.Jb(29,"x-row",9),p.Ob(30,"x-row",10),p.Ob(31,"x-col",8),p.xc(32),p.Nb(),p.Ob(33,"x-col",8),p.xc(34),p.Nb(),p.Ob(35,"x-col",8),p.xc(36),p.Nb(),p.Ob(37,"x-col",8),p.xc(38),p.Nb(),p.Nb(),p.Ob(39,"x-row"),p.Ob(40,"x-col",8),p.xc(41),p.Nb(),p.Ob(42,"x-col",8),p.xc(43),p.Nb(),p.Ob(44,"x-col",8),p.xc(45),p.Nb(),p.Nb(),p.Jb(46,"x-row",2),p.Ob(47,"x-row"),p.Ob(48,"x-col",0),p.Ob(49,"table",11),p.Ob(50,"thead"),p.Ob(51,"td",12),p.xc(52,"\u9879\u76ee"),p.Nb(),p.Ob(53,"td",13),p.xc(54,"\u62a5\u544a"),p.Nb(),p.Ob(55,"td",12),p.xc(56,"\u9886\u57df"),p.Nb(),p.Ob(57,"td",12),p.xc(58,"\u6837\u54c1"),p.Nb(),p.Ob(59,"td",13),p.xc(60,"\u68c0\u6d4b\u8d39"),p.Nb(),p.Ob(61,"td",12),p.xc(62,"\u68c0\u6d4b\u9879\u76ee"),p.Nb(),p.Ob(63,"td",14),p.xc(64,"\u68c0\u6d4b\u6807\u51c6"),p.Nb(),p.Ob(65,"td",13),p.xc(66,"\u6807\u51c6\u8d39\u7528"),p.Nb(),p.Ob(67,"td",13),p.xc(68,"\u5916\u5305"),p.Nb(),p.Ob(69,"td",13),p.xc(70,"\u6b21\u6570"),p.Nb(),p.Nb(),p.vc(71,M,16,10,"tr",15),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Ob(72,"x-row"),p.Ob(73,"div",16),p.Ob(74,"app-outputlist",17,18),p.Vb("sendcomplete",(function(){return e.sendcomplete()})),p.Nb(),p.Nb(),p.Nb()),2&t&&(p.yb(2),p.ec("outerHeight",50),p.yb(4),p.ec("disabled",e.submitdisable),p.yb(8),p.zc("\u59d4\u6258\u5ba2\u6237:",e.delegatecustomer,""),p.yb(2),p.zc("\u4ed8\u6b3e\u5ba2\u6237:",e.paycustomer,""),p.yb(2),p.zc("\u53d7\u68c0\u5ba2\u6237:",e.testcustomer,""),p.yb(4),p.zc("\u6837\u54c1\u6765\u6e90:",e.samplesource,""),p.yb(2),p.zc("\u662f\u5426\u5224\u5b9a:",e.ispanding,""),p.yb(2),p.zc("\u8d44\u8d28\u76d6\u7ae0:",e.seal,""),p.yb(2),p.zc("\u670d\u52a1\u7c7b\u578b:",e.servicetype,""),p.yb(2),p.ec("hidden",e.showprice),p.yb(2),p.zc("\u603b\u8d39\u7528:",e.totalfee,""),p.yb(2),p.zc("\u4e1a\u52a1\u8d39:",e.businessfee,""),p.yb(2),p.zc("\u91c7\u6837\u8d39:",e.collectionfee,""),p.yb(2),p.zc("\u5916\u5305\u8d39:",e.externfee,""),p.yb(3),p.zc("\u6210\u4ea4\u4ef7\u683c:",e.testfee,""),p.yb(2),p.zc("\u6807\u51c6\u68c0\u6d4b\u8d39:",e.standfee,""),p.yb(2),p.zc("\u6298\u6263:",e.getroundvalue(e.testfee,e.standfee),""),p.yb(14),p.sc("display",e.showtablecel),p.yb(12),p.ec("ngForOf",e.sampledata))},directives:[f.c,f.a,x.a,g.a,i.s,d.a,i.t],styles:["[_nghost-%COMP%]   table[_ngcontent-%COMP%]{width:100%;background:var(--x-background);border-collapse:collapse;border:.0625rem solid var(--x-border-200)}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%], [_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{border-bottom:.0625rem solid var(--x-border-200);text-align:left;padding:.5rem 1rem}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child > td[_ngcontent-%COMP%], [_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child > th[_ngcontent-%COMP%]{border-width:1px}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap;color:var(--x-text-300)}[_nghost-%COMP%]   div.solid[_ngcontent-%COMP%]{border-top:.0625rem solid var(--x-border)}[_nghost-%COMP%]   div.dashed[_ngcontent-%COMP%]{border-top:.0625rem dashed var(--x-border)}"]}),t})()}];let _=(()=>{class t{}return t.\u0275mod=p.Gb({type:t}),t.\u0275inj=p.Fb({factory:function(e){return new(e||t)},imports:[[n.i.forChild(P)],n.i]}),t})();var k=s("gjGi"),z=s("P0lq"),I=s("fl1B"),S=s("hHlV"),H=s("aMyR"),X=s("873N"),D=s("iaau"),G=s("TicS");let L=(()=>{class t{}return t.\u0275mod=p.Gb({type:t}),t.\u0275inj=p.Fb({factory:function(e){return new(e||t)},imports:[[i.c,_,k.a,z.b,I.b,S.a,H.a,D.a,X.a,G.OutputlistModule]]}),t})()}}]);