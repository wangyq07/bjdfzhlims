(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"873N":function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n=i("ofXK"),s=i("fXoL");let o=(()=>{class t{}return t.\u0275mod=s.Gb({type:t}),t.\u0275inj=s.Fb({factory:function(e){return new(e||t)},imports:[[n.c]]}),t})()},K7LP:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));class n{constructor(t){this.indexService=t,this.auth={};let e=this.indexService.menuChange.subscribe(t=>{this.baseInit(),e.unsubscribe()})}baseInit(){var t,e,i,n,s;this.menu=null===(e=null===(t=this.indexService.auth.user.permissions)||void 0===t?void 0:t.menus)||void 0===e?void 0:e.find(t=>t.router==this.indexService.session.activatedPage),this.actions=null===(n=null===(i=this.indexService.auth.user.permissions)||void 0===i?void 0:i.actions)||void 0===n?void 0:n.filter(t=>{var e;return t.menuId==(null===(e=this.menu)||void 0===e?void 0:e.id)}),null===(s=this.actions)||void 0===s||s.forEach(t=>this.auth[t.code]=!0)}unAuth(t){return!this.auth[t]}}},LZRM:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n=i("bRdP"),s=i("NtM8"),o=i("fXoL");let c=(()=>{class t extends n.a{constructor(t){super(t,{controller:{name:"contacts",servicetype:"businessprocess"}}),this.http=t}updatecontactinfo(t){var e,i;return this.http.post((null===(e=this.option.controller)||void 0===e?void 0:e.name)+"/updatecontactinfo",t,null===(i=this.option.controller)||void 0===i?void 0:i.servicetype)}getcontactproject(t){var e,i;return this.http.post((null===(e=this.option.controller)||void 0===e?void 0:e.name)+"/getcontactproject",{contactid:t},null===(i=this.option.controller)||void 0===i?void 0:i.servicetype)}addcontactproject(t){var e,i;return this.http.post((null===(e=this.option.controller)||void 0===e?void 0:e.name)+"/addcontactproject",t,null===(i=this.option.controller)||void 0===i?void 0:i.servicetype)}updatecontacttest(t){var e,i;return this.http.post((null===(e=this.option.controller)||void 0===e?void 0:e.name)+"/updatecontacttest",t,null===(i=this.option.controller)||void 0===i?void 0:i.servicetype)}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(s.a))},t.\u0275prov=o.Eb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},MOn6:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i("XNiG"),s=i("3pM9"),o=i("1G5W"),c=i("ofXK"),r=i("fXoL");let a=(()=>{class t{constructor(t,e,i){this.elementRef=t,this.renderer=e,this.doc=i,this.outerHeight=0,this._unSubject=new n.a}ngAfterViewInit(){this.setSubject()}ngOnDestroy(){var t;this._unSubject.next(),this._unSubject.unsubscribe(),null===(t=this._resizeObserver)||void 0===t||t.disconnect()}setSubject(){Object(s.A)(this.container,this.doc.documentElement).pipe(Object(o.a)(this._unSubject)).subscribe(t=>{this._resizeObserver=t.resizeObserver,this.setAdaptionHeight()})}setAdaptionHeight(){this.renderer.setStyle(this.elementRef.nativeElement,"height",this.doc.documentElement.clientHeight-this.outerHeight+"px")}}return t.\u0275fac=function(e){return new(e||t)(r.Ib(r.l),r.Ib(r.D),r.Ib(c.e))},t.\u0275dir=r.Db({type:t,selectors:[["","au-adaption",""]],inputs:{outerHeight:"outerHeight",container:"container"}}),t})()},aMyR:function(t,e,i){"use strict";i.d(e,"a",(function(){return m}));var n=i("ofXK"),s=i("gjGi"),o=i("GvSL"),c=i("oJeN"),r=i("/pOC"),a=i("l5Yv"),u=i("qN0K"),b=i("4h90"),l=i("P0lq"),d=i("Prn+"),h=i("hHlV"),p=i("873N"),f=i("iaau"),g=i("fXoL");let m=(()=>{class t{}return t.\u0275mod=g.Gb({type:t}),t.\u0275inj=g.Fb({factory:function(e){return new(e||t)},imports:[[n.c,s.a,o.b,h.a,p.a,f.a,c.b,r.b,a.b,u.b,b.b,l.b,d.b],n.c]}),t})()},iaau:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i("fXoL");let s=(()=>{class t{}return t.\u0275mod=n.Gb({type:t}),t.\u0275inj=n.Fb({factory:function(e){return new(e||t)}}),t})()},jA2P:function(t,e,i){"use strict";i.r(e),i.d(e,"ContactauditModule",(function(){return V}));var n=i("ofXK"),s=i("tyNb"),o=i("wTjX"),c=i("TPaT"),r=i("pDPc"),a=i("LZRM"),u=i("Puy/"),b=i("K7LP"),l=i("rdXg"),d=i("ZnW5"),h=i("fXoL"),p=i("SfH5"),f=i("GvSL"),g=i("P0lq"),m=i("MOn6"),v=i("yO6f"),y=i("3Pt+");const O=["iframeprint"],C=["tablecom"];function w(t,e){if(1&t&&(h.Mb(0),h.wc(1),h.Jb(2,"br"),h.Lb()),2&t){const t=e.$implicit;h.yb(1),h.yc(" ",t.samplename,"")}}function x(t,e){if(1&t&&(h.Mb(0),h.wc(1),h.Jb(2,"br"),h.Lb()),2&t){const t=e.$implicit;h.yb(1),h.yc(" ",t.price,"")}}function N(t,e){if(1&t&&(h.Mb(0),h.wc(1),h.Jb(2,"br"),h.Lb()),2&t){const t=e.$implicit;h.yb(1),h.yc(" ",t.testproject,"")}}function M(t,e){if(1&t&&(h.Mb(0),h.uc(1,N,3,1,"ng-container",19),h.Lb()),2&t){const t=e.$implicit;h.yb(1),h.ec("ngForOf",t.testprojects)}}function P(t,e){if(1&t&&(h.Mb(0),h.wc(1),h.Jb(2,"br"),h.Lb()),2&t){const t=e.$implicit;h.yb(1),h.yc(" ",t.standardname,"")}}function j(t,e){if(1&t&&(h.Mb(0),h.uc(1,P,3,1,"ng-container",19),h.Lb()),2&t){const t=e.$implicit;h.yb(1),h.ec("ngForOf",t.testprojects)}}function _(t,e){if(1&t&&(h.Mb(0),h.wc(1),h.Jb(2,"br"),h.Lb()),2&t){const t=e.$implicit;h.yb(1),h.yc(" ",t.isextern,"")}}function S(t,e){if(1&t&&(h.Mb(0),h.uc(1,_,3,1,"ng-container",19),h.Lb()),2&t){const t=e.$implicit;h.yb(1),h.ec("ngForOf",t.testprojects)}}function k(t,e){if(1&t&&(h.Mb(0),h.wc(1),h.Jb(2,"br"),h.Lb()),2&t){const t=e.$implicit;h.yb(1),h.yc(" ",t.testcount,"")}}function L(t,e){if(1&t&&(h.Mb(0),h.uc(1,k,3,1,"ng-container",19),h.Lb()),2&t){const t=e.$implicit;h.yb(1),h.ec("ngForOf",t.testprojects)}}function I(t,e){if(1&t&&(h.Ob(0,"tr"),h.Ob(1,"td",16),h.wc(2),h.Nb(),h.Ob(3,"td",17),h.wc(4),h.Nb(),h.Ob(5,"td",16),h.wc(6),h.Nb(),h.Ob(7,"td",16),h.uc(8,w,3,1,"ng-container",19),h.Nb(),h.Ob(9,"td",17),h.uc(10,x,3,1,"ng-container",19),h.Nb(),h.Ob(11,"td",16),h.uc(12,M,2,1,"ng-container",19),h.Nb(),h.Ob(13,"td",18),h.uc(14,j,2,1,"ng-container",19),h.Nb(),h.Ob(15,"td",17),h.uc(16,S,2,1,"ng-container",19),h.Nb(),h.Ob(17,"td",17),h.uc(18,L,2,1,"ng-container",19),h.Nb(),h.Nb()),2&t){const t=e.$implicit,i=h.Yb();h.yb(2),h.xc(t.projectnumber),h.yb(2),h.xc(t.reportcount),h.yb(2),h.xc(t.domain.label),h.yb(1),h.rc("display",i.showtablecel),h.yb(1),h.ec("ngForOf",t.samples),h.yb(1),h.rc("display",i.showtablecel),h.yb(1),h.ec("ngForOf",t.samples),h.yb(2),h.ec("ngForOf",t.samples),h.yb(2),h.ec("ngForOf",t.samples),h.yb(2),h.ec("ngForOf",t.samples),h.yb(2),h.ec("ngForOf",t.samples)}}const F=[{path:"",component:(()=>{class t extends b.a{constructor(t,e,i,n,s,o,c){super(t),this.indexService=t,this.flowservice=e,this.roleauditservice=i,this.contactservice=n,this.actroute=s,this.router=o,this.globalaudit=c,this.index=1,this.size=1e4,this.total=0,this.query={},this.columns=[{id:"index",label:"\u5e8f\u53f7",width:80,type:"index"},{id:"name",label:"\u4efb\u52a1",width:100,sort:!0},{id:"customername",label:"\u5ba2\u6237",width:150,sort:!0},{id:"preuser",label:"\u524d\u7f6e\u5904\u7406\u4eba",width:200,sort:!0},{id:"createtime",label:"\u521b\u5efa\u65e5\u671f",width:200,sort:!0},{id:"from",label:"\u4e0a\u4e00\u8282\u70b9",width:100,sort:!0}],this.taskid="",this.delegatecustomer="",this.testcustomer="",this.paycustomer="",this.servicetype="",this.ispanding="",this.seal="",this.reportcount=2,this.samplesource="",this.businessfee=0,this.collectionfee=0,this.testfee=0,this.standfee=0,this.externfee=0,this.discount=0,this.totalfee=0,this.showprice=!1,this.showtablecel="none",this.auditaddvice="",this.projects=[],this.CurrentContact={},null==s?this.getData():s.params.subscribe(t=>{this.taskid=t.taskid,this.getData()}),console.log(t);for(var r=0;r<t.auth.user.organizations.length;r++)if(1==t.auth.user.organizations[r].checkprice){this.showprice=!0,this.showtablecel="table-cell";break}}acction(t){this.roleauditservice.getauditvariable(this.indexService.auth.user.roles,t,this.auditaddvice).subscribe(t=>{if(null!=this.tablecom.activatedRow){var e=this.tablecom.activatedRow;null!=e&&(t.username=this.indexService.auth.user.name,t.userid=this.indexService.auth.user.id,t.contactid=e.contactid,t.qupricediscount=this.CurrentContact.discount,t.customername=e.customername,t.standardfee=this.CurrentContact.standardfee,t.roles=this.indexService.auth.user.roles,this.flowservice.excutetask(e.taskid+"",t).subscribe(t=>{this.getData(),this.globalaudit.sendAuditResult("\u6210\u529f")}))}})}ngAfterViewInit(){}ngOnInit(){}getroundvalue(t,e){var i=Math.round(t/e*100)/100;return null!=this.CurrentContact&&(this.CurrentContact.standardfee=e,this.CurrentContact.discount=i),i}setproject(t){this.projects=[],this.servicetype="",this.seal="",this.samplesource="",this.delegatecustomer="",this.paycustomer="",this.testcustomer="",this.standfee=0,this.totalfee=0,this.testfee=0,this.discount=0,this.externfee=0,this.businessfee=0,this.contactservice.getcontactproject(t.contactid+"").subscribe(t=>{var e,i;if(this.CurrentContact=t.contact,this.projects=t.projects,this.iframe.setprojects(this.projects,this.CurrentContact),null!=this.CurrentContact&&null!=this.CurrentContact.contactcustomers){this.delegatecustomer="",this.testcustomer="",this.paycustomer="";var n=this.CurrentContact.contactcustomers.filter(t=>1==t.customertype);if(n.length>0)for(var s=0;s<n.length;s++)0!=s&&(this.delegatecustomer=this.delegatecustomer+","),this.delegatecustomer=this.delegatecustomer+n[s].customername;var o=this.CurrentContact.contactcustomers.find(t=>2==t.customertype);if(this.paycustomer=(null==o?void 0:o.customername)+"",o=this.CurrentContact.contactcustomers.find(t=>3==t.customertype),this.testcustomer=(null==o?void 0:o.customername)+"",this.servicetype="",this.servicetype=(null===(e=this.CurrentContact.service)||void 0===e?void 0:e.label)+"",this.ispanding=1==this.CurrentContact.isjudgement?"\u662f":"\u5426",this.seal="",null!=this.CurrentContact.seal)for(s=0;s<this.CurrentContact.seal.length;s++)this.seal=this.seal+this.CurrentContact.seal[s].label+",";this.samplesource=(null===(i=this.CurrentContact.samplesource)||void 0===i?void 0:i.label)+"",this.businessfee=Number(this.CurrentContact.businessfee),this.collectionfee=Number(this.CurrentContact.collectionfee),this.testfee=Number(this.CurrentContact.testfee),this.standfee=Number(this.CurrentContact.standardfee),this.discount=Number(this.CurrentContact.discount),this.totalfee=Number(this.CurrentContact.totalfee),this.externfee=Number(this.CurrentContact.externfee)}})}genera(t){l({printable:"iframeprint",type:"html",style:"@media print{@page {size:portrait}}"})}sendcomplete(){l("iframeprint","html")}activatedRow(t){this.setproject(t)}getData(){null!=this.indexService.auth.user.roles&&this.flowservice.getTaskListByRoleId(this.indexService.auth.user.roles).subscribe(t=>{if([this.data,this.total]=[t.list.filter(t=>"task_customerserviceaudit"==t.taskdefinid),t.list.length],null!=this.taskid&&""!=this.taskid){var e=this.data.findIndex(t=>t.taskid==this.taskid);-1!=e?(this.tablecom.activatedRow=this.data[e],this.setproject(this.data[e])):this.data.length>0&&(this.tablecom.activatedRow=this.data[0],this.setproject(this.data[0]))}else this.data.length>0&&(this.tablecom.activatedRow=this.data[0],this.setproject(this.data[0]))})}indexChange(t){this.index=t,this.getData()}sortChange(t){this.query.sort=t,this.getData()}}return t.\u0275fac=function(e){return new(e||t)(h.Ib(o.a),h.Ib(c.a),h.Ib(r.a),h.Ib(a.a),h.Ib(s.a),h.Ib(s.e),h.Ib(u.a))},t.\u0275cmp=h.Cb({type:t,selectors:[["app-contactaudit"]],viewQuery:function(t,e){var i;1&t&&(h.Bc(O,!0),h.Bc(C,!0)),2&t&&(h.ic(i=h.Wb())&&(e.iframe=i.first),h.ic(i=h.Wb())&&(e.tablecom=i.first))},features:[h.vb],decls:78,vars:27,consts:[["span","8",2,"display","inline"],["au-adaption","",1,"au-panel","au-content",3,"outerHeight"],["loading","",3,"columns","data","index","size","total","virtualScroll","bodyHeight","indexChange","sizeChange","sortChange","activatedRowChange"],["tablecom",""],["span","16"],[2,"height","20px"],["span","5"],["icon","ado-check","plain","","type","primary",2,"color","green",3,"click"],["span","12"],["span","6"],["span","4"],[2,"height","20"],[3,"hidden"],["label","\u6807\u51c6\u68c0\u6d4b\u8d39","direction","row",3,"ngModel","ngModelChange"],["span","24"],["id","sampledata","border","1",2,"height","100%","width","100%"],[2,"width","10%","text-align","center"],[2,"width","5%","text-align","center"],[2,"width","40%","text-align","center"],[4,"ngFor","ngForOf"],[2,"display","none"],["id","iframeprint",2,"width","100%","height","100%",3,"sendcomplete"],["iframeprint",""]],template:function(t,e){1&t&&(h.Ob(0,"x-row"),h.Ob(1,"x-col",0),h.Ob(2,"div",1),h.Ob(3,"x-table",2,3),h.Vb("indexChange",(function(t){return e.index=t}))("sizeChange",(function(t){return e.size=t}))("indexChange",(function(t){return e.indexChange(t)}))("sortChange",(function(t){return e.sortChange(t)}))("activatedRowChange",(function(t){return e.activatedRow(t)})),h.Nb(),h.Nb(),h.Nb(),h.Ob(5,"x-col",4),h.Ob(6,"div",1),h.Jb(7,"x-row",5),h.Ob(8,"x-row"),h.Ob(9,"x-col",6),h.Ob(10,"x-button",7),h.Vb("click",(function(){return e.acction(1)})),h.wc(11,"\u63d0\u4ea4"),h.Nb(),h.Nb(),h.Ob(12,"x-col",6),h.Ob(13,"x-button",7),h.Vb("click",(function(){return e.genera(1)})),h.wc(14,"\u751f\u6210\u534f\u8bae\u4e66"),h.Nb(),h.Nb(),h.Nb(),h.Jb(15,"x-row",5),h.Ob(16,"x-row"),h.Ob(17,"x-col",8),h.wc(18),h.Nb(),h.Ob(19,"x-col",9),h.wc(20),h.Nb(),h.Ob(21,"x-col",9),h.wc(22),h.Nb(),h.Nb(),h.Jb(23,"x-row",5),h.Ob(24,"x-row"),h.Ob(25,"x-col",10),h.wc(26),h.Nb(),h.Ob(27,"x-col",10),h.wc(28),h.Nb(),h.Ob(29,"x-col",10),h.wc(30),h.Nb(),h.Ob(31,"x-col",10),h.wc(32),h.Nb(),h.Nb(),h.Jb(33,"x-row",11),h.Ob(34,"x-row",12),h.Ob(35,"x-col",10),h.wc(36),h.Nb(),h.Ob(37,"x-col",10),h.wc(38),h.Nb(),h.Ob(39,"x-col",10),h.wc(40),h.Nb(),h.Ob(41,"x-col",10),h.wc(42),h.Nb(),h.Nb(),h.Ob(43,"x-row"),h.Ob(44,"x-col",10),h.wc(45),h.Nb(),h.Ob(46,"x-col",10),h.Ob(47,"x-input",13),h.Vb("ngModelChange",(function(t){return e.standfee=t})),h.Nb(),h.Nb(),h.Ob(48,"x-col",10),h.wc(49),h.Nb(),h.Nb(),h.Jb(50,"x-row",5),h.Ob(51,"x-row"),h.Ob(52,"x-col",14),h.Ob(53,"table",15),h.Ob(54,"thead"),h.Ob(55,"td",16),h.wc(56,"\u9879\u76ee"),h.Nb(),h.Ob(57,"td",17),h.wc(58,"\u62a5\u544a"),h.Nb(),h.Ob(59,"td",16),h.wc(60,"\u9886\u57df"),h.Nb(),h.Ob(61,"td",16),h.wc(62,"\u6837\u54c1"),h.Nb(),h.Ob(63,"td",17),h.wc(64,"\u68c0\u6d4b\u8d39"),h.Nb(),h.Ob(65,"td",16),h.wc(66,"\u9879\u76ee"),h.Nb(),h.Ob(67,"td",18),h.wc(68,"\u6807\u51c6"),h.Nb(),h.Ob(69,"td",17),h.wc(70,"\u5916\u5305"),h.Nb(),h.Ob(71,"td",17),h.wc(72,"\u6b21\u6570"),h.Nb(),h.Nb(),h.uc(73,I,19,13,"tr",19),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Nb(),h.Ob(74,"x-row"),h.Ob(75,"div",20),h.Ob(76,"app-outputlist",21,22),h.Vb("sendcomplete",(function(){return e.sendcomplete()})),h.Nb(),h.Nb(),h.Nb()),2&t&&(h.yb(2),h.ec("outerHeight",50),h.yb(1),h.ec("columns",e.columns)("data",e.data)("index",e.index)("size",e.size)("total",e.total)("virtualScroll",!0)("bodyHeight",750),h.yb(3),h.ec("outerHeight",50),h.yb(12),h.yc("\u59d4\u6258\u5ba2\u6237:",e.delegatecustomer,""),h.yb(2),h.yc("\u4ed8\u6b3e\u5ba2\u6237:",e.paycustomer,""),h.yb(2),h.yc("\u53d7\u68c0\u5ba2\u6237:",e.testcustomer,""),h.yb(4),h.yc("\u6837\u54c1\u6765\u6e90:",e.samplesource,""),h.yb(2),h.yc("\u662f\u5426\u5224\u5b9a:",e.ispanding,""),h.yb(2),h.yc("\u8d44\u8d28\u76d6\u7ae0:",e.seal,""),h.yb(2),h.yc("\u670d\u52a1\u7c7b\u578b:",e.servicetype,""),h.yb(2),h.ec("hidden",e.showprice),h.yb(2),h.yc("\u603b\u8d39\u7528:",e.totalfee,""),h.yb(2),h.yc("\u4e1a\u52a1\u8d39:",e.businessfee,""),h.yb(2),h.yc("\u91c7\u6837\u8d39:",e.collectionfee,""),h.yb(2),h.yc("\u5916\u5305\u8d39:",e.externfee,""),h.yb(3),h.yc("\u6210\u4ea4\u4ef7\u683c:",e.testfee,""),h.yb(2),h.ec("ngModel",e.standfee),h.yb(2),h.yc("\u6298\u6263:",e.getroundvalue(e.testfee,e.standfee),""),h.yb(14),h.rc("display",e.showtablecel),h.yb(10),h.ec("ngForOf",e.projects))},directives:[p.c,p.a,m.a,v.a,f.a,g.a,y.q,y.t,n.s,d.a],styles:["[_nghost-%COMP%]   table[_ngcontent-%COMP%]{width:100%;background:var(--x-background);border-collapse:collapse;border:.0625rem solid var(--x-border-200)}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%], [_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{border-bottom:.0625rem solid var(--x-border-200);text-align:left;padding:.5rem 1rem}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child > td[_ngcontent-%COMP%], [_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child > th[_ngcontent-%COMP%]{border-width:1px}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap;color:var(--x-text-300)}[_nghost-%COMP%]   div.solid[_ngcontent-%COMP%]{border-top:.0625rem solid var(--x-border)}[_nghost-%COMP%]   div.dashed[_ngcontent-%COMP%]{border-top:.0625rem dashed var(--x-border)}"]}),t})()}];let R=(()=>{class t{}return t.\u0275mod=h.Gb({type:t}),t.\u0275inj=h.Fb({factory:function(e){return new(e||t)},imports:[[s.i.forChild(F)],s.i]}),t})();var H=i("gjGi"),J=i("fl1B"),z=i("hHlV"),X=i("aMyR"),G=i("873N"),$=i("iaau"),D=i("TicS");let V=(()=>{class t{}return t.\u0275mod=h.Gb({type:t}),t.\u0275inj=h.Fb({factory:function(e){return new(e||t)},imports:[[n.c,R,H.a,g.b,J.b,z.a,X.a,$.a,G.a,D.OutputlistModule]]}),t})()}}]);