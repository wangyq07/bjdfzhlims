!function(){function t(e,n){return(t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(e,n)}function e(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var c,o=r(t);if(e){var i=r(this).constructor;c=Reflect.construct(o,arguments,i)}else c=o.apply(this,arguments);return n(this,c)}}function n(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"873N":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("ofXK"),c=n("fXoL"),o=function(){var t=function t(){i(this,t)};return t.\u0275mod=c.Gb({type:t}),t.\u0275inj=c.Fb({factory:function(e){return new(e||t)},imports:[[r.c]]}),t}()},MOn6:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r=n("XNiG"),c=n("3pM9"),a=n("1G5W"),s=n("ofXK"),u=n("fXoL"),b=function(){var t=function(){function t(e,n,c){i(this,t),this.elementRef=e,this.renderer=n,this.doc=c,this.outerHeight=0,this._unSubject=new r.a}return o(t,[{key:"ngAfterViewInit",value:function(){this.setSubject()}},{key:"ngOnDestroy",value:function(){var t;this._unSubject.next(),this._unSubject.unsubscribe(),null===(t=this._resizeObserver)||void 0===t||t.disconnect()}},{key:"setSubject",value:function(){var t=this;Object(c.A)(this.container,this.doc.documentElement).pipe(Object(a.a)(this._unSubject)).subscribe((function(e){t._resizeObserver=e.resizeObserver,t.setAdaptionHeight()}))}},{key:"setAdaptionHeight",value:function(){this.renderer.setStyle(this.elementRef.nativeElement,"height",this.doc.documentElement.clientHeight-this.outerHeight+"px")}}]),t}();return t.\u0275fac=function(e){return new(e||t)(u.Ib(u.l),u.Ib(u.D),u.Ib(s.e))},t.\u0275dir=u.Db({type:t,selectors:[["","au-adaption",""]],inputs:{outerHeight:"outerHeight",container:"container"}}),t}()},aMyR:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n("ofXK"),c=n("gjGi"),o=n("GvSL"),a=n("oJeN"),s=n("/pOC"),u=n("l5Yv"),b=n("qN0K"),l=n("4h90"),d=n("P0lq"),f=n("Prn+"),p=n("hHlV"),h=n("873N"),m=n("iaau"),y=n("fXoL"),v=function(){var t=function t(){i(this,t)};return t.\u0275mod=y.Gb({type:t}),t.\u0275inj=y.Fb({factory:function(e){return new(e||t)},imports:[[r.c,c.a,o.b,p.a,h.a,m.a,a.b,s.b,u.b,b.b,l.b,d.b,f.b],r.c]}),t}()},iaau:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("fXoL"),c=function(){var t=function t(){i(this,t)};return t.\u0275mod=r.Gb({type:t}),t.\u0275inj=r.Fb({factory:function(e){return new(e||t)}}),t}()},jA2P:function(n,r,c){"use strict";c.r(r),c.d(r,"ContactauditModule",(function(){return V}));var a=c("ofXK"),s=c("tyNb"),u=c("wTjX"),b=c("TPaT"),l=c("pDPc"),d=c("LZRM"),f=c("Puy/"),p=c("K7LP"),h=c("rdXg"),m=c("ZnW5"),y=c("BzWU"),v=c("fXoL"),g=c("qMpK"),x=c("SfH5"),O=c("GvSL"),C=c("MOn6"),w=["iframeprint"],N=["tablecom"];function j(t,e){if(1&t&&(v.Ob(0,"td"),v.xc(1),v.Nb()),2&t){var n=v.Yb().$implicit;v.zb("rowspan",n.projectrowspan),v.yb(1),v.yc(n.projectname)}}function _(t,e){if(1&t&&(v.Ob(0,"td"),v.xc(1),v.Nb()),2&t){var n=v.Yb().$implicit;v.zb("rowspan",n.projectrowspan),v.yb(1),v.yc(n.reportcount)}}function P(t,e){if(1&t&&(v.Ob(0,"td"),v.xc(1),v.Nb()),2&t){var n=v.Yb().$implicit;v.zb("rowspan",n.projectrowspan),v.yb(1),v.yc(n.domain)}}function k(t,e){if(1&t&&(v.Ob(0,"td"),v.xc(1),v.Nb()),2&t){var n=v.Yb().$implicit;v.zb("rowspan",n.samplerowspan),v.yb(1),v.yc(n.samplename)}}function M(t,e){if(1&t&&(v.Ob(0,"td"),v.xc(1),v.Nb()),2&t){var n=v.Yb().$implicit;v.zb("rowspan",n.samplerowspan),v.yb(1),v.yc(n.sampleprice)}}function z(t,e){if(1&t&&(v.Ob(0,"tr"),v.vc(1,j,2,2,"td",19),v.vc(2,_,2,2,"td",19),v.vc(3,P,2,2,"td",19),v.vc(4,k,2,2,"td",19),v.vc(5,M,2,2,"td",19),v.Ob(6,"td"),v.xc(7),v.Nb(),v.Ob(8,"td"),v.xc(9),v.Nb(),v.Ob(10,"td"),v.xc(11),v.Nb(),v.Ob(12,"td"),v.xc(13),v.Nb(),v.Ob(14,"td"),v.xc(15),v.Nb(),v.Nb()),2&t){var n=e.$implicit,r=e.index;v.yb(1),v.ec("ngIf",n.projectindex==r),v.yb(1),v.ec("ngIf",n.projectindex==r),v.yb(1),v.ec("ngIf",n.projectindex==r),v.yb(1),v.ec("ngIf",n.sampleindex==r),v.yb(1),v.ec("ngIf",n.sampleindex==r),v.yb(2),v.yc(n.testproject),v.yb(2),v.yc(n.standardname),v.yb(2),v.yc(n.price),v.yb(2),v.yc(n.extern),v.yb(2),v.yc(n.testcount)}}var I,S,D,R=[{path:"",component:(I=function(n){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&t(e,n)}(c,n);var r=e(c);function c(t,e,n,o,a,s,u,b){var l;i(this,c),(l=r.call(this,t)).indexService=t,l.flowservice=e,l.roleauditservice=n,l.contactservice=o,l.actroute=a,l.router=s,l.globalaudit=u,l.msg=b,l.index=1,l.submitdisable=!1,l.size=1e4,l.total=0,l.query={},l.columns=[{id:"index",label:"\u5e8f\u53f7",width:80,type:"index"},{id:"name",label:"\u4efb\u52a1",width:100,sort:!0},{id:"customername",label:"\u5ba2\u6237",width:150,sort:!0},{id:"preuser",label:"\u524d\u7f6e\u5904\u7406\u4eba",width:200,sort:!0},{id:"createtime",label:"\u521b\u5efa\u65e5\u671f",width:200,sort:!0},{id:"from",label:"\u4e0a\u4e00\u8282\u70b9",width:100,sort:!0}],l.taskid="",l.delegatecustomer="",l.testcustomer="",l.paycustomer="",l.servicetype="",l.ispanding="",l.seal="",l.reportcount=2,l.samplesource="",l.businessfee=0,l.collectionfee=0,l.testfee=0,l.standfee=0,l.externfee=0,l.discount=0,l.totalfee=0,l.showprice=!1,l.showtablecel="none",l.auditaddvice="",l.projects=[],l.currenttask={},l.CurrentContact={},l.sampledata=[],null==a?l.getData():a.params.subscribe((function(t){l.taskid=t.taskid,l.getData()}));for(var d=0;d<t.auth.user.organizations.length;d++)if(1==t.auth.user.organizations[d].checkprice){l.showprice=!0,l.showtablecel="table-cell";break}return l}return o(c,[{key:"acction",value:function(t){var e=this;this.roleauditservice.getauditvariable(this.indexService.auth.user.roles,t,this.auditaddvice).subscribe((function(t){var n=e.currenttask;null!=n&&(t.username=e.indexService.auth.user.name,t.userid=e.indexService.auth.user.id,t.contactid=n.contactid,t.qupricediscount=e.CurrentContact.discount,t.customername=n.customername,t.standardfee=e.CurrentContact.standardfee,t.roles=e.indexService.auth.user.roles,e.flowservice.excutetask(n.taskid+"",t).subscribe((function(t){e.cleardata(),e.msg.success("\u63d0\u4ea4\u6210\u529f"),e.submitdisable=!0})))}))}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnInit",value:function(){}},{key:"getroundvalue",value:function(t,e){var n=Math.round(t/e*100)/100;return null!=this.CurrentContact&&(this.CurrentContact.standardfee=e,this.CurrentContact.discount=n),n}},{key:"cleardata",value:function(){this.projects=[],this.servicetype="",this.seal="",this.samplesource="",this.delegatecustomer="",this.paycustomer="",this.testcustomer="",this.standfee=0,this.totalfee=0,this.testfee=0,this.discount=0,this.externfee=0,this.businessfee=0,this.sampledata=[]}},{key:"setproject",value:function(t){var e=this;this.currenttask=t,this.cleardata(),this.contactservice.getcontactproject(t.contactid+"").subscribe((function(t){var n,r;if(e.CurrentContact=t.contact,e.projects=t.projects,e.iframe.setprojects(e.projects,e.CurrentContact),null!=e.CurrentContact&&null!=e.CurrentContact.contactcustomers){e.delegatecustomer="",e.testcustomer="",e.paycustomer="";var c=e.CurrentContact.contactcustomers.filter((function(t){return 1==t.customertype}));if(c.length>0)for(var o=0;o<c.length;o++)0!=o&&(e.delegatecustomer=e.delegatecustomer+","),e.delegatecustomer=e.delegatecustomer+c[o].customername;var i=e.CurrentContact.contactcustomers.find((function(t){return 2==t.customertype}));if(e.paycustomer=(null==i?void 0:i.customername)+"",i=e.CurrentContact.contactcustomers.find((function(t){return 3==t.customertype})),e.testcustomer=(null==i?void 0:i.customername)+"",e.servicetype="",e.servicetype=(null===(n=e.CurrentContact.service)||void 0===n?void 0:n.label)+"",e.ispanding=1==e.CurrentContact.isjudgement?"\u662f":"\u5426",e.seal="",null!=e.CurrentContact.seal)for(o=0;o<e.CurrentContact.seal.length;o++)e.seal=e.seal+e.CurrentContact.seal[o].label+",";e.samplesource=(null===(r=e.CurrentContact.samplesource)||void 0===r?void 0:r.label)+"",e.businessfee=Number(e.CurrentContact.businessfee),e.collectionfee=Number(e.CurrentContact.collectionfee),e.testfee=Number(e.CurrentContact.testfee),e.standfee=Number(e.CurrentContact.standardfee),e.discount=Number(e.CurrentContact.discount),e.totalfee=Number(e.CurrentContact.totalfee),e.externfee=Number(e.CurrentContact.externfee)}console.log(e.projects),e.sampledata=y.a.getMareData(e.projects,e.ispanding)}))}},{key:"genera",value:function(t){var e=this;this.contactservice.updateprojectnumer(this.CurrentContact.id+"",this.standfee).subscribe((function(t){e.sampledata=y.a.getMareData(t.projects,e.ispanding),e.iframe.setprojects(t.projects,t.contact),setTimeout((function(){h({printable:"iframeprint",type:"html",maxWidth:"98%",targetStyles:["*"],style:"@media print{@page {size:portrait}}"})}),10*t.projects.length)}))}},{key:"sendcomplete",value:function(){h("iframeprint","html")}},{key:"activatedRow",value:function(t){this.setproject(t)}},{key:"getData",value:function(){var t=this;null!=this.indexService.auth.user.roles&&this.flowservice.getTaskListByRoleId(this.indexService.auth.user.roles).subscribe((function(e){var n;if(n=[e.list.filter((function(t){return"task_customerserviceaudit"==t.taskdefinid})),e.list.length],t.data=n[0],t.total=n[1],null!=t.taskid&&""!=t.taskid){var r=t.data.findIndex((function(e){return e.taskid==t.taskid}));-1!=r&&t.setproject(t.data[r])}}))}},{key:"indexChange",value:function(t){this.index=t,this.getData()}},{key:"sortChange",value:function(t){this.query.sort=t,this.getData()}}]),c}(p.a),I.\u0275fac=function(t){return new(t||I)(v.Ib(u.a),v.Ib(b.a),v.Ib(l.a),v.Ib(d.a),v.Ib(s.a),v.Ib(s.e),v.Ib(f.a),v.Ib(g.c))},I.\u0275cmp=v.Cb({type:I,selectors:[["app-contactaudit"]],viewQuery:function(t,e){var n;1&t&&(v.Cc(w,!0),v.Cc(N,!0)),2&t&&(v.jc(n=v.Wb())&&(e.iframe=n.first),v.jc(n=v.Wb())&&(e.tablecom=n.first))},features:[v.vb],decls:76,vars:20,consts:[["span","24"],["au-adaption","",1,"au-panel","au-content",3,"outerHeight"],[2,"height","20px"],["span","5"],["icon","ado-check","plain","","type","primary",2,"color","green",3,"disabled","click"],["icon","ado-check","plain","","type","primary",2,"color","green",3,"click"],["span","12"],["span","6"],["span","4"],[2,"height","20"],[3,"hidden"],["id","sampledata","border","1",2,"height","100%","width","100%"],[2,"width","10%","text-align","center"],[2,"width","5%","text-align","center"],[2,"width","40%","text-align","center"],[4,"ngFor","ngForOf"],[2,"display","none"],["id","iframeprint",2,"width","100%","height","100%",3,"sendcomplete"],["iframeprint",""],[4,"ngIf"]],template:function(t,e){1&t&&(v.Ob(0,"x-row"),v.Ob(1,"x-col",0),v.Ob(2,"div",1),v.Jb(3,"x-row",2),v.Ob(4,"x-row"),v.Ob(5,"x-col",3),v.Ob(6,"x-button",4),v.Vb("click",(function(){return e.acction(1)})),v.xc(7,"\u63d0\u4ea4"),v.Nb(),v.Nb(),v.Ob(8,"x-col",3),v.Ob(9,"x-button",5),v.Vb("click",(function(){return e.genera(1)})),v.xc(10,"\u751f\u6210\u534f\u8bae\u4e66"),v.Nb(),v.Nb(),v.Nb(),v.Jb(11,"x-row",2),v.Ob(12,"x-row"),v.Ob(13,"x-col",6),v.xc(14),v.Nb(),v.Ob(15,"x-col",7),v.xc(16),v.Nb(),v.Ob(17,"x-col",7),v.xc(18),v.Nb(),v.Nb(),v.Jb(19,"x-row",2),v.Ob(20,"x-row"),v.Ob(21,"x-col",8),v.xc(22),v.Nb(),v.Ob(23,"x-col",8),v.xc(24),v.Nb(),v.Ob(25,"x-col",8),v.xc(26),v.Nb(),v.Ob(27,"x-col",8),v.xc(28),v.Nb(),v.Nb(),v.Jb(29,"x-row",9),v.Ob(30,"x-row",10),v.Ob(31,"x-col",8),v.xc(32),v.Nb(),v.Ob(33,"x-col",8),v.xc(34),v.Nb(),v.Ob(35,"x-col",8),v.xc(36),v.Nb(),v.Ob(37,"x-col",8),v.xc(38),v.Nb(),v.Nb(),v.Ob(39,"x-row"),v.Ob(40,"x-col",8),v.xc(41),v.Nb(),v.Ob(42,"x-col",8),v.xc(43),v.Nb(),v.Ob(44,"x-col",8),v.xc(45),v.Nb(),v.Nb(),v.Jb(46,"x-row",2),v.Ob(47,"x-row"),v.Ob(48,"x-col",0),v.Ob(49,"table",11),v.Ob(50,"thead"),v.Ob(51,"td",12),v.xc(52,"\u9879\u76ee"),v.Nb(),v.Ob(53,"td",13),v.xc(54,"\u62a5\u544a"),v.Nb(),v.Ob(55,"td",12),v.xc(56,"\u9886\u57df"),v.Nb(),v.Ob(57,"td",12),v.xc(58,"\u6837\u54c1"),v.Nb(),v.Ob(59,"td",13),v.xc(60,"\u68c0\u6d4b\u8d39"),v.Nb(),v.Ob(61,"td",12),v.xc(62,"\u68c0\u6d4b\u9879\u76ee"),v.Nb(),v.Ob(63,"td",14),v.xc(64,"\u68c0\u6d4b\u6807\u51c6"),v.Nb(),v.Ob(65,"td",13),v.xc(66,"\u6807\u51c6\u8d39\u7528"),v.Nb(),v.Ob(67,"td",13),v.xc(68,"\u5916\u5305"),v.Nb(),v.Ob(69,"td",13),v.xc(70,"\u6b21\u6570"),v.Nb(),v.Nb(),v.vc(71,z,16,10,"tr",15),v.Nb(),v.Nb(),v.Nb(),v.Nb(),v.Nb(),v.Nb(),v.Ob(72,"x-row"),v.Ob(73,"div",16),v.Ob(74,"app-outputlist",17,18),v.Vb("sendcomplete",(function(){return e.sendcomplete()})),v.Nb(),v.Nb(),v.Nb()),2&t&&(v.yb(2),v.ec("outerHeight",50),v.yb(4),v.ec("disabled",e.submitdisable),v.yb(8),v.zc("\u59d4\u6258\u5ba2\u6237:",e.delegatecustomer,""),v.yb(2),v.zc("\u4ed8\u6b3e\u5ba2\u6237:",e.paycustomer,""),v.yb(2),v.zc("\u53d7\u68c0\u5ba2\u6237:",e.testcustomer,""),v.yb(4),v.zc("\u6837\u54c1\u6765\u6e90:",e.samplesource,""),v.yb(2),v.zc("\u662f\u5426\u5224\u5b9a:",e.ispanding,""),v.yb(2),v.zc("\u8d44\u8d28\u76d6\u7ae0:",e.seal,""),v.yb(2),v.zc("\u670d\u52a1\u7c7b\u578b:",e.servicetype,""),v.yb(2),v.ec("hidden",e.showprice),v.yb(2),v.zc("\u603b\u8d39\u7528:",e.totalfee,""),v.yb(2),v.zc("\u4e1a\u52a1\u8d39:",e.businessfee,""),v.yb(2),v.zc("\u91c7\u6837\u8d39:",e.collectionfee,""),v.yb(2),v.zc("\u5916\u5305\u8d39:",e.externfee,""),v.yb(3),v.zc("\u6210\u4ea4\u4ef7\u683c:",e.testfee,""),v.yb(2),v.zc("\u6807\u51c6\u68c0\u6d4b\u8d39:",e.standfee,""),v.yb(2),v.zc("\u6298\u6263:",e.getroundvalue(e.testfee,e.standfee),""),v.yb(14),v.sc("display",e.showtablecel),v.yb(12),v.ec("ngForOf",e.sampledata))},directives:[x.c,x.a,C.a,O.a,a.s,m.a,a.t],styles:["[_nghost-%COMP%]   table[_ngcontent-%COMP%]{width:100%;background:var(--x-background);border-collapse:collapse;border:.0625rem solid var(--x-border-200)}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%], [_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{border-bottom:.0625rem solid var(--x-border-200);text-align:left;padding:.5rem 1rem}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child > td[_ngcontent-%COMP%], [_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child > th[_ngcontent-%COMP%]{border-width:1px}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap;color:var(--x-text-300)}[_nghost-%COMP%]   div.solid[_ngcontent-%COMP%]{border-top:.0625rem solid var(--x-border)}[_nghost-%COMP%]   div.dashed[_ngcontent-%COMP%]{border-top:.0625rem dashed var(--x-border)}"]}),I)}],H=((S=function t(){i(this,t)}).\u0275mod=v.Gb({type:S}),S.\u0275inj=v.Fb({factory:function(t){return new(t||S)},imports:[[s.i.forChild(R)],s.i]}),S),X=c("gjGi"),G=c("P0lq"),L=c("fl1B"),F=c("hHlV"),J=c("aMyR"),T=c("873N"),q=c("iaau"),K=c("TicS"),V=((D=function t(){i(this,t)}).\u0275mod=v.Gb({type:D}),D.\u0275inj=v.Fb({factory:function(t){return new(t||D)},imports:[[a.c,H,X.a,G.b,L.b,F.a,J.a,q.a,T.a,K.OutputlistModule]]}),D)}}])}();