(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"873N":function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i("ofXK"),o=i("fXoL");let s=(()=>{class t{}return t.\u0275mod=o.Gb({type:t}),t.\u0275inj=o.Fb({factory:function(e){return new(e||t)},imports:[[n.c]]}),t})()},K7LP:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));class n{constructor(t){this.indexService=t,this.auth={};let e=this.indexService.menuChange.subscribe(t=>{this.baseInit(),e.unsubscribe()})}baseInit(){var t,e,i,n,o;this.menu=null===(e=null===(t=this.indexService.auth.user.permissions)||void 0===t?void 0:t.menus)||void 0===e?void 0:e.find(t=>t.router==this.indexService.session.activatedPage),this.actions=null===(n=null===(i=this.indexService.auth.user.permissions)||void 0===i?void 0:i.actions)||void 0===n?void 0:n.filter(t=>{var e;return t.menuId==(null===(e=this.menu)||void 0===e?void 0:e.id)}),null===(o=this.actions)||void 0===o||o.forEach(t=>this.auth[t.code]=!0)}unAuth(t){return!this.auth[t]}}},MOn6:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i("XNiG"),o=i("3pM9"),s=i("1G5W"),c=i("ofXK"),a=i("fXoL");let r=(()=>{class t{constructor(t,e,i){this.elementRef=t,this.renderer=e,this.doc=i,this.outerHeight=0,this._unSubject=new n.a}ngAfterViewInit(){this.setSubject()}ngOnDestroy(){var t;this._unSubject.next(),this._unSubject.unsubscribe(),null===(t=this._resizeObserver)||void 0===t||t.disconnect()}setSubject(){Object(o.A)(this.container,this.doc.documentElement).pipe(Object(s.a)(this._unSubject)).subscribe(t=>{this._resizeObserver=t.resizeObserver,this.setAdaptionHeight()})}setAdaptionHeight(){this.renderer.setStyle(this.elementRef.nativeElement,"height",this.doc.documentElement.clientHeight-this.outerHeight+"px")}}return t.\u0275fac=function(e){return new(e||t)(a.Ib(a.l),a.Ib(a.D),a.Ib(c.e))},t.\u0275dir=a.Db({type:t,selectors:[["","au-adaption",""]],inputs:{outerHeight:"outerHeight",container:"container"}}),t})()},Moon:function(t,e,i){"use strict";i.r(e),i.d(e,"MenusModule",(function(){return R}));var n=i("ofXK"),o=i("tyNb"),s=i("IOW9"),c=i("M9h8"),a=i("vtiB"),r=i("fXoL"),u=i("qMpK"),l=i("x6Xy"),d=i("1uEr"),h=i("hMyc"),b=i("GvSL"),m=i("yO6f"),f=i("kXfN"),p=i("qN0K");const v=["tableCom"];function g(t,e){if(1&t){const t=r.Pb();r.Ob(0,"div",10),r.Ob(1,"x-link",11),r.Vb("click",(function(){r.mc(t);const i=e.$row;return r.Yb().action("info",i)})),r.Nb(),r.Ob(2,"x-link",12),r.Vb("click",(function(){r.mc(t);const i=e.$row;return r.Yb().action("delete",i)})),r.Nb(),r.Nb()}}function y(t,e){if(1&t&&r.Jb(0,"x-icon",14),2&t){const t=r.Yb().$row;r.ec("type",t.icon)}}function x(t,e){1&t&&r.vc(0,y,1,1,"x-icon",13),2&t&&r.ec("ngIf",e.$row.icon)}const I=function(t,e){return{actions:t,icon:e}};let w=(()=>{class t{constructor(t,e,i,n,o,s){this.service=t,this.router=e,this.activatedRoute=i,this.message=n,this.msgBox=o,this.nav=s,this.index=1,this.query={filter:[],sort:[{field:"sort",value:"asc"}]},this.data=(t,e,i)=>this.service.getList(t,e,i).pipe(t=>t),this.columns=[{id:"index",label:"\u5e8f\u53f7",width:80,type:"index"},{id:"actions",label:"\u64cd\u4f5c",width:100},{id:"name",label:"\u540d\u79f0",flex:1,sort:!0},{id:"code",label:"\u7f16\u7801",flex:1,sort:!0},{id:"icon",label:"\u56fe\u6807",flex:1},{id:"sort",label:"\u987a\u5e8f",flex:1,sort:!0}],this.activatedRoute.paramMap.subscribe(t=>{this.menuId=t.get("menuId"),this.query.filter=[{field:"menuId",value:this.menuId,operation:"="}]})}ngOnInit(){}action(t,e){switch(t){case"add":this.router.navigate(["./"+t],{relativeTo:this.activatedRoute});break;case"info":case"edit":this.router.navigate([`./${t}/${e.id}`],{relativeTo:this.activatedRoute});break;case"delete":this.msgBox.confirm({title:"\u63d0\u793a",content:`\u6b64\u64cd\u4f5c\u5c06\u6c38\u4e45\u5220\u9664\u6b64\u6761\u6570\u636e\uff1a${e.name}\uff0c\u662f\u5426\u7ee7\u7eed\uff1f`,type:"warning",callback:t=>{"confirm"===t&&this.service.delete(e.id).subscribe(t=>{this.tableCom.change(this.index),this.message.success("\u5220\u9664\u6210\u529f\uff01")})}});break;case"cancel":this.nav.back()}}}return t.\u0275fac=function(e){return new(e||t)(r.Ib(c.a),r.Ib(o.e),r.Ib(o.a),r.Ib(u.c),r.Ib(l.c),r.Ib(a.a))},t.\u0275cmp=r.Cb({type:t,selectors:[["app-menu-actions"]],viewQuery:function(t,e){var i;1&t&&r.Cc(v,!0),2&t&&r.jc(i=r.Wb())&&(e.tableCom=i.first)},decls:14,vars:13,consts:[[1,"au-inner"],[1,"au-table-right"],["top",""],[3,"space"],["icon","fto-chevron-left",3,"click"],["type","primary","icon","fto-plus",3,"click"],["virtualScroll","","loading","",3,"columns","rowHeight","data","size","index","query","bodyHeight","bodyColumnTpl","adaptionHeight","indexChange"],["tableCom",""],["actionsTpl",""],["iconTpl",""],[1,"au-table-actions"],["icon","fto-eye","title","\u67e5\u770b",3,"click"],["icon","fto-trash-2","title","\u5220\u9664",3,"click"],[3,"type",4,"ngIf"],[3,"type"]],template:function(t,e){if(1&t&&(r.Ob(0,"x-inner",0),r.Ob(1,"div",1),r.Ob(2,"au-tool",2),r.Ob(3,"x-buttons",3),r.Ob(4,"x-button",4),r.Vb("click",(function(){return e.action("cancel")})),r.xc(5,"\u8fd4\u56de"),r.Nb(),r.Ob(6,"x-button",5),r.Vb("click",(function(){return e.action("add")})),r.xc(7,"\u65b0\u589e"),r.Nb(),r.Nb(),r.Nb(),r.Ob(8,"x-table",6,7),r.Vb("indexChange",(function(t){return e.index=t})),r.Nb(),r.Nb(),r.Nb(),r.vc(10,g,3,0,"ng-template",null,8,r.wc),r.vc(12,x,1,1,"ng-template",null,9,r.wc)),2&t){const t=r.kc(11),i=r.kc(13);r.yb(3),r.ec("space",.5),r.yb(5),r.ec("columns",e.columns)("rowHeight",35)("data",e.data)("size",20)("index",e.index)("query",e.query)("bodyHeight",100)("bodyColumnTpl",r.hc(10,I,t,i))("adaptionHeight",138)}},directives:[d.a,h.a,b.c,b.a,m.a,f.a,n.t,p.a],encapsulation:2,changeDetection:0}),t})();var k=i("zM0U"),O=i("oJeN"),C=i("3Pt+"),N=i("ZQZ3"),M=i("MOn6");const H=["form"];let j=(()=>{class t{constructor(t,e,i,n,o,s){this.service=t,this.setting=e,this.activatedRoute=i,this.message=n,this.nav=o,this.cdr=s,this.editactions=["\u67e5\u770b","\u65b0\u589e","\u4fee\u6539","\u5220\u9664"],this.currenteditactions=new S,this.controls=[{control:"input",id:"name",label:"\u540d\u79f0",required:!0},{control:"input",id:"code",label:"\u7f16\u7801",required:!0},{control:"input",id:"icon",label:"\u56fe\u6807"},{control:"input",id:"sort",label:"\u987a\u5e8f"},{control:"input",id:"id",hidden:!0,value:this.setting.guid()},{control:"input",id:"menuId",hidden:!0}],this.activatedRoute.paramMap.subscribe(t=>{this.id=t.get("id"),this.type=t.get("type"),this.menuId=t.get("menuId"),this.menuId&&(this.controls.find(t=>"menuId"===t.id).value=this.menuId)})}selectchange(t){}get formInvalid(){var t,e;return null===(e=null===(t=this.form)||void 0===t?void 0:t.formGroup)||void 0===e?void 0:e.invalid}get disabled(){return"info"===this.type}ngDoCheck(){this.model!=this.oldmodel&&(this.oldmodel=this.model,this.modelchange())}modelchange(){if(this.issel){var t=this.currenteditactions.getactionbykey(this.model);t.menuId=this.menuId||"",this.form.formGroup.patchValue(t)}}ngOnInit(){this.action(this.type)}ngAfterViewInit(){var t=document.getElementById("seldata");this.issel=!1,"add"==this.type&&(t.style.display="block",t.style.width="130px",this.issel=!0),this.cdr.detectChanges()}action(t){switch(t){case"info":this.service.get(this.id).subscribe(t=>{this.form.formGroup.patchValue(t)});break;case"edit":this.action("info");break;case"save":"add"===this.type?this.service.post(this.setForm(this.form.formGroup.value)).subscribe(t=>{this.message.success("\u65b0\u589e\u6210\u529f\uff01"),this.nav.back(!0)}):"edit"===this.type&&this.service.put(this.setForm(this.form.formGroup.value)).subscribe(t=>{this.message.success("\u4fee\u6539\u6210\u529f\uff01"),this.nav.back(!0)});break;case"cancel":this.nav.back()}}setForm(t){return t}}return t.\u0275fac=function(e){return new(e||t)(r.Ib(c.a),r.Ib(k.a),r.Ib(o.a),r.Ib(u.c),r.Ib(a.a),r.Ib(r.h))},t.\u0275cmp=r.Cb({type:t,selectors:[["app-action-detail"]],viewQuery:function(t,e){var i;1&t&&r.Cc(H,!0),2&t&&r.jc(i=r.Wb())&&(e.form=i.first)},decls:10,vars:7,consts:[[1,"au-inner","au-column"],["top",""],[3,"space"],["icon","fto-chevron-left",3,"click"],["icon","fto-save","type","primary",3,"disabled","click"],["label","\u9009\u62e9\u5185\u5bb9","id","seldata","direction","row",2,"width","150p","display","none",3,"data","ngModel","ngModelChange"],["au-adaption","","direction","row","labelSuffix",":","labelWidth","6rem","width","30rem","labelAlign","end","span","20","space","2",1,"au-panel","au-overflow-auto",3,"outerHeight","disabled","controls"],["form",""]],template:function(t,e){1&t&&(r.Ob(0,"x-inner",0),r.Ob(1,"au-tool",1),r.Ob(2,"x-buttons",2),r.Ob(3,"x-button",3),r.Vb("click",(function(){return e.action("cancel")})),r.xc(4,"\u8fd4\u56de"),r.Nb(),r.Ob(5,"x-button",4),r.Vb("click",(function(){return!e.formInvalid&&e.action("save")})),r.xc(6," \u4fdd\u5b58 "),r.Nb(),r.Ob(7,"x-select",5),r.Vb("ngModelChange",(function(t){return e.model=t})),r.Nb(),r.Nb(),r.Nb(),r.Jb(8,"x-form",6,7),r.Nb()),2&t&&(r.yb(2),r.ec("space",1.5),r.yb(3),r.ec("disabled",e.formInvalid||e.disabled),r.yb(2),r.ec("data",e.editactions)("ngModel",e.model),r.yb(1),r.ec("outerHeight",84)("disabled",e.disabled)("controls",e.controls))},directives:[d.a,h.a,b.c,b.a,O.a,C.q,C.t,N.b,M.a],styles:["[_nghost-%COMP%]   x-row[_ngcontent-%COMP%] > x-col[_ngcontent-%COMP%]{width:15rem}[_nghost-%COMP%]   x-row[_ngcontent-%COMP%]:not(:first-child){margin-top:1rem}"],changeDetection:0}),t})();class S{getactionbykey(t){var e={};switch(t){case"\u67e5\u770b":e={name:"\u67e5\u770b",sort:"1",code:"info",icon:"fto-eye"};break;case"\u65b0\u589e":e={name:"\u65b0\u589e",sort:"2",code:"add",icon:"fto-plus"};break;case"\u4fee\u6539":e={name:"\u4fee\u6539",sort:"3",code:"edit",icon:"fto-edit"};break;case"\u5220\u9664":e={name:"\u5220\u9664",sort:"4",code:"delete",icon:"fto-trash-2"}}return e}}const G=[{path:"",component:s.a},{path:"actions/:menuId",component:w},{path:"actions/:menuId/:type",component:j},{path:"actions/:menuId/:type/:id",component:j}];let V=(()=>{class t{}return t.\u0275mod=r.Gb({type:t}),t.\u0275inj=r.Fb({factory:function(e){return new(e||t)},imports:[[o.i.forChild(G)],o.i]}),t})();var _=i("gjGi"),q=i("873N"),X=i("iaau"),P=i("hHlV");let R=(()=>{class t{}return t.\u0275mod=r.Gb({type:t}),t.\u0275inj=r.Fb({factory:function(e){return new(e||t)},imports:[[n.c,_.a,b.b,P.a,q.a,X.a,V,O.b]]}),t})()},iaau:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n=i("fXoL");let o=(()=>{class t{}return t.\u0275mod=n.Gb({type:t}),t.\u0275inj=n.Fb({factory:function(e){return new(e||t)}}),t})()}}]);