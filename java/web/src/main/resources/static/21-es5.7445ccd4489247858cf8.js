!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,i){if(!e)return;if("string"==typeof e)return t(e,i);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,i)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function n(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=r(e);if(t){var o=r(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return a(this,i)}}function a(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"873N":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("ofXK"),a=i("fXoL"),r=function(){var e=function e(){u(this,e)};return e.\u0275mod=a.Gb({type:e}),e.\u0275inj=a.Fb({factory:function(t){return new(t||e)},imports:[[n.c]]}),e}()},MOn6:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("XNiG"),a=i("3pM9"),r=i("1G5W"),o=i("ofXK"),s=i("fXoL"),l=function(){var e=function(){function e(t,i,a){u(this,e),this.elementRef=t,this.renderer=i,this.doc=a,this.outerHeight=0,this._unSubject=new n.a}return c(e,[{key:"ngAfterViewInit",value:function(){this.setSubject()}},{key:"ngOnDestroy",value:function(){var e;this._unSubject.next(),this._unSubject.unsubscribe(),null===(e=this._resizeObserver)||void 0===e||e.disconnect()}},{key:"setSubject",value:function(){var e=this;Object(a.A)(this.container,this.doc.documentElement).pipe(Object(r.a)(this._unSubject)).subscribe((function(t){e._resizeObserver=t.resizeObserver,e.setAdaptionHeight()}))}},{key:"setAdaptionHeight",value:function(){this.renderer.setStyle(this.elementRef.nativeElement,"height",this.doc.documentElement.clientHeight-this.outerHeight+"px")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.Ib(s.l),s.Ib(s.D),s.Ib(o.e))},e.\u0275dir=s.Db({type:e,selectors:[["","au-adaption",""]],inputs:{outerHeight:"outerHeight",container:"container"}}),e}()},iaau:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("fXoL"),a=function(){var e=function e(){u(this,e)};return e.\u0275mod=n.Gb({type:e}),e.\u0275inj=n.Fb({factory:function(t){return new(t||e)}}),e}()},zw2u:function(t,a,r){"use strict";r.r(a),r.d(a,"RolesModule",(function(){return ee}));var o=r("ofXK"),s=r("tyNb"),l=r("OUFp"),d=r("vkgz"),b=r("lJxs"),f=r("r3AK"),h=r("K7LP"),p=r("wTjX"),v=r("fXoL"),m=r("qMpK"),y=r("x6Xy"),g=r("1uEr"),w=r("Atug"),k=r("/pOC"),x=r("MOn6"),O=r("hMyc"),I=r("GvSL"),N=r("yO6f"),C=r("kXfN"),j=["tableCom"];function H(e,t){if(1&e){var i=v.Pb();v.Ob(0,"div",10),v.Ob(1,"x-link",11),v.Vb("click",(function(){v.lc(i);var e=t.$row,n=v.Yb();return n.auth.info&&n.action("info",e)})),v.Nb(),v.Ob(2,"x-link",12),v.Vb("click",(function(){v.lc(i);var e=t.$row,n=v.Yb();return n.auth.edit&&n.action("edit",e)})),v.Nb(),v.Ob(3,"x-link",13),v.Vb("click",(function(){v.lc(i);var e=t.$row,n=v.Yb();return n.auth.permission&&n.action("permission",e)})),v.Nb(),v.Ob(4,"x-link",14),v.Vb("click",(function(){v.lc(i);var e=t.$row,n=v.Yb();return n.auth.delete&&n.action("delete",e)})),v.Nb(),v.Nb()}if(2&e){var n=v.Yb();v.yb(1),v.ec("disabled",!n.auth.info),v.yb(1),v.ec("disabled",!n.auth.edit),v.yb(1),v.ec("disabled",!n.auth.permission),v.yb(1),v.ec("disabled",!n.auth.delete)}}var R,A,q=function(e){return{actions:e}},S=((R=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(r,t);var a=n(r);function r(e,t,i,n,o,c,s){var l;return u(this,r),(l=a.call(this,t)).service=e,l.indexService=t,l.organization=i,l.router=n,l.activatedRoute=o,l.message=c,l.msgBox=s,l.index=1,l.query={filter:[]},l.data=function(e,t,i){return l.service.getList(e,t,i).pipe((function(e){return e}))},l.treeLoading=!0,l.treeData=function(){return l.organization.getList(1,Number.MAX_SAFE_INTEGER).pipe(Object(d.a)((function(){return l.treeLoading=!1})),Object(b.a)((function(e){return e.list})))},l.columns=[{id:"index",label:"\u5e8f\u53f7",width:80,left:0,type:"index"},{id:"actions",label:"\u64cd\u4f5c",width:120,left:80},{id:"name",label:"\u89d2\u8272\u540d\u79f0",flex:1,sort:!0}],l}return c(r,[{key:"action",value:function(t,i){var n,a,r=this;switch(t){case"add":var o={};this.selected&&(o={selectedId:null===(n=this.selected)||void 0===n?void 0:n.id,selectedLabel:null===(a=this.selected)||void 0===a?void 0:a.label}),this.router.navigate(["./"+t,o],{relativeTo:this.activatedRoute});break;case"info":case"edit":this.router.navigate(["./".concat(t,"/").concat(i.id)],{relativeTo:this.activatedRoute});break;case"delete":this.msgBox.confirm({title:"\u63d0\u793a",content:"\u6b64\u64cd\u4f5c\u5c06\u6c38\u4e45\u5220\u9664\u6b64\u6761\u6570\u636e\uff1a".concat(i.name,"\uff0c\u662f\u5426\u7ee7\u7eed\uff1f"),type:"warning",callback:function(e){"confirm"===e&&r.service.delete(i.id).subscribe((function(e){r.tableCom.change(r.index),r.message.success("\u5220\u9664\u6210\u529f\uff01")}))}});break;case"tree-info":this.selected=i;var c={field:"organizationId",value:i.id,operation:"="};if(this.query.filter&&0!=this.query.filter.length){var u=this.query.filter.find((function(e){return"organizationId"===e.field}));u?u.value=c.value:this.query.filter=[].concat(e(this.query.filter),[c])}else this.query.filter=[c];this.tableCom.change(1);break;case"permission":this.router.navigate(["./permission/"+i.id],{relativeTo:this.activatedRoute})}}}]),r}(h.a)).\u0275fac=function(e){return new(e||R)(v.Ib(l.a),v.Ib(p.a),v.Ib(f.a),v.Ib(s.e),v.Ib(s.a),v.Ib(m.c),v.Ib(y.c))},R.\u0275cmp=v.Cb({type:R,selectors:[["app-roles"]],viewQuery:function(e,t){var i;1&e&&v.Bc(j,!0),2&e&&v.ic(i=v.Wb())&&(t.tableCom=i.first)},features:[v.vb],decls:14,vars:16,consts:[[1,"au-inner"],[1,"au-panel","au-tree-left",3,"x-loading"],["au-adaption","","expandedLevel","0",3,"outerHeight","data","nodeHeight","activatedChange"],["treeCom",""],[1,"au-table-right"],["top",""],["type","primary","icon","fto-plus",3,"disabled","click"],["virtualScroll","","loading","",3,"columns","rowHeight","data","size","index","query","bodyHeight","bodyColumnTpl","adaptionHeight","indexChange"],["tableCom",""],["actionsTpl",""],[1,"au-table-actions"],["icon","fto-eye","title","\u67e5\u770b",3,"disabled","click"],["icon","fto-edit","title","\u4fee\u6539",3,"disabled","click"],["icon","fto-list","title","\u6743\u9650\u8bbe\u7f6e",3,"disabled","click"],["icon","fto-trash-2","title","\u5220\u9664",3,"disabled","click"]],template:function(e,t){if(1&e&&(v.Ob(0,"x-inner",0),v.Ob(1,"div",1),v.Ob(2,"h4"),v.wc(3,"\u7ec4\u7ec7\u673a\u6784"),v.Nb(),v.Ob(4,"x-tree",2,3),v.Vb("activatedChange",(function(e){return t.action("tree-info",e)})),v.Nb(),v.Nb(),v.Ob(6,"div",4),v.Ob(7,"au-tool",5),v.Ob(8,"x-button",6),v.Vb("click",(function(){return t.auth.add&&t.action("add")})),v.wc(9,"\u65b0\u589e"),v.Nb(),v.Nb(),v.Ob(10,"x-table",7,8),v.Vb("indexChange",(function(e){return t.index=e})),v.Nb(),v.Nb(),v.Nb(),v.uc(12,H,5,4,"ng-template",null,9,v.vc)),2&e){var i=v.jc(13);v.yb(1),v.ec("x-loading",t.treeLoading),v.yb(3),v.ec("outerHeight",131)("data",t.treeData)("nodeHeight",1.875),v.yb(4),v.ec("disabled",!t.auth.add),v.yb(2),v.ec("columns",t.columns)("rowHeight",35)("data",t.data)("size",20)("index",t.index)("query",t.query)("bodyHeight",100)("bodyColumnTpl",v.gc(14,q,i))("adaptionHeight",138)}},directives:[g.a,w.a,k.a,x.a,O.a,I.a,N.a,C.a],encapsulation:2}),R),T=r("zM0U"),L=r("vtiB"),_=r("ZQZ3"),z=["form"],E=((A=function(){function e(t,i,n,a,r,o,c){var s=this;u(this,e),this.service=t,this.organization=i,this.setting=n,this.activatedRoute=a,this.message=r,this.nav=o,this.cdr=c,this.config={labelWidth:"6rem"},this.controls=[{control:"input",id:"name",label:"\u89d2\u8272\u540d\u79f0",required:!0},{control:"find",id:"organization",label:"\u7ec4\u7ec7\u673a\u6784",required:!0,treeData:function(){return s.organization.getList(1,Number.MAX_SAFE_INTEGER).pipe(Object(b.a)((function(e){return e.list})))}},{control:"input",id:"id",hidden:!0,value:this.setting.guid()}],this.activatedRoute.paramMap.subscribe((function(e){s.id=e.get("id"),s.type=e.get("type"),s.selected={id:e.get("selectedId"),label:e.get("selectedLabel")},s.selected.id&&(s.controls.find((function(e){return"organization"===e.id})).value=s.selected)}))}return c(e,[{key:"ngOnInit",value:function(){this.action(this.type)}},{key:"ngAfterViewInit",value:function(){this.cdr.detectChanges()}},{key:"action",value:function(e){var t=this;switch(e){case"info":this.service.get(this.id).subscribe((function(e){t.form.formGroup.patchValue(e)}));break;case"edit":this.action("info");break;case"save":"add"===this.type?this.service.post(this.setForm(this.form.formGroup.value)).subscribe((function(e){t.message.success("\u65b0\u589e\u6210\u529f\uff01"),t.nav.back(!0)})):"edit"===this.type&&this.service.put(this.setForm(this.form.formGroup.value)).subscribe((function(e){t.message.success("\u4fee\u6539\u6210\u529f\uff01"),t.nav.back(!0)}));break;case"cancel":this.nav.back()}}},{key:"setForm",value:function(e){return this.setFind(e,"organization"),e}},{key:"setFind",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];for(var a=0,r=i;a<r.length;a++){var o=r[a],c=e[o];e[o]=Array.isArray(c)?c.map((function(e){return{id:e.id,label:e.label}})):{id:c.id,label:c.label}}return e}},{key:"formInvalid",get:function(){var e,t;return null===(t=null===(e=this.form)||void 0===e?void 0:e.formGroup)||void 0===t?void 0:t.invalid}},{key:"disabled",get:function(){return"info"===this.type}}]),e}()).\u0275fac=function(e){return new(e||A)(v.Ib(l.a),v.Ib(f.a),v.Ib(T.a),v.Ib(s.a),v.Ib(m.c),v.Ib(L.a),v.Ib(v.h))},A.\u0275cmp=v.Cb({type:A,selectors:[["app-role-detail"]],viewQuery:function(e,t){var i;1&e&&v.Bc(z,!0),2&e&&v.ic(i=v.Wb())&&(t.form=i.first)},decls:9,vars:5,consts:[[1,"au-inner","au-column"],["top",""],[3,"space"],["icon","fto-chevron-left",3,"click"],["icon","fto-save","type","primary",3,"disabled","click"],["au-adaption","","direction","row","labelSuffix",":","labelWidth","6rem","width","30rem","labelAlign","end","span","20","space","2",1,"au-panel","au-overflow-auto",3,"outerHeight","disabled","controls"],["form",""]],template:function(e,t){1&e&&(v.Ob(0,"x-inner",0),v.Ob(1,"au-tool",1),v.Ob(2,"x-buttons",2),v.Ob(3,"x-button",3),v.Vb("click",(function(){return t.action("cancel")})),v.wc(4,"\u8fd4\u56de"),v.Nb(),v.Ob(5,"x-button",4),v.Vb("click",(function(){return!t.formInvalid&&t.action("save")})),v.wc(6," \u4fdd\u5b58 "),v.Nb(),v.Nb(),v.Nb(),v.Jb(7,"x-form",5,6),v.Nb()),2&e&&(v.yb(2),v.ec("space",.5),v.yb(3),v.ec("disabled",t.formInvalid||t.disabled),v.yb(2),v.ec("outerHeight",84)("disabled",t.disabled)("controls",t.controls))},directives:[g.a,O.a,I.c,I.a,_.b,x.a],encapsulation:2,changeDetection:0}),A),V=r("M9h8"),G=r("qN0K"),M=["treeCom"],X=["tableCom"];function D(e,t){if(1&e&&v.Jb(0,"x-icon",13),2&e){var i=v.Yb().$row;v.ec("type",i.icon)}}function F(e,t){1&e&&v.uc(0,D,1,1,"x-icon",12),2&e&&v.ec("ngIf",t.$row.icon)}var B,P,K,W=function(e){return{icon:e}},$=[{path:"",component:S},{path:"permission/:id",component:(B=function(){function t(e,i,n,a,r,o,c,s){var l=this;u(this,t),this.roles=e,this.menus=i,this.actions=n,this.router=a,this.activatedRoute=r,this.message=o,this.msgBox=c,this.nav=s,this.type="info",this.manual=!1,this.activatedTemp=[],this.checkedRow={},this.index=1,this.query={filter:[],sort:[{field:"sort",value:"asc"}]},this.treeLoading=!0,this.treeData=function(){return l.menus.getList(1,Number.MAX_SAFE_INTEGER,{sort:[{field:"pid",value:"asc"},{field:"sort",value:"asc"}]}).pipe(Object(d.a)((function(){return l.treeLoading=!1})),Object(b.a)((function(e){return e.list})))},this.tableData=function(e,t,i){return l.actions.getList(e,t,i).pipe((function(e){return e}))},this.columns=[{id:"checked",label:"\u9009\u62e9",rowChecked:!0,type:"checkbox",width:60},{id:"index",label:"\u5e8f\u53f7",width:80,type:"index"},{id:"name",label:"\u540d\u79f0",flex:1,sort:!0},{id:"code",label:"\u7f16\u7801",flex:1,sort:!0},{id:"icon",label:"\u56fe\u6807",flex:1},{id:"sort",label:"\u987a\u5e8f",flex:1,sort:!0}],this.activatedRoute.paramMap.subscribe((function(e){l.id=e.get("id")}))}return c(t,[{key:"ngOnInit",value:function(){}},{key:"action",value:function(t,i){var n,a,r,o=this;switch(t){case"actions":this.roles.getActions(this.id,null===(n=this.selected)||void 0===n?void 0:n.id).subscribe((function(e){o.checkedRow={checked:e.map((function(e){return e.id}))},o.activatedTemp=e}));break;case"menu-actions":this.type=t,this.selected=i;var c={field:"menuId",value:i.id,operation:"="};if(this.query.filter&&0!=this.query.filter.length){var u=this.query.filter.find((function(e){return"menuId"===e.field}));u?u.value=c.value:this.query.filter=[].concat(e(this.query.filter),[c])}else this.query.filter=[c];this.manual||(this.manual=!0),this.action("actions",i);break;case"save":this.activatedTemp.length>0?this.roles.putActions(this.id,null===(a=this.selected)||void 0===a?void 0:a.id,this.activatedTemp).subscribe((function(e){o.message.success("\u4fdd\u5b58\u6210\u529f\uff01")})):this.roles.deleteActionmap(this.id,null===(r=this.selected)||void 0===r?void 0:r.id).subscribe((function(e){o.message.success("\u4fdd\u5b58\u6210\u529f\uff01")}));break;case"cancel":this.nav.back();break;case"activated-row-change":i.checked?this.activatedTemp=[].concat(e(this.activatedTemp),[i]):this.activatedTemp.splice(this.activatedTemp.findIndex((function(e){return e.id===i.id})),1)}}},{key:"disabled",get:function(){return void 0===this.selected}}]),t}(),B.\u0275fac=function(e){return new(e||B)(v.Ib(l.a),v.Ib(V.b),v.Ib(V.a),v.Ib(s.e),v.Ib(s.a),v.Ib(m.c),v.Ib(y.c),v.Ib(L.a))},B.\u0275cmp=v.Cb({type:B,selectors:[["app-role-permission"]],viewQuery:function(e,t){var i;1&e&&(v.Bc(M,!0),v.Bc(X,!0)),2&e&&(v.ic(i=v.Wb())&&(t.treeCom=i.first),v.ic(i=v.Wb())&&(t.tableCom=i.first))},decls:17,vars:20,consts:[[1,"au-inner"],[1,"au-panel","au-tree-left",3,"x-loading"],["au-adaption","","expandedLevel","0",3,"outerHeight","data","activatedId","nodeHeight","activatedChange"],["treeCom",""],[1,"au-table-right"],["top",""],["space","0.5"],["icon","fto-chevron-left",3,"click"],["type","primary","icon","fto-plus",3,"disabled","click"],["virtualScroll","","loading","",3,"manual","columns","rowHeight","checkedRow","allowSelectRow","data","size","index","query","bodyHeight","bodyColumnTpl","adaptionHeight","manualChange","activatedRowChange","indexChange"],["tableCom",""],["iconTpl",""],[3,"type",4,"ngIf"],[3,"type"]],template:function(e,t){if(1&e&&(v.Ob(0,"x-inner",0),v.Ob(1,"div",1),v.Ob(2,"h4"),v.wc(3,"\u83dc\u5355\u6811"),v.Nb(),v.Ob(4,"x-tree",2,3),v.Vb("activatedChange",(function(e){return t.action("menu-actions",e)})),v.Nb(),v.Nb(),v.Ob(6,"div",4),v.Ob(7,"au-tool",5),v.Ob(8,"x-buttons",6),v.Ob(9,"x-button",7),v.Vb("click",(function(){return t.action("cancel",t.selected)})),v.wc(10,"\u8fd4\u56de"),v.Nb(),v.Ob(11,"x-button",8),v.Vb("click",(function(){return!t.disabled&&t.action("save",t.selected)})),v.wc(12,"\u4fdd\u5b58"),v.Nb(),v.Nb(),v.Nb(),v.Ob(13,"x-table",9,10),v.Vb("manualChange",(function(e){return t.manual=e}))("activatedRowChange",(function(e){return t.action("activated-row-change",e)}))("indexChange",(function(e){return t.index=e})),v.Nb(),v.Nb(),v.Nb(),v.uc(15,F,1,1,"ng-template",null,11,v.vc)),2&e){var i=v.jc(16);v.yb(1),v.ec("x-loading",t.treeLoading),v.yb(3),v.ec("outerHeight",131)("data",t.treeData)("activatedId",t.activatedId)("nodeHeight",1.875),v.yb(7),v.ec("disabled",t.disabled),v.yb(2),v.ec("manual",t.manual)("columns",t.columns)("rowHeight",35)("checkedRow",t.checkedRow)("allowSelectRow",!1)("data",t.tableData)("size",20)("index",t.index)("query",t.query)("bodyHeight",100)("bodyColumnTpl",v.gc(18,W,i))("adaptionHeight",138)}},directives:[g.a,w.a,k.a,x.a,O.a,I.c,I.a,N.a,o.t,G.a],encapsulation:2}),B)},{path:":type",component:E},{path:":type/:id",component:E}],Y=((P=function e(){u(this,e)}).\u0275mod=v.Gb({type:P}),P.\u0275inj=v.Fb({factory:function(e){return new(e||P)},imports:[[s.i.forChild($)],s.i]}),P),J=r("gjGi"),Q=r("873N"),U=r("iaau"),Z=r("hHlV"),ee=((K=function e(){u(this,e)}).\u0275mod=v.Gb({type:K}),K.\u0275inj=v.Fb({factory:function(e){return new(e||K)},imports:[[o.c,J.a,Z.a,Q.a,U.a,Y]]}),K)}}])}();