(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"1K/t":function(t,e,s){"use strict";s.r(e),s.d(e,"SamplesupplementModule",(function(){return J}));var n=s("ofXK"),i=s("tyNb"),o=s("wTjX"),a=s("x2e1"),r=s("TPaT"),l=s("LZRM"),c=s("GTjD"),d=s("Puy/"),b=s("K7LP"),u=s("BzWU"),p=s("fXoL"),h=s("SfH5"),m=s("oJeN"),g=s("P0lq"),v=s("3Pt+");let y=(()=>{class t{constructor(t){this.commonservice=t,this.testtypeid=999,this.statusid=999,this.storeid=999,this.processid=999,this.oldtesttypeid=0,this.oldstatusid=0,this.oldstoreid=0,this.oldprocessid=0,this.status=[],this.testtype=[],this.curentsample={},this.process=[],this.store=[]}ngDoCheck(){this.setobjetproperti(this.curentsample,"testtype",this.oldtesttypeid,this.testtypeid,this.testtype),this.setobjetproperti(this.curentsample,"status",this.oldstatusid,this.statusid,this.status),this.setobjetproperti(this.curentsample,"process",this.oldprocessid,this.processid,this.process),this.setobjetproperti(this.curentsample,"store",this.oldstoreid,this.storeid,this.store)}ngOnInit(){this.commonservice.gettesttype().subscribe(t=>this.testtype=t.list),this.commonservice.getsamplestatus().subscribe(t=>this.status=t.list),this.commonservice.getsamplestore().subscribe(t=>this.store=t.list),this.commonservice.getsampleprocess().subscribe(t=>this.process=t.list)}setobjetproperti(t,e,s,n,i){s!=n&&(t[e]=i.find(t=>t.id==n),s=n)}setSample(t){var e,s,n;this.curentsample=u.a.deepClone(t),null!=this.curentsample.testtype&&0!=this.curentsample.testtype.id?this.testtypeid=Number(this.curentsample.testtype.id):this.curentsample.testtype={id:999,label:"\u5176\u5b83"},null!=this.curentsample.status&&0!=this.curentsample.status.id?this.statusid=Number(null===(e=this.curentsample.status)||void 0===e?void 0:e.id):this.curentsample.status={id:999,label:"\u5176\u5b83"},null!=this.curentsample.store&&0!=this.curentsample.store.id?this.storeid=Number(null===(s=this.curentsample.store)||void 0===s?void 0:s.id):this.curentsample.store={id:999,label:"\u5176\u5b83"},null!=this.curentsample.process&&0!=this.curentsample.process.id?this.processid=Number(null===(n=this.curentsample.process)||void 0===n?void 0:n.id):this.curentsample.process={id:999,label:"\u5176\u5b83"}}get samplestatusdisabled(){return 999!=this.statusid}get sampletesttypedisabled(){return 999!=this.testtypeid}get sampleprocessdisabled(){return 999!=this.processid}get samplestoredisabled(){return 999!=this.storeid}}return t.\u0275fac=function(e){return new(e||t)(p.Ib(a.c))},t.\u0275cmp=p.Cb({type:t,selectors:[["app-updatesample"]],decls:36,vars:22,consts:[[2,"height","20px"],["span","8"],["label","\u76d1\u6d4b\u7c7b\u578b","direction","row",3,"data","ngModel","ngModelChange"],["span","4"],["label","\u5176\u5b83","direction","row",3,"disabled","ngModel","ngModelChange"],["label","\u6837\u54c1\u72b6\u6001","direction","row",3,"data","ngModel","ngModelChange"],[2,"height","30px"],["label","\u6837\u54c1\u5904\u7406","direction","row",3,"data","ngModel","ngModelChange"],["label","\u4fdd\u5b58\u6761\u4ef6","direction","row",3,"data","ngModel","ngModelChange"],["label","\u89c4\u683c","direction","row",3,"ngModel","ngModelChange"],["label","\u6837\u54c1\u6570\u91cf","direction","row",3,"ngModel","ngModelChange"],["label","\u4ea7\u54c1\u6267\u884c\u6807\u51c6","direction","row",3,"ngModel","ngModelChange"],["label","\u5546\u6807","direction","row",3,"ngModel","ngModelChange"],["label","\u6837\u54c1\u7b49\u7ea7","direction","row",3,"ngModel","ngModelChange"],["label","\u6837\u54c1\u5305\u88c5\u53ca\u6027\u72b6","direction","row",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(p.Jb(0,"x-row",0),p.Ob(1,"x-row"),p.Ob(2,"x-col",1),p.Ob(3,"x-select",2),p.Vb("ngModelChange",(function(t){return e.testtypeid=t})),p.Nb(),p.Nb(),p.Ob(4,"x-col",3),p.Ob(5,"x-input",4),p.Vb("ngModelChange",(function(t){return e.curentsample.testtypeother=t})),p.Nb(),p.Nb(),p.Ob(6,"x-col",1),p.Ob(7,"x-select",5),p.Vb("ngModelChange",(function(t){return e.statusid=t})),p.Nb(),p.Nb(),p.Ob(8,"x-col",3),p.Ob(9,"x-input",4),p.Vb("ngModelChange",(function(t){return e.curentsample.statusother=t})),p.Nb(),p.Nb(),p.Nb(),p.Jb(10,"x-row",6),p.Ob(11,"x-row"),p.Ob(12,"x-col",1),p.Ob(13,"x-select",7),p.Vb("ngModelChange",(function(t){return e.processid=t})),p.Nb(),p.Nb(),p.Ob(14,"x-col",3),p.Ob(15,"x-input",4),p.Vb("ngModelChange",(function(t){return e.curentsample.processother=t})),p.Nb(),p.Nb(),p.Ob(16,"x-col",1),p.Ob(17,"x-select",8),p.Vb("ngModelChange",(function(t){return e.storeid=t})),p.Nb(),p.Nb(),p.Ob(18,"x-col",3),p.Ob(19,"x-input",4),p.Vb("ngModelChange",(function(t){return e.curentsample.storeother=t})),p.Nb(),p.Nb(),p.Nb(),p.Jb(20,"x-row",6),p.Ob(21,"x-row"),p.Ob(22,"x-col",1),p.Ob(23,"x-input",9),p.Vb("ngModelChange",(function(t){return e.curentsample.samplespec=t})),p.Nb(),p.Nb(),p.Ob(24,"x-col",1),p.Ob(25,"x-input",10),p.Vb("ngModelChange",(function(t){return e.curentsample.samplequality=t})),p.Nb(),p.Nb(),p.Ob(26,"x-col",1),p.Ob(27,"x-input",11),p.Vb("ngModelChange",(function(t){return e.curentsample.executestandard=t})),p.Nb(),p.Nb(),p.Nb(),p.Jb(28,"x-row",6),p.Ob(29,"x-row"),p.Ob(30,"x-col",1),p.Ob(31,"x-input",12),p.Vb("ngModelChange",(function(t){return e.curentsample.brand=t})),p.Nb(),p.Nb(),p.Ob(32,"x-col",1),p.Ob(33,"x-input",13),p.Vb("ngModelChange",(function(t){return e.curentsample.executegrade=t})),p.Nb(),p.Nb(),p.Ob(34,"x-col",1),p.Ob(35,"x-input",14),p.Vb("ngModelChange",(function(t){return e.curentsample.wrapherproperties=t})),p.Nb(),p.Nb(),p.Nb()),2&t&&(p.yb(3),p.ec("data",e.testtype)("ngModel",e.testtypeid),p.yb(2),p.ec("disabled",e.sampletesttypedisabled)("ngModel",e.curentsample.testtypeother),p.yb(2),p.ec("data",e.status)("ngModel",e.statusid),p.yb(2),p.ec("disabled",e.samplestatusdisabled)("ngModel",e.curentsample.statusother),p.yb(4),p.ec("data",e.process)("ngModel",e.processid),p.yb(2),p.ec("disabled",e.sampleprocessdisabled)("ngModel",e.curentsample.processother),p.yb(2),p.ec("data",e.store)("ngModel",e.storeid),p.yb(2),p.ec("disabled",e.samplestoredisabled)("ngModel",e.curentsample.storeother),p.yb(4),p.ec("ngModel",e.curentsample.samplespec),p.yb(2),p.ec("ngModel",e.curentsample.samplequality),p.yb(2),p.ec("ngModel",e.curentsample.executestandard),p.yb(4),p.ec("ngModel",e.curentsample.brand),p.yb(2),p.ec("ngModel",e.curentsample.executegrade),p.yb(2),p.ec("ngModel",e.curentsample.wrapherproperties))},directives:[h.c,h.a,m.a,v.q,v.t,g.a],styles:[""]}),t})();var f=s("qMpK"),x=s("l5Yv"),M=s("GvSL"),O=s("/pOC"),C=s("yO6f"),w=s("kXfN");const N=["modifisample"];function P(t,e){if(1&t){const t=p.Pb();p.Ob(0,"div",20),p.Ob(1,"x-link",21),p.Vb("click",(function(){p.lc(t);const s=e.$row;return p.Yb().projectclick(s)})),p.Nb(),p.Nb()}}const j=function(t){return{actions:t}},_=[{path:"",component:(()=>{class t extends b.a{constructor(t,e,s,n,i,o,a,r){super(t),this.indexService=t,this.flowservice=e,this.sampleservice=s,this.contactservice=n,this.actroute=i,this.router=o,this.globalaudit=a,this.msg=r,this.modifyvisible=!1,this.taskid="",this.delegatecustomer="",this.testcustomer="",this.paycustomer="",this.servicetype="",this.ispanding="",this.seal="",this.samplesource="",this.projects=[],this.currentcontact={},this.contactid="",this.sampledata=[],this.columns=[{id:"actions",label:"\u64cd\u4f5c",width:100},{id:"samplename",label:"\u540d\u79f0",width:150,sort:!0},{id:"storelabel",label:"\u4fdd\u5b58\u6761\u4ef6",width:150,sort:!0},{id:"testtypelabel",label:"\u76d1\u6d4b\u7c7b\u522b",width:150,sort:!0},{id:"processlabel",label:"\u5904\u7406\u65b9\u5f0f",width:150,sort:!0},{id:"statuslabel",label:"\u6837\u54c1\u72b6\u6001",width:150,sort:!0},{id:"samplespec",label:"\u89c4\u683c",width:150,sort:!0},{id:"brand",label:"\u5546\u6807",width:150,sort:!0},{id:"executestandard",label:"\u4ea7\u54c1\u6267\u884c\u6807\u51c6",width:150,sort:!0},{id:"wrapherproperties",label:"\u6837\u54c1\u5305\u88c5\u53ca\u6027\u72b6",width:150,sort:!0},{id:"samplequality",label:"\u6837\u54c1\u6570\u91cf",width:150,sort:!0},{id:"executegrade",label:"\u6837\u54c1\u7b49\u7ea7",width:150,sort:!0}],this.index=0,this.size=200,this.total=0,this.query={},null!=i&&i.params.subscribe(t=>{this.contactid=t.contactid,this.taskid=t.taskid,this.getData()})}gettypelable(t,e,s){return null!=e&&null!=e[t]&&null!=e[t].id?999==e[t].id?e[s]:e[t].label:""}projectclick(t){this.modifyvisible=!0,this.modifisample.setSample(t)}modifyconfirm(){this.projects.map(t=>{var e;null===(e=t.samples)||void 0===e||e.map(t=>{if(t.id==this.modifisample.curentsample.id){for(var e in t)"id"!=e&&(t[e]=this.modifisample.curentsample[e]);this.setsamplelabel(t)}})}),this.sampledata=[...this.sampledata]}getData(){this.contactservice.getcontactproject(this.contactid+"").subscribe(t=>{var e,s;if(this.currentcontact=t.contact,this.projects=t.projects,null!=this.currentcontact&&null!=this.currentcontact.contactcustomers){this.delegatecustomer="",this.testcustomer="",this.paycustomer="";var n=this.currentcontact.contactcustomers.filter(t=>1==t.customertype);if(n.length>0)for(var i=0;i<n.length;i++)0!=i&&(this.delegatecustomer=this.delegatecustomer+","),this.delegatecustomer=this.delegatecustomer+n[i].customername;var o=this.currentcontact.contactcustomers.find(t=>2==t.customertype);if(this.paycustomer=(null==o?void 0:o.customername)+"",o=this.currentcontact.contactcustomers.find(t=>3==t.customertype),this.testcustomer=(null==o?void 0:o.customername)+"",this.servicetype="",this.servicetype=(null===(e=this.currentcontact.service)||void 0===e?void 0:e.label)+"",this.ispanding=1==this.currentcontact.isjudgement?"\u662f":"\u5426",this.seal="",null!=this.currentcontact.seal)for(i=0;i<this.currentcontact.seal.length;i++)this.seal=this.seal+this.currentcontact.seal[i].label+",";this.samplesource=(null===(s=this.currentcontact.samplesource)||void 0===s?void 0:s.label)+""}var a={id:u.a.JsNewGuid(),type:0,label:"\u6240\u6709\u9879\u76ee",reportcount:0,domainlabel:"",pid:null,samples:[]};this.projects.map(t=>{t.label=t.projectnumber,t.pid=a.id,t.domainlabel=t.domain.label,a.reportcount=a.reportcount+t.reportcount,a.domainlabel=a.domainlabel+""+t.domain.label+",",t.samples.map(t=>{a.samples.push(t)}),t.type=1}),this.projects.push(a)})}ngOnInit(){}submit(){let t=[];this.projects.map(e=>{var s;null===(s=e.samples)||void 0===s||s.map(e=>t.push(e))}),t.length>0&&this.sampleservice.supplimentupdatesamples(t).subscribe(t=>{var e;this.flowservice.excutetask(this.taskid,{iscollection:1==(null===(e=this.currentcontact.samplesource)||void 0===e?void 0:e.id)?0:1,userid:this.indexService.auth.user.id+"",username:this.indexService.auth.user.name,contactid:this.currentcontact.id}).subscribe(t=>{this.msg.success("\u63d0\u4ea4\u6210\u529f\uff01")})})}setsamplelabel(t){var e,s,n,i;t.storelabel=null===(e=t.store)||void 0===e?void 0:e.label,t.testtypelabel=null===(s=t.testtype)||void 0===s?void 0:s.label,t.statuslabel=null===(n=t.status)||void 0===n?void 0:n.label,t.processlabel=null===(i=t.process)||void 0===i?void 0:i.label}action(t){var e;this.sampledata=[],null===(e=t.samples)||void 0===e||e.map(t=>{this.setsamplelabel(t),this.sampledata.push(t)})}activechange(t){}IndexChange(t){}}return t.\u0275fac=function(e){return new(e||t)(p.Ib(o.a),p.Ib(r.a),p.Ib(c.a),p.Ib(l.a),p.Ib(i.a),p.Ib(i.e),p.Ib(d.a),p.Ib(f.c))},t.\u0275cmp=p.Cb({type:t,selectors:[["app-samplesupplement"]],viewQuery:function(t,e){var s;1&t&&p.Bc(N,!0),2&t&&p.ic(s=p.Wb())&&(e.modifisample=s.first)},features:[p.vb],decls:40,vars:20,consts:[["width","40%","height","40%","placement","top",3,"visible","visibleChange","confirm"],["dialogmodifyquali",""],[2,"width","100%","height","100%"],["modifisample",""],[2,"overflow","auto"],[2,"height","15px"],["icon","ado-check","type","primary","plain","",3,"click"],[2,"height","20px"],["span","12"],["span","6"],["span","4"],[2,"height","30px"],["span","5"],[2,"overflow","scroll","height","680px"],["au-adaption","",3,"data","nodeHeight","activatedChange"],["treeCom",""],["span","19"],["virtualScroll","","loading","",3,"data","columns","index","size","total","query","adaptionHeight","bodyColumnTpl","indexChange","sizeChange","activatedRowChange"],["projectlist",""],["contactTpl",""],[1,"au-table-actions"],["icon","fto-edit","title","\u4fee\u6539",3,"click"]],template:function(t,e){if(1&t&&(p.Ob(0,"x-dialog",0,1),p.Vb("visibleChange",(function(t){return e.modifyvisible=t}))("confirm",(function(){return e.modifyconfirm()})),p.Jb(2,"app-updatesample",2,3),p.Nb(),p.Ob(4,"div",4),p.Jb(5,"x-row",5),p.Ob(6,"x-row"),p.Ob(7,"x-button",6),p.Vb("click",(function(){return e.submit()})),p.wc(8,"\u63d0\u4ea4"),p.Nb(),p.Nb(),p.Jb(9,"x-row",7),p.Ob(10,"x-row"),p.Ob(11,"x-col",8),p.wc(12),p.Nb(),p.Ob(13,"x-col",9),p.wc(14),p.Nb(),p.Ob(15,"x-col",9),p.wc(16),p.Nb(),p.Nb(),p.Jb(17,"x-row",7),p.Ob(18,"x-row"),p.Ob(19,"x-col",10),p.wc(20),p.Nb(),p.Ob(21,"x-col",10),p.wc(22),p.Nb(),p.Ob(23,"x-col",10),p.wc(24),p.Nb(),p.Ob(25,"x-col",10),p.wc(26),p.Nb(),p.Nb(),p.Jb(27,"x-row",11),p.Ob(28,"x-row"),p.Ob(29,"x-col",12),p.Ob(30,"div",13),p.Ob(31,"h4"),p.wc(32,"\u9879\u76ee"),p.Nb(),p.Ob(33,"x-tree",14,15),p.Vb("activatedChange",(function(t){return e.action(t)})),p.Nb(),p.Nb(),p.Nb(),p.Ob(35,"x-col",16),p.Ob(36,"x-table",17,18),p.Vb("indexChange",(function(t){return e.index=t}))("sizeChange",(function(t){return e.size=t}))("activatedRowChange",(function(t){return e.activechange(t)}))("indexChange",(function(t){return e.IndexChange(t)})),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.uc(38,P,2,0,"ng-template",null,19,p.vc)),2&t){const t=p.jc(39);p.ec("visible",e.modifyvisible),p.yb(12),p.yc("\u59d4\u6258\u5ba2\u6237:",e.delegatecustomer,""),p.yb(2),p.yc("\u4ed8\u6b3e\u5ba2\u6237:",e.paycustomer,""),p.yb(2),p.yc("\u53d7\u68c0\u5ba2\u6237:",e.testcustomer,""),p.yb(4),p.yc("\u6837\u54c1\u6765\u6e90:",e.samplesource,""),p.yb(2),p.yc("\u662f\u5426\u5224\u5b9a:",e.ispanding,""),p.yb(2),p.yc("\u8d44\u8d28\u76d6\u7ae0:",e.seal,""),p.yb(2),p.yc("\u670d\u52a1\u7c7b\u578b:",e.servicetype,""),p.yb(7),p.ec("data",e.projects)("nodeHeight",1.875),p.yb(3),p.ec("data",e.sampledata)("columns",e.columns)("index",e.index)("size",e.size)("total",e.total)("query",e.query)("adaptionHeight",240)("bodyColumnTpl",p.gc(18,j,t))}},directives:[x.a,y,h.c,M.a,h.a,O.a,C.a,w.a],styles:["[_nghost-%COMP%]   table[_ngcontent-%COMP%]{width:100%;background:var(--x-background);border-collapse:collapse;border:.0625rem solid var(--x-border-200)}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%], [_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{border-bottom:.0625rem solid var(--x-border-200);text-align:left;padding:.5rem 1rem}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child > td[_ngcontent-%COMP%], [_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child > th[_ngcontent-%COMP%]{border-width:1px}[_nghost-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap;color:var(--x-text-300)}[_nghost-%COMP%]   div.solid[_ngcontent-%COMP%]{border-top:.0625rem solid var(--x-border)}[_nghost-%COMP%]   div.dashed[_ngcontent-%COMP%]{border-top:.0625rem dashed var(--x-border)}"]}),t})()}];let V=(()=>{class t{}return t.\u0275mod=p.Gb({type:t}),t.\u0275inj=p.Fb({factory:function(e){return new(e||t)},imports:[[i.i.forChild(_)],i.i]}),t})();var k=s("hHlV"),I=s("gjGi");let J=(()=>{class t{}return t.\u0275mod=p.Gb({type:t}),t.\u0275inj=p.Fb({factory:function(e){return new(e||t)},imports:[[n.c,k.a,I.a,h.b,M.b,x.b,g.b,m.b,V]]}),t})()},BzWU:function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));var n=s("LvDl");let i=(()=>{class t{static JsNewGuid(){for(var t="",e=1;e<=32;e++)t+=Math.floor(16*Math.random()).toString(16),8!=e&&12!=e&&16!=e&&20!=e||(t+="-");return t}static setafterdelete(t,e){var s=e.findIndex(e=>e.id==t);return e.splice(s,1),s}static cloneobject(t){var e={};for(var s in t)e[s]=t[s];return e}static deepClone(e){var s={};if(e&&"object"==typeof e)for(var i in e)null!=e[i]&&e.hasOwnProperty(i)&&(s[i]=Object(n.isArray)(e[i])?t.deepcloneobjectarray(e[i]):e[i]&&"object"==typeof e[i]?t.deepClone(e[i]):e[i]);return s}static deepcloneobjectarray(e){for(var s=[],n=0;n<e.length;n++)s.push(t.deepClone(e[n]));return s}static cloneobjectarray(e){for(var s=[],n=0;n<e.length;n++)s.push(t.cloneobject(e[n]));return s}static GetRandomStr(t,e,s){var n="",i=e,o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];t&&(i=Math.round(Math.random()*(s-e))+e);for(var a=0;a<i;a++)n+=o[Math.round(Math.random()*(o.length-1))];return n}static RndNum(t){for(var e="",s=0;s<t;s++)e+=Math.floor(10*Math.random());return e}}return t.num=t.RndNum(5),t})()}}]);