(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"873N":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var s=i("ofXK"),r=i("fXoL");let n=(()=>{class e{}return e.\u0275mod=r.Gb({type:e}),e.\u0275inj=r.Fb({factory:function(t){return new(t||e)},imports:[[s.c]]}),e})()},K7LP:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));class s{constructor(e){this.indexService=e,this.auth={};let t=this.indexService.menuChange.subscribe(e=>{this.baseInit(),t.unsubscribe()})}baseInit(){var e,t,i,s,r;this.menu=null===(t=null===(e=this.indexService.auth.user.permissions)||void 0===e?void 0:e.menus)||void 0===t?void 0:t.find(e=>e.router==this.indexService.session.activatedPage),this.actions=null===(s=null===(i=this.indexService.auth.user.permissions)||void 0===i?void 0:i.actions)||void 0===s?void 0:s.filter(e=>{var t;return e.menuId==(null===(t=this.menu)||void 0===t?void 0:t.id)}),null===(r=this.actions)||void 0===r||r.forEach(e=>this.auth[e.code]=!0)}unAuth(e){return!this.auth[e]}}},MOn6:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var s=i("XNiG"),r=i("3pM9"),n=i("1G5W"),o=i("ofXK"),a=i("fXoL");let c=(()=>{class e{constructor(e,t,i){this.elementRef=e,this.renderer=t,this.doc=i,this.outerHeight=0,this._unSubject=new s.a}ngAfterViewInit(){this.setSubject()}ngOnDestroy(){var e;this._unSubject.next(),this._unSubject.unsubscribe(),null===(e=this._resizeObserver)||void 0===e||e.disconnect()}setSubject(){Object(r.A)(this.container,this.doc.documentElement).pipe(Object(n.a)(this._unSubject)).subscribe(e=>{this._resizeObserver=e.resizeObserver,this.setAdaptionHeight()})}setAdaptionHeight(){this.renderer.setStyle(this.elementRef.nativeElement,"height",this.doc.documentElement.clientHeight-this.outerHeight+"px")}}return e.\u0275fac=function(t){return new(t||e)(a.Ib(a.l),a.Ib(a.D),a.Ib(o.e))},e.\u0275dir=a.Db({type:e,selectors:[["","au-adaption",""]],inputs:{outerHeight:"outerHeight",container:"container"}}),e})()},gjbA:function(e,t,i){"use strict";i.r(t),i.d(t,"OrganizationModule",(function(){return H}));var s=i("ofXK"),r=i("tyNb"),n=i("r3AK"),o=i("vkgz"),a=i("lJxs"),c=i("3Pt+"),d=i("3pM9"),u=i("K7LP"),l=i("wTjX"),h=i("fXoL"),b=i("qMpK"),p=i("x6Xy"),f=i("1uEr"),v=i("Atug"),m=i("kXfN"),g=i("/pOC"),y=i("MOn6"),G=i("hMyc"),w=i("GvSL"),O=i("ZQZ3");const x=["treeCom"],j=[{path:"",component:(()=>{class e extends u.a{constructor(e,t,i,s){super(t),this.service=e,this.indexService=t,this.message=i,this.msgBox=s,this.formGroup=new c.j({}),this.type="info",this.treeLoading=!0,this.data=()=>this.service.getList(1,Number.MAX_SAFE_INTEGER,{sort:[{field:"pid",value:"asc"},{field:"sort",value:"asc"}]}).pipe(Object(o.a)(()=>this.treeLoading=!1),Object(a.a)(e=>e.list)),this.treeActions=[{id:"add",label:"\u65b0\u589e",icon:"fto-plus-square",handler:e=>{this.action("add",e)}},{id:"edit",label:"\u4fee\u6539",icon:"fto-edit",handler:e=>{this.action("edit",e)}},{id:"delete",label:"\u5220\u9664",icon:"fto-trash-2",handler:e=>{this.action("delete",e)}}],this.controls=[{controls:[{control:"input",id:"label",label:"\u540d\u79f0",required:!0},{control:"input",id:"icon",label:"\u56fe\u6807"},{control:"select",id:"type",label:"\u7c7b\u578b",data:[{id:"group",label:"\u4e8b\u4e1a\u90e8"},{id:"subsidiary",label:"\u5b50\u516c\u53f8"},{id:"department",label:"\u90e8\u95e8"}],value:"department"},{control:"radio",data:[{id:1,label:"\u662f"},{id:0,label:"\u5426"}],id:"checkprice",label:"\u67e5\u770b\u4ef7\u683c"},{control:"input",id:"sort",label:"\u987a\u5e8f"}]},{hidden:!0,controls:[{control:"input",id:"id"},{control:"input",id:"pid"}]}]}get disabled(){return!["edit","add","add-root"].includes(this.type)}ngOnInit(){this.treeActions=this.treeActions.filter(e=>this.auth[e.id])}action(e,t){switch(e){case"info":this.type=e,this.selected=t,this.service.get(null==t?void 0:t.id).subscribe(e=>{this.formGroup.patchValue(e)});break;case"add":this.type=e,this.selected=t,this.formGroup.reset(),this.formGroup.patchValue({id:Object(d.M)(),pid:t.id,type:"department",checkprice:0});break;case"add-root":this.type=e,this.formGroup.reset(),this.formGroup.patchValue({id:Object(d.M)(),pid:null,type:"",checkprice:0});break;case"edit":this.type=e,this.service.get(null==t?void 0:t.id).subscribe(e=>{this.formGroup.patchValue(e)});break;case"delete":this.msgBox.confirm({title:"\u63d0\u793a",content:`\u6b64\u64cd\u4f5c\u5c06\u6c38\u4e45\u5220\u9664\u6b64\u6761\u6570\u636e\uff1a${t.label}\uff0c\u662f\u5426\u7ee7\u7eed\uff1f`,type:"warning",callback:e=>{"confirm"===e&&this.service.delete(t.id).subscribe(e=>{this.treeCom.removeNode(t),this.formGroup.reset(),this.message.success("\u5220\u9664\u6210\u529f\uff01")})}});break;case"save":"add"===this.type||"add-root"===this.type?this.service.post(this.formGroup.value).subscribe(e=>{this.type="info",this.treeCom.addNode(e),this.message.success("\u65b0\u589e\u6210\u529f\uff01")}):"edit"===this.type&&this.service.put(this.formGroup.value).subscribe(e=>{this.type="info",this.treeCom.updateNode(t,this.formGroup.value),this.message.success("\u4fee\u6539\u6210\u529f\uff01")});break;case"cancel":this.type="info",this.formGroup.reset()}}}return e.\u0275fac=function(t){return new(t||e)(h.Ib(n.a),h.Ib(l.a),h.Ib(b.c),h.Ib(p.c))},e.\u0275cmp=h.Cb({type:e,selectors:[["app-organization"]],viewQuery:function(e,t){var i;1&e&&h.Bc(x,!0),2&e&&h.ic(i=h.Wb())&&(t.treeCom=i.first)},features:[h.vb],decls:14,vars:13,consts:[[1,"au-inner"],[1,"au-panel","au-tree-left",2,"width","22rem",3,"x-loading"],["icon","fto-plus","title","\u589e\u52a0\u6839\u8282\u70b9",3,"disabled","click"],["au-adaption","","expandedLevel","0",3,"outerHeight","data","activatedId","nodeHeight","actions","activatedChange"],["treeCom",""],[1,"au-form-right"],["top",""],[3,"space"],["icon","fto-save","type","primary",3,"disabled","click"],["au-adaption","","direction","row","labelSuffix",":","labelWidth","6rem","width","24rem","labelAlign","end","span","20","space","2",1,"au-panel","au-overflow-auto",3,"outerHeight","formGroup","controls","disabled"]],template:function(e,t){1&e&&(h.Ob(0,"x-inner",0),h.Ob(1,"div",1),h.Ob(2,"h4"),h.Ob(3,"span"),h.wc(4,"\u7ec4\u7ec7\u673a\u6784"),h.Nb(),h.Ob(5,"x-link",2),h.Vb("click",(function(){return t.auth["add-root"]&&t.action("add-root",t.selected)})),h.Nb(),h.Nb(),h.Ob(6,"x-tree",3,4),h.Vb("activatedChange",(function(e){return t.action("info",e)})),h.Nb(),h.Nb(),h.Ob(8,"div",5),h.Ob(9,"au-tool",6),h.Ob(10,"x-buttons",7),h.Ob(11,"x-button",8),h.Vb("click",(function(){return!t.formGroup.invalid&&!t.disabled&&t.action("save",t.selected)})),h.wc(12," \u4fdd\u5b58 "),h.Nb(),h.Nb(),h.Nb(),h.Jb(13,"x-form",9),h.Nb(),h.Nb()),2&e&&(h.yb(1),h.ec("x-loading",t.treeLoading),h.yb(4),h.ec("disabled",!t.auth["add-root"]),h.yb(1),h.ec("outerHeight",131)("data",t.data)("activatedId",t.activatedId)("nodeHeight",1.875)("actions",t.treeActions),h.yb(4),h.ec("space",.5),h.yb(1),h.ec("disabled",t.formGroup.invalid||t.disabled),h.yb(2),h.ec("outerHeight",138)("formGroup",t.formGroup)("controls",t.controls)("disabled",t.disabled))},directives:[f.a,v.a,m.a,g.a,y.a,G.a,w.c,w.a,O.b,c.r,c.k],encapsulation:2,changeDetection:0}),e})()}];let k=(()=>{class e{}return e.\u0275mod=h.Gb({type:e}),e.\u0275inj=h.Fb({factory:function(t){return new(t||e)},imports:[[r.i.forChild(j)],r.i]}),e})();var N=i("gjGi"),I=i("873N"),S=i("iaau"),A=i("hHlV");let H=(()=>{class e{}return e.\u0275mod=h.Gb({type:e}),e.\u0275inj=h.Fb({factory:function(t){return new(t||e)},imports:[[s.c,N.a,A.a,I.a,S.a,k]]}),e})()},iaau:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var s=i("fXoL");let r=(()=>{class e{}return e.\u0275mod=s.Gb({type:e}),e.\u0275inj=s.Fb({factory:function(t){return new(t||e)}}),e})()}}]);