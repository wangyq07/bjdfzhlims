!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=o(e);if(t){var a=o(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return r(this,n)}}function r(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{"873N":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("ofXK"),r=n("fXoL"),o=function(){var e=function e(){u(this,e)};return e.\u0275mod=r.Gb({type:e}),e.\u0275inj=r.Fb({factory:function(t){return new(t||e)},imports:[[i.c]]}),e}()},K7LP:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(t){var n=this;u(this,e),this.indexService=t,this.auth={};var i=this.indexService.menuChange.subscribe((function(e){n.baseInit(),i.unsubscribe()}))}return c(e,[{key:"baseInit",value:function(){var e,t,n,i,r,o=this;this.menu=null===(t=null===(e=this.indexService.auth.user.permissions)||void 0===e?void 0:e.menus)||void 0===t?void 0:t.find((function(e){return e.router==o.indexService.session.activatedPage})),this.actions=null===(i=null===(n=this.indexService.auth.user.permissions)||void 0===n?void 0:n.actions)||void 0===i?void 0:i.filter((function(e){var t;return e.menuId==(null===(t=o.menu)||void 0===t?void 0:t.id)})),null===(r=this.actions)||void 0===r||r.forEach((function(e){return o.auth[e.code]=!0}))}},{key:"unAuth",value:function(e){return!this.auth[e]}}]),e}()},MOn6:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("XNiG"),r=n("3pM9"),o=n("1G5W"),a=n("ofXK"),s=n("fXoL"),l=function(){var e=function(){function e(t,n,r){u(this,e),this.elementRef=t,this.renderer=n,this.doc=r,this.outerHeight=0,this._unSubject=new i.a}return c(e,[{key:"ngAfterViewInit",value:function(){this.setSubject()}},{key:"ngOnDestroy",value:function(){var e;this._unSubject.next(),this._unSubject.unsubscribe(),null===(e=this._resizeObserver)||void 0===e||e.disconnect()}},{key:"setSubject",value:function(){var e=this;Object(r.A)(this.container,this.doc.documentElement).pipe(Object(o.a)(this._unSubject)).subscribe((function(t){e._resizeObserver=t.resizeObserver,e.setAdaptionHeight()}))}},{key:"setAdaptionHeight",value:function(){this.renderer.setStyle(this.elementRef.nativeElement,"height",this.doc.documentElement.clientHeight-this.outerHeight+"px")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.Ib(s.l),s.Ib(s.D),s.Ib(a.e))},e.\u0275dir=s.Db({type:e,selectors:[["","au-adaption",""]],inputs:{outerHeight:"outerHeight",container:"container"}}),e}()},iaau:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("fXoL"),r=function(){var e=function e(){u(this,e)};return e.\u0275mod=i.Gb({type:e}),e.\u0275inj=i.Fb({factory:function(t){return new(t||e)}}),e}()},sRtM:function(t,r,o){"use strict";o.r(r),o.d(r,"UsersModule",(function(){return W}));var a=o("ofXK"),s=o("tyNb"),l=o("9Dsi"),d=o("vkgz"),f=o("lJxs"),b=o("r3AK"),h=o("wTjX"),p=o("K7LP"),v=o("fXoL"),y=o("qMpK"),m=o("x6Xy"),g=o("1uEr"),w=o("Atug"),O=o("/pOC"),x=o("MOn6"),k=o("hMyc"),I=o("GvSL"),j=o("yO6f"),A=o("kXfN"),N=["tableCom"];function S(e,t){if(1&e){var n=v.Pb();v.Ob(0,"div",10),v.Ob(1,"x-link",11),v.Vb("click",(function(){v.lc(n);var e=t.$row,i=v.Yb();return i.auth.info&&i.action("info",e)})),v.Nb(),v.Ob(2,"x-link",12),v.Vb("click",(function(){v.lc(n);var e=t.$row,i=v.Yb();return i.auth.edit&&i.action("edit",e)})),v.Nb(),v.Ob(3,"x-link",13),v.Vb("click",(function(){v.lc(n);var e=t.$row,i=v.Yb();return i.auth.delete&&i.action("delete",e)})),v.Nb(),v.Nb()}if(2&e){var i=v.Yb();v.yb(1),v.ec("disabled",!i.auth.info),v.yb(1),v.ec("disabled",!i.auth.edit),v.yb(1),v.ec("disabled",!i.auth.delete)}}var C,z,H,_,E=function(e){return{actions:e}},L=((C=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(o,t);var r=i(o);function o(e,t,n,i,a,c,s){var l;return u(this,o),(l=r.call(this,t)).service=e,l.indexService=t,l.organization=n,l.router=i,l.activatedRoute=a,l.message=c,l.msgBox=s,l.index=1,l.query={filter:[]},l.data=function(e,t,n){return l.service.getList(e,t,n).pipe((function(e){return e}))},l.treeLoading=!0,l.treeData=function(){return l.organization.getList(1,Number.MAX_SAFE_INTEGER).pipe(Object(d.a)((function(){return l.treeLoading=!1})),Object(f.a)((function(e){return e.list})))},l.columns=[{id:"index",label:"\u5e8f\u53f7",width:80,left:0,type:"index"},{id:"actions",label:"\u64cd\u4f5c",width:100,left:80},{id:"account",label:"\u7528\u6237",width:100,left:180,sort:!0},{id:"name",label:"\u59d3\u540d",width:80,sort:!0},{id:"email",label:"\u90ae\u7bb1",flex:1},{id:"phone",label:"\u7535\u8bdd",flex:1}],l}return c(o,[{key:"action",value:function(t,n){var i,r,o=this;switch(t){case"add":var a={};this.selected&&(a={selectedId:null===(i=this.selected)||void 0===i?void 0:i.id,selectedLabel:null===(r=this.selected)||void 0===r?void 0:r.label}),this.router.navigate(["./"+t,a],{relativeTo:this.activatedRoute});break;case"info":case"edit":this.router.navigate(["./".concat(t,"/").concat(n.id)],{relativeTo:this.activatedRoute});break;case"delete":this.msgBox.confirm({title:"\u63d0\u793a",content:"\u6b64\u64cd\u4f5c\u5c06\u6c38\u4e45\u5220\u9664\u6b64\u6761\u6570\u636e\uff1a".concat(n.account,"\uff0c\u662f\u5426\u7ee7\u7eed\uff1f"),type:"warning",callback:function(e){"confirm"===e&&o.service.delete(n.id).subscribe((function(e){o.tableCom.change(o.index),o.message.success("\u5220\u9664\u6210\u529f\uff01")}))}});break;case"tree-info":this.selected=n;var c={field:"id",value:n.id,operation:"=",relation:"organizations"};if(this.query.filter&&0!=this.query.filter.length){var u=this.query.filter.find((function(e){return"id"===e.field&&"organizations"===e.relation}));u?u.value=c.value:this.query.filter=[].concat(e(this.query.filter),[c])}else this.query.filter=[c];this.tableCom.change(1)}}}]),o}(p.a)).\u0275fac=function(e){return new(e||C)(v.Ib(l.a),v.Ib(h.a),v.Ib(b.a),v.Ib(s.e),v.Ib(s.a),v.Ib(y.c),v.Ib(m.c))},C.\u0275cmp=v.Cb({type:C,selectors:[["app-users"]],viewQuery:function(e,t){var n;1&e&&v.Bc(N,!0),2&e&&v.ic(n=v.Wb())&&(t.tableCom=n.first)},features:[v.vb],decls:14,vars:16,consts:[[1,"au-inner"],[1,"au-panel","au-tree-left",3,"x-loading"],["au-adaption","","expandedLevel","0",3,"outerHeight","data","nodeHeight","activatedChange"],["treeCom",""],[1,"au-table-right"],["top",""],["type","primary","icon","fto-plus",3,"disabled","click"],["virtualScroll","","loading","",3,"columns","rowHeight","data","size","index","query","bodyHeight","bodyColumnTpl","adaptionHeight","indexChange"],["tableCom",""],["actionsTpl",""],[1,"au-table-actions"],["icon","fto-eye","title","\u67e5\u770b",3,"disabled","click"],["icon","fto-edit","title","\u4fee\u6539",3,"disabled","click"],["icon","fto-trash-2","title","\u5220\u9664",3,"disabled","click"]],template:function(e,t){if(1&e&&(v.Ob(0,"x-inner",0),v.Ob(1,"div",1),v.Ob(2,"h4"),v.wc(3,"\u7ec4\u7ec7\u673a\u6784"),v.Nb(),v.Ob(4,"x-tree",2,3),v.Vb("activatedChange",(function(e){return t.action("tree-info",e)})),v.Nb(),v.Nb(),v.Ob(6,"div",4),v.Ob(7,"au-tool",5),v.Ob(8,"x-button",6),v.Vb("click",(function(){return t.auth.add&&t.action("add")})),v.wc(9,"\u65b0\u589e"),v.Nb(),v.Nb(),v.Ob(10,"x-table",7,8),v.Vb("indexChange",(function(e){return t.index=e})),v.Nb(),v.Nb(),v.Nb(),v.uc(12,S,4,3,"ng-template",null,9,v.vc)),2&e){var n=v.jc(13);v.yb(1),v.ec("x-loading",t.treeLoading),v.yb(3),v.ec("outerHeight",132)("data",t.treeData)("nodeHeight",1.875),v.yb(4),v.ec("disabled",!t.auth.add),v.yb(2),v.ec("columns",t.columns)("rowHeight",35)("data",t.data)("size",20)("index",t.index)("query",t.query)("bodyHeight",100)("bodyColumnTpl",v.gc(14,E,n))("adaptionHeight",138)}},directives:[g.a,w.a,O.a,x.a,k.a,I.a,j.a,A.a],encapsulation:2}),C),R=o("zM0U"),q=o("vtiB"),G=o("OUFp"),X=o("ZQZ3"),F=["form"],M=((z=function(){function e(t,n,i,r,o,a,c,s){var l=this;u(this,e),this.service=t,this.organization=n,this.roles=i,this.setting=r,this.activatedRoute=o,this.message=a,this.nav=c,this.cdr=s,this.config={labelWidth:"6rem"},this.controls=[{control:"input",id:"account",label:"\u7528\u6237",required:!0,maxlength:16,pattern:/^[A-Za-z0-9]{4,16}$/,message:"\u53ea\u80fd\u5305\u62ec\u6570\u5b57\u3001\u5b57\u6bcd\u7684\u7ec4\u5408\uff0c\u957f\u5ea6\u4e3a4-16\u4f4d"},{control:"input",id:"password",label:"\u5bc6\u7801",type:"password",required:!0,maxlength:16,pattern:/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z\\W]{6,18}$/,message:"\u5bc6\u7801\u4e2d\u5fc5\u987b\u5305\u542b\u5b57\u6bcd\u548c\u6570\u5b57\uff0c\u957f\u5ea6\u4e3a6-16\u4f4d"},{control:"input",id:"name",label:"\u59d3\u540d",required:!0},{control:"find",id:"organizations",label:"\u7ec4\u7ec7\u673a\u6784",required:!0,multiple:!0,treeData:function(){return l.organization.getList(1,Number.MAX_SAFE_INTEGER).pipe(Object(f.a)((function(e){return e.list})))}},{control:"find",id:"roles",label:"\u89d2\u8272",required:!0,multiple:!0,treeData:function(){return l.organization.getList(1,Number.MAX_SAFE_INTEGER).pipe(Object(f.a)((function(e){return e.list})))},tableData:function(e,t,n){return l.roles.getList(e,t,n).pipe(Object(f.a)((function(e){var t;return e.list=null===(t=e.list)||void 0===t?void 0:t.map((function(e){return e.label=e.name,e})),e})))},tableColumns:[{id:"index",label:"\u5e8f\u53f7",width:80,left:0,type:"index"},{id:"name",label:"\u89d2\u8272\u540d\u79f0",flex:1,sort:!0}],tableRowHeight:35,treeTableConnect:"organizationId"},{control:"input",id:"email",label:"\u90ae\u7bb1"},{control:"input",id:"phone",label:"\u7535\u8bdd"},{control:"input",id:"id",hidden:!0,value:this.setting.guid()}],this.activatedRoute.paramMap.subscribe((function(e){l.id=e.get("id"),l.type=e.get("type"),l.selected={id:e.get("selectedId"),label:e.get("selectedLabel")},l.selected.id&&(l.controls.find((function(e){return"organizations"===e.id})).value=[l.selected])}))}return c(e,[{key:"ngOnInit",value:function(){this.action(this.type)}},{key:"ngAfterViewInit",value:function(){this.cdr.detectChanges()}},{key:"action",value:function(e){var t=this;switch(e){case"info":this.service.get(this.id).pipe(Object(f.a)((function(e){var t;return e.roles=null===(t=e.roles)||void 0===t?void 0:t.map((function(e){return e.label=e.name,e})),e}))).subscribe((function(e){t.form.formGroup.patchValue(e)}));break;case"edit":this.action("info");break;case"save":if("add"===this.type)this.service.post(this.setForm(this.form.formGroup.value)).subscribe((function(e){t.message.success("\u65b0\u589e\u6210\u529f\uff01"),t.nav.back(!0)}));else if("edit"===this.type){var n=this.setForm(this.form.formGroup.value);this.service.put(n).subscribe((function(e){t.message.success("\u4fee\u6539\u6210\u529f\uff01"),t.nav.back(!0)}))}break;case"cancel":this.nav.back()}}},{key:"setForm",value:function(e){return this.setFind(e,"organizations","roles"),e}},{key:"setFind",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var r=0,o=n;r<o.length;r++){var a=o[r],c=e[a];e[a]=Array.isArray(c)?c.map((function(e){return{id:e.id,label:e.label}})):[{id:c.id,label:c.label}]}return e}},{key:"formInvalid",get:function(){var e,t;return null===(t=null===(e=this.form)||void 0===e?void 0:e.formGroup)||void 0===t?void 0:t.invalid}},{key:"disabled",get:function(){return"info"===this.type}}]),e}()).\u0275fac=function(e){return new(e||z)(v.Ib(l.a),v.Ib(b.a),v.Ib(G.a),v.Ib(R.a),v.Ib(s.a),v.Ib(y.c),v.Ib(q.a),v.Ib(v.h))},z.\u0275cmp=v.Cb({type:z,selectors:[["app-user-detail"]],viewQuery:function(e,t){var n;1&e&&v.Bc(F,!0),2&e&&v.ic(n=v.Wb())&&(t.form=n.first)},decls:9,vars:5,consts:[[1,"au-inner","au-column"],["top",""],[3,"space"],["icon","fto-chevron-left",3,"click"],["icon","fto-save","type","primary",3,"disabled","click"],["au-adaption","","direction","row","labelSuffix",":","labelWidth","6rem","width","24rem","labelAlign","end","span","20","space","2",1,"au-panel","au-overflow-auto",3,"outerHeight","disabled","controls"],["form",""]],template:function(e,t){1&e&&(v.Ob(0,"x-inner",0),v.Ob(1,"au-tool",1),v.Ob(2,"x-buttons",2),v.Ob(3,"x-button",3),v.Vb("click",(function(){return t.action("cancel")})),v.wc(4,"\u8fd4\u56de"),v.Nb(),v.Ob(5,"x-button",4),v.Vb("click",(function(){return!t.formInvalid&&t.action("save")})),v.wc(6," \u4fdd\u5b58 "),v.Nb(),v.Nb(),v.Nb(),v.Jb(7,"x-form",5,6),v.Nb()),2&e&&(v.yb(2),v.ec("space",.5),v.yb(3),v.ec("disabled",t.formInvalid||t.disabled),v.yb(2),v.ec("outerHeight",86)("disabled",t.disabled)("controls",t.controls))},directives:[g.a,k.a,I.c,I.a,X.b,x.a],encapsulation:2,changeDetection:0}),z),T=[{path:"",component:L},{path:":type",component:M},{path:":type/:id",component:M}],D=((H=function e(){u(this,e)}).\u0275mod=v.Gb({type:H}),H.\u0275inj=v.Fb({factory:function(e){return new(e||H)},imports:[[s.i.forChild(T)],s.i]}),H),V=o("gjGi"),P=o("873N"),$=o("iaau"),K=o("hHlV"),W=((_=function e(){u(this,e)}).\u0275mod=v.Gb({type:_}),_.\u0275inj=v.Fb({factory:function(e){return new(e||_)},imports:[[a.c,V.a,K.a,P.a,$.a,D]]}),_)}}])}();