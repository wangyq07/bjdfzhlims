!function(){function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&t(e,n)}function t(e,n){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,n)}function n(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return r(this,n)}}function r(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"873N":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("ofXK"),c=n("fXoL"),o=function(){var e=function e(){a(this,e)};return e.\u0275mod=c.Gb({type:e}),e.\u0275inj=c.Fb({factory:function(t){return new(t||e)},imports:[[r.c]]}),e}()},BzWU:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("LvDl"),c=function(){var e=function(){function e(){a(this,e)}return i(e,null,[{key:"JsNewGuid",value:function(){for(var e="",t=1;t<=32;t++)e+=Math.floor(16*Math.random()).toString(16),8!=t&&12!=t&&16!=t&&20!=t||(e+="-");return e}},{key:"setafterdelete",value:function(e,t){var n=t.findIndex((function(t){return t.id==e}));return t.splice(n,1),n}},{key:"cloneobject",value:function(e){var t={};for(var n in e)t[n]=e[n];return t}},{key:"deepClone",value:function(t){var n={};if(t&&"object"==typeof t)for(var c in t)null!=t[c]&&t.hasOwnProperty(c)&&(n[c]=Object(r.isArray)(t[c])?e.deepcloneobjectarray(t[c]):t[c]&&"object"==typeof t[c]?e.deepClone(t[c]):t[c]);return n}},{key:"deepcloneobjectarray",value:function(t){for(var n=[],r=0;r<t.length;r++)n.push(e.deepClone(t[r]));return n}},{key:"cloneobjectarray",value:function(t){for(var n=[],r=0;r<t.length;r++)n.push(e.cloneobject(t[r]));return n}},{key:"GetRandomStr",value:function(e,t,n){var r="",c=t,o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];e&&(c=Math.round(Math.random()*(n-t))+t);for(var i=0;i<c;i++)r+=o[Math.round(Math.random()*(o.length-1))];return r}},{key:"RndNum",value:function(e){for(var t="",n=0;n<e;n++)t+=Math.floor(10*Math.random());return t}}]),e}();return e.num=e.RndNum(5),e}()},MOn6:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("XNiG"),c=n("3pM9"),o=n("1G5W"),s=n("ofXK"),u=n("fXoL"),l=function(){var e=function(){function e(t,n,c){a(this,e),this.elementRef=t,this.renderer=n,this.doc=c,this.outerHeight=0,this._unSubject=new r.a}return i(e,[{key:"ngAfterViewInit",value:function(){this.setSubject()}},{key:"ngOnDestroy",value:function(){var e;this._unSubject.next(),this._unSubject.unsubscribe(),null===(e=this._resizeObserver)||void 0===e||e.disconnect()}},{key:"setSubject",value:function(){var e=this;Object(c.A)(this.container,this.doc.documentElement).pipe(Object(o.a)(this._unSubject)).subscribe((function(t){e._resizeObserver=t.resizeObserver,e.setAdaptionHeight()}))}},{key:"setAdaptionHeight",value:function(){this.renderer.setStyle(this.elementRef.nativeElement,"height",this.doc.documentElement.clientHeight-this.outerHeight+"px")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(u.Ib(u.l),u.Ib(u.D),u.Ib(s.e))},e.\u0275dir=u.Db({type:e,selectors:[["","au-adaption",""]],inputs:{outerHeight:"outerHeight",container:"container"}}),e}()},XseO:function(t,r,c){"use strict";c.r(r),c.d(r,"TaskdispatchModule",(function(){return L}));var o,s,u,l,d=c("ofXK"),b=c("tyNb"),p=c("wTjX"),h=c("TPaT"),f=c("LZRM"),v=c("GTjD"),y=c("Puy/"),m=c("K7LP"),j=c("BzWU"),w=c("NtM8"),O=c("bRdP"),N=c("fXoL"),k=((o=function(t){e(c,t);var r=n(c);function c(e){var t;return a(this,c),(t=r.call(this,e,{controller:{name:"roletestproject",servicetype:"collectionreceive"}})).http=e,t}return i(c,[{key:"getroletaskdispatchs",value:function(e){var t,n;return this.http.post((null===(t=this.option.controller)||void 0===t?void 0:t.name)+"/getroletaskdispatchs",{contactid:e},null===(n=this.option.controller)||void 0===n?void 0:n.servicetype)}},{key:"addRoleTaskDispatch",value:function(e,t){var n,r;return this.http.post((null===(n=this.option.controller)||void 0===n?void 0:n.name)+"/addroletaskdispatch",{contactid:e,roletestproect:t},null===(r=this.option.controller)||void 0===r?void 0:r.servicetype)}}]),c}(O.a)).\u0275fac=function(e){return new(e||o)(N.Sb(w.a))},o.\u0275prov=N.Eb({token:o,factory:o.\u0275fac,providedIn:"root"}),o),x=c("qMpK"),g=c("SfH5"),C=c("GvSL"),S=c("/pOC"),D=c("MOn6"),P=["projecttreeCom"],I=["treeCom"],R=[{path:"",component:(s=function(t){e(c,t);var r=n(c);function c(e,t,n,o,i,s,u,l,d){var b;return a(this,c),(b=r.call(this,e)).indexService=e,b.flowservice=t,b.service=n,b.sampleservice=o,b.contactservice=i,b.actroute=s,b.router=u,b.globalaudit=l,b.msg=d,b.taskid="",b.treeLoading=!0,b.treeData=[],b.currentRoletest={},b.currentkeys=[],b.taskTreeData=[],b.projects=[],b.delegatecustomer="",b.testcustomer="",b.paycustomer="",b.servicetype="",b.ispanding="",b.seal="",b.samplesource="",b.samples=[],b.testproect=[],b.testprojecthidden="none",b.projecthidden="none",b.samplehidden="none",b.currentSample={},b.currentProject={},b.currentTestProject={},b.contactid="",null!=s&&s.params.subscribe((function(e){b.contactid=e.contactid,b.taskid=e.taskid,b.getData()})),b}return i(c,[{key:"submit",value:function(){var e=this;this.service.addRoleTaskDispatch(this.contactid,this.treeData).subscribe((function(t){e.msg.success("\u5206\u914d\u6210\u529f")}))}},{key:"ngOnInit",value:function(){}},{key:"action",value:function(e){var t,n=this;console.log(e),this.currentRoletest=e,this.projecttreeCom.setCheckedKeys();var r=[];null===(t=e.taskdispatchs)||void 0===t||t.map((function(e){r.push(e.testid)})),this.projecttreeCom.setCheckedKeys(r),this.projecttreeCom.nodes.map((function(t){n.recursionNodeDisable(t,e)}))}},{key:"recursionNodeDisable",value:function(e,t){var n,r,c=this;if(null!=t)if(2==e.level){var o=this.currentkeys.findIndex((function(t){return t==e.id})),i=null===(n=t.taskdispatchs)||void 0===n?void 0:n.findIndex((function(t){return t.testid==e.id}));this.projecttreeCom.updateNode(e,{id:e.id,pid:e.pid,label:e.label,disabled:!1}),null!=o&&-1!=o&&-1==i&&(console.log(i),console.log(o),this.projecttreeCom.updateNode(e,{id:e.id,pid:e.pid,label:e.label,disabled:!0}))}else 2!=e.level&&(null===(r=e.children)||void 0===r||r.map((function(e){c.recursionNodeDisable(e,t)})))}},{key:"checkaction",value:function(e){var t,n,r,c,o=this;if(2==e.level&&e.checked)e.disabled||(this.currentkeys.push(e.id),null===(t=this.currentRoletest.taskdispatchs)||void 0===t||t.push({roleid:this.currentRoletest.id,id:j.a.JsNewGuid(),testid:e.id}));else if(2!=e.level||e.checked)2!=e.level&&(null===(c=e.children)||void 0===c||c.map((function(e){o.checkaction(e)})));else{var i=null===(n=this.currentRoletest.taskdispatchs)||void 0===n?void 0:n.findIndex((function(t){return t.testid==e.id}));null!=i&&-1!=i&&(null===(r=this.currentRoletest.taskdispatchs)||void 0===r||r.splice(i,1)),null!=(i=this.currentkeys.findIndex((function(t){return t==e.id})))&&-1!=i&&this.currentkeys.splice(i,1)}}},{key:"projectaction",value:function(e){switch(this.testprojecthidden="none",this.projecthidden="none",this.samplehidden="none",e.level){case 0:this.projecthidden="inline",this.samplehidden="none",this.testprojecthidden="none",this.currentProject=this.projects.find((function(t){return t.id==e.id}));break;case 1:this.projecthidden="none",this.samplehidden="inline",this.testprojecthidden="none",this.currentSample=this.samples.find((function(t){return t.id==e.id})),null==this.currentSample&&(this.currentSample={}),console.log(this.currentSample);break;case 2:this.projecthidden="none",this.samplehidden="none",this.testprojecthidden="inline",this.currentTestProject=this.testproect.find((function(t){return t.id==e.id})),null==this.currentTestProject&&(this.currentTestProject={});break;default:this.projecthidden="none",this.samplehidden="none",this.testprojecthidden="none"}}},{key:"getData",value:function(){var e=this;this.taskTreeData=[],this.treeData=[],this.service.getroletaskdispatchs(this.contactid).subscribe((function(t){e.contactservice.getcontactproject(e.contactid+"").subscribe((function(n){var r,c;if(e.currentcontact=n.contact,e.projects=n.projects,null!=e.currentcontact&&null!=e.currentcontact.contactcustomers){e.delegatecustomer="",e.testcustomer="",e.paycustomer="";var o=e.currentcontact.contactcustomers.filter((function(e){return 1==e.customertype}));if(o.length>0)for(var i=0;i<o.length;i++)0!=i&&(e.delegatecustomer=e.delegatecustomer+","),e.delegatecustomer=e.delegatecustomer+o[i].customername;var a=e.currentcontact.contactcustomers.find((function(e){return 2==e.customertype}));if(e.paycustomer=(null==a?void 0:a.customername)+"",a=e.currentcontact.contactcustomers.find((function(e){return 3==e.customertype})),e.testcustomer=(null==a?void 0:a.customername)+"",e.servicetype="",e.servicetype=(null===(r=e.currentcontact.service)||void 0===r?void 0:r.label)+"",e.ispanding=1==e.currentcontact.isjudgement?"\u662f":"\u5426",e.seal="",null!=e.currentcontact.seal)for(i=0;i<e.currentcontact.seal.length;i++)e.seal=e.seal+e.currentcontact.seal[i].label+",";e.samplesource=(null===(c=e.currentcontact.samplesource)||void 0===c?void 0:c.label)+"",e.settreeData(),e.treeData=t,e.currentkeys=[],t.map((function(t){e.treeCom.addNode(t),t.taskdispatchs.map((function(t){e.currentkeys.push(t.testid)}))}));var s=e.treeCom.nodes.find((function(t){return t.id==e.treeCom.activatedId}));null!=s&&e.projecttreeCom.nodes.map((function(t){e.recursionNodeDisable(t,s)}))}}))}))}},{key:"settreeData",value:function(){var e=this;this.projects.map((function(t){e.projecttreeCom.addNode({id:t.id,pid:void 0,label:t.projectnumber}),t.samples.map((function(n){e.projecttreeCom.addNode({id:n.id,pid:t.id,label:n.samplename}),e.samples.push(n),n.testprojects.map((function(t){e.testproect.push(t),e.projecttreeCom.addNode({id:t.id,pid:n.id,checked:!1,label:t.testproject})}))}))}))}}]),c}(m.a),s.\u0275fac=function(e){return new(e||s)(N.Ib(p.a),N.Ib(h.a),N.Ib(k),N.Ib(v.a),N.Ib(f.a),N.Ib(b.a),N.Ib(b.e),N.Ib(y.a),N.Ib(x.c))},s.\u0275cmp=N.Cb({type:s,selectors:[["app-taskdispatch"]],viewQuery:function(e,t){var n;1&e&&(N.Bc(P,!0),N.Bc(I,!0)),2&e&&(N.ic(n=N.Wb())&&(t.projecttreeCom=n.first),N.ic(n=N.Wb())&&(t.treeCom=n.first))},features:[N.vb],decls:86,vars:32,consts:[[2,"overflow","auto"],[2,"height","15px"],["icon","ado-check","type","primary","plain","",3,"click"],[2,"height","20px"],["span","12"],["span","6"],["span","4"],[2,"height","30px"],["span","3"],[2,"overflow","scroll","height","680px"],["au-adaption","",3,"data","nodeHeight","activatedChange"],["treeCom",""],["span","5"],[2,"overflow","scroll","height","630px"],["checkbox","","au-adaption","","expandedLevel","0",3,"data","nodeHeight","activatedChange","checkboxChange"],["projecttreeCom",""],["span","14"],["span","15"]],template:function(e,t){1&e&&(N.Ob(0,"div",0),N.Jb(1,"x-row",1),N.Ob(2,"x-row"),N.Ob(3,"x-button",2),N.Vb("click",(function(){return t.submit()})),N.wc(4,"\u63d0\u4ea4"),N.Nb(),N.Nb(),N.Jb(5,"x-row",3),N.Ob(6,"x-row"),N.Ob(7,"x-col",4),N.wc(8),N.Nb(),N.Ob(9,"x-col",5),N.wc(10),N.Nb(),N.Ob(11,"x-col",5),N.wc(12),N.Nb(),N.Nb(),N.Jb(13,"x-row",3),N.Ob(14,"x-row"),N.Ob(15,"x-col",6),N.wc(16),N.Nb(),N.Ob(17,"x-col",6),N.wc(18),N.Nb(),N.Ob(19,"x-col",6),N.wc(20),N.Nb(),N.Ob(21,"x-col",6),N.wc(22),N.Nb(),N.Nb(),N.Jb(23,"x-row",7),N.Ob(24,"x-row"),N.Ob(25,"x-col",8),N.Ob(26,"div",9),N.Ob(27,"h4"),N.wc(28,"\u5de5\u4f5c\u7ec4"),N.Nb(),N.Ob(29,"x-tree",10,11),N.Vb("activatedChange",(function(e){return t.action(e)})),N.Nb(),N.Nb(),N.Nb(),N.Ob(31,"x-col",12),N.Ob(32,"h4"),N.wc(33,"\u9879\u76ee"),N.Nb(),N.Ob(34,"div",13),N.Ob(35,"x-tree",14,15),N.Vb("activatedChange",(function(e){return t.projectaction(e)}))("checkboxChange",(function(e){return t.checkaction(e)})),N.Nb(),N.Nb(),N.Nb(),N.Ob(37,"x-col",16),N.Ob(38,"div"),N.Ob(39,"x-row"),N.Ob(40,"h4"),N.wc(41,"\u9879\u76ee"),N.Nb(),N.Nb(),N.Ob(42,"x-row"),N.Ob(43,"x-col",12),N.wc(44),N.Nb(),N.Ob(45,"x-col",12),N.wc(46),N.Nb(),N.Nb(),N.Ob(47,"x-row"),N.Ob(48,"x-col",12),N.wc(49),N.Nb(),N.Nb(),N.Nb(),N.Nb(),N.Ob(50,"x-col",16),N.Ob(51,"div"),N.Ob(52,"x-row"),N.Ob(53,"h4"),N.wc(54,"\u6837\u54c1"),N.Nb(),N.Nb(),N.Ob(55,"x-row"),N.Ob(56,"x-col",12),N.wc(57),N.Nb(),N.Ob(58,"x-col",12),N.wc(59),N.Nb(),N.Ob(60,"x-col",12),N.wc(61),N.Nb(),N.Ob(62,"x-col",12),N.wc(63),N.Nb(),N.Nb(),N.Ob(64,"x-row"),N.Ob(65,"x-col",12),N.wc(66),N.Nb(),N.Ob(67,"x-col",12),N.wc(68),N.Nb(),N.Ob(69,"x-col",12),N.wc(70),N.Nb(),N.Ob(71,"x-col",12),N.wc(72),N.Nb(),N.Nb(),N.Nb(),N.Nb(),N.Ob(73,"x-col",16),N.Ob(74,"div"),N.Ob(75,"x-row"),N.Ob(76,"h4"),N.wc(77,"\u76d1\u6d4b\u9879\u76ee"),N.Nb(),N.Nb(),N.Ob(78,"x-row"),N.Ob(79,"x-col",12),N.wc(80),N.Nb(),N.Ob(81,"x-col",17),N.wc(82),N.Nb(),N.Nb(),N.Ob(83,"x-row"),N.Ob(84,"x-col",6),N.wc(85),N.Nb(),N.Nb(),N.Nb(),N.Nb(),N.Nb(),N.Nb()),2&e&&(N.yb(8),N.yc("\u59d4\u6258\u5ba2\u6237:",t.delegatecustomer,""),N.yb(2),N.yc("\u4ed8\u6b3e\u5ba2\u6237:",t.paycustomer,""),N.yb(2),N.yc("\u53d7\u68c0\u5ba2\u6237:",t.testcustomer,""),N.yb(4),N.yc("\u6837\u54c1\u6765\u6e90:",t.samplesource,""),N.yb(2),N.yc("\u662f\u5426\u5224\u5b9a:",t.ispanding,""),N.yb(2),N.yc("\u8d44\u8d28\u76d6\u7ae0:",t.seal,""),N.yb(2),N.yc("\u670d\u52a1\u7c7b\u578b:",t.servicetype,""),N.yb(7),N.ec("data",t.treeData)("nodeHeight",1.875),N.yb(6),N.ec("data",t.taskTreeData)("nodeHeight",1.875),N.yb(3),N.rc("display",t.projecthidden),N.yb(6),N.yc("\u7f16\u53f7:",t.currentProject.projectnumber,""),N.yb(2),N.yc("\u9886\u57df:",null==t.currentProject.domain?null:t.currentProject.domain.label,""),N.yb(3),N.yc("\u62a5\u544a:",t.currentProject.reportcount,""),N.yb(2),N.rc("display",t.samplehidden),N.yb(6),N.yc("\u76d1\u6d4b\u7c7b\u578b:",null==t.currentSample.testtype?null:t.currentSample.testtype.label,""),N.yb(2),N.yc("\u6837\u54c1\u72b6\u6001:",null==t.currentSample.status?null:t.currentSample.status.label,""),N.yb(2),N.yc("\u4fdd\u5b58\u72b6\u6001:",null==t.currentSample.store?null:t.currentSample.store.label,""),N.yb(2),N.yc("\u5904\u7406\u65b9\u5f0f:",null==t.currentSample.process?null:t.currentSample.process.label,""),N.yb(3),N.yc("\u6267\u884c\u6807\u51c6:",t.currentSample.executestandard,""),N.yb(2),N.yc("\u6837\u54c1\u7b49\u7ea7:",t.currentSample.executegrade,""),N.yb(2),N.yc("\u6837\u54c1\u6570\u91cf:",t.currentSample.samplequality,""),N.yb(2),N.yc("\u6837\u54c1\u5305\u88c5:",t.currentSample.wrapherproperties,""),N.yb(2),N.rc("display",t.testprojecthidden),N.yb(6),N.yc("\u68c0\u6d4b\u9879\u76ee:",t.currentTestProject.testproject,""),N.yb(2),N.yc("\u68c0\u6d4b\u6807\u51c6:",t.currentTestProject.methodname,""),N.yb(3),N.zc("\u68c0\u6d4b\u9650\u503c:",t.currentTestProject.limitmin,"-",t.currentTestProject.limitmax,""))},directives:[g.c,C.a,g.a,S.a,D.a],styles:[""]}),s)}],T=((u=function e(){a(this,e)}).\u0275mod=N.Gb({type:u}),u.\u0275inj=N.Fb({factory:function(e){return new(e||u)},imports:[[b.i.forChild(R)],b.i]}),u),M=c("hHlV"),H=c("gjGi"),_=c("873N"),G=c("iaau"),L=((l=function e(){a(this,e)}).\u0275mod=N.Gb({type:l}),l.\u0275inj=N.Fb({factory:function(e){return new(e||l)},imports:[[d.c,T,M.a,H.a,S.b,g.b,_.a,G.a]]}),l)},iaau:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("fXoL"),c=function(){var e=function e(){a(this,e)};return e.\u0275mod=r.Gb({type:e}),e.\u0275inj=r.Fb({factory:function(t){return new(t||e)}}),e}()}}])}();