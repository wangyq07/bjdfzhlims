(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"873N":function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var s=r("ofXK"),c=r("fXoL");let i=(()=>{class t{}return t.\u0275mod=c.Gb({type:t}),t.\u0275inj=c.Fb({factory:function(e){return new(e||t)},imports:[[s.c]]}),t})()},BzWU:function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));var s=r("LvDl");let c=(()=>{class t{static JsNewGuid(){for(var t="",e=1;e<=32;e++)t+=Math.floor(16*Math.random()).toString(16),8!=e&&12!=e&&16!=e&&20!=e||(t+="-");return t}static setafterdelete(t,e){var r=e.findIndex(e=>e.id==t);return e.splice(r,1),r}static cloneobject(t){var e={};for(var r in t)e[r]=t[r];return e}static deepClone(e){var r={};if(e&&"object"==typeof e)for(var c in e)null!=e[c]&&e.hasOwnProperty(c)&&(r[c]=Object(s.isArray)(e[c])?t.deepcloneobjectarray(e[c]):e[c]&&"object"==typeof e[c]?t.deepClone(e[c]):e[c]);return r}static deepcloneobjectarray(e){for(var r=[],s=0;s<e.length;s++)r.push(t.deepClone(e[s]));return r}static cloneobjectarray(e){for(var r=[],s=0;s<e.length;s++)r.push(t.cloneobject(e[s]));return r}static GetRandomStr(t,e,r){var s="",c=e,i=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];t&&(c=Math.round(Math.random()*(r-e))+e);for(var o=0;o<c;o++)s+=i[Math.round(Math.random()*(i.length-1))];return s}static RndNum(t){for(var e="",r=0;r<t;r++)e+=Math.floor(10*Math.random());return e}}return t.num=t.RndNum(5),t})()},MOn6:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var s=r("XNiG"),c=r("3pM9"),i=r("1G5W"),o=r("ofXK"),n=r("fXoL");let a=(()=>{class t{constructor(t,e,r){this.elementRef=t,this.renderer=e,this.doc=r,this.outerHeight=0,this._unSubject=new s.a}ngAfterViewInit(){this.setSubject()}ngOnDestroy(){var t;this._unSubject.next(),this._unSubject.unsubscribe(),null===(t=this._resizeObserver)||void 0===t||t.disconnect()}setSubject(){Object(c.A)(this.container,this.doc.documentElement).pipe(Object(i.a)(this._unSubject)).subscribe(t=>{this._resizeObserver=t.resizeObserver,this.setAdaptionHeight()})}setAdaptionHeight(){this.renderer.setStyle(this.elementRef.nativeElement,"height",this.doc.documentElement.clientHeight-this.outerHeight+"px")}}return t.\u0275fac=function(e){return new(e||t)(n.Ib(n.l),n.Ib(n.D),n.Ib(o.e))},t.\u0275dir=n.Db({type:t,selectors:[["","au-adaption",""]],inputs:{outerHeight:"outerHeight",container:"container"}}),t})()},XseO:function(t,e,r){"use strict";r.r(e),r.d(e,"TaskdispatchModule",(function(){return I}));var s=r("ofXK"),c=r("tyNb"),i=r("wTjX"),o=r("TPaT"),n=r("LZRM"),a=r("GTjD"),l=r("Puy/"),d=r("K7LP"),h=r("BzWU"),u=r("NtM8"),b=r("bRdP"),p=r("fXoL");let m=(()=>{class t extends b.a{constructor(t){super(t,{controller:{name:"roletestproject",servicetype:"collectionreceive"}}),this.http=t}getroletaskdispatchs(t){var e,r;return this.http.post((null===(e=this.option.controller)||void 0===e?void 0:e.name)+"/getroletaskdispatchs",{contactid:t},null===(r=this.option.controller)||void 0===r?void 0:r.servicetype)}addRoleTaskDispatch(t,e){var r,s;return this.http.post((null===(r=this.option.controller)||void 0===r?void 0:r.name)+"/addroletaskdispatch",{contactid:t,roletestproect:e},null===(s=this.option.controller)||void 0===s?void 0:s.servicetype)}}return t.\u0275fac=function(e){return new(e||t)(p.Sb(u.a))},t.\u0275prov=p.Eb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var v=r("qMpK"),y=r("SfH5"),f=r("GvSL"),j=r("/pOC"),N=r("MOn6");const w=["projecttreeCom"],x=["treeCom"],O=[{path:"",component:(()=>{class t extends d.a{constructor(t,e,r,s,c,i,o,n,a){super(t),this.indexService=t,this.flowservice=e,this.service=r,this.sampleservice=s,this.contactservice=c,this.actroute=i,this.router=o,this.globalaudit=n,this.msg=a,this.taskid="",this.treeLoading=!0,this.treeData=[],this.currentRoletest={},this.currentkeys=[],this.taskTreeData=[],this.projects=[],this.delegatecustomer="",this.testcustomer="",this.paycustomer="",this.servicetype="",this.ispanding="",this.seal="",this.samplesource="",this.samples=[],this.testproect=[],this.testprojecthidden="none",this.projecthidden="none",this.samplehidden="none",this.currentSample={},this.currentProject={},this.currentTestProject={},this.contactid="",null!=i&&i.params.subscribe(t=>{this.contactid=t.contactid,this.taskid=t.taskid,this.getData()})}submit(){this.service.addRoleTaskDispatch(this.contactid,this.treeData).subscribe(t=>{this.msg.success("\u5206\u914d\u6210\u529f")})}ngOnInit(){}action(t){var e;console.log(t),this.currentRoletest=t,this.projecttreeCom.setCheckedKeys();var r=[];null===(e=t.taskdispatchs)||void 0===e||e.map(t=>{r.push(t.testid)}),this.projecttreeCom.setCheckedKeys(r),this.projecttreeCom.nodes.map(e=>{this.recursionNodeDisable(e,t)})}recursionNodeDisable(t,e){var r,s;if(null!=e)if(2==t.level){var c=this.currentkeys.findIndex(e=>e==t.id),i=null===(r=e.taskdispatchs)||void 0===r?void 0:r.findIndex(e=>e.testid==t.id);this.projecttreeCom.updateNode(t,{id:t.id,pid:t.pid,label:t.label,disabled:!1}),null!=c&&-1!=c&&-1==i&&(console.log(i),console.log(c),this.projecttreeCom.updateNode(t,{id:t.id,pid:t.pid,label:t.label,disabled:!0}))}else 2!=t.level&&(null===(s=t.children)||void 0===s||s.map(t=>{this.recursionNodeDisable(t,e)}))}checkaction(t){var e,r,s,c;if(2==t.level&&t.checked)t.disabled||(this.currentkeys.push(t.id),null===(e=this.currentRoletest.taskdispatchs)||void 0===e||e.push({roleid:this.currentRoletest.id,id:h.a.JsNewGuid(),testid:t.id}));else if(2!=t.level||t.checked)2!=t.level&&(null===(c=t.children)||void 0===c||c.map(t=>{this.checkaction(t)}));else{var i=null===(r=this.currentRoletest.taskdispatchs)||void 0===r?void 0:r.findIndex(e=>e.testid==t.id);null!=i&&-1!=i&&(null===(s=this.currentRoletest.taskdispatchs)||void 0===s||s.splice(i,1)),null!=(i=this.currentkeys.findIndex(e=>e==t.id))&&-1!=i&&this.currentkeys.splice(i,1)}}projectaction(t){switch(this.testprojecthidden="none",this.projecthidden="none",this.samplehidden="none",t.level){case 0:this.projecthidden="inline",this.samplehidden="none",this.testprojecthidden="none",this.currentProject=this.projects.find(e=>e.id==t.id);break;case 1:this.projecthidden="none",this.samplehidden="inline",this.testprojecthidden="none",this.currentSample=this.samples.find(e=>e.id==t.id),null==this.currentSample&&(this.currentSample={}),console.log(this.currentSample);break;case 2:this.projecthidden="none",this.samplehidden="none",this.testprojecthidden="inline",this.currentTestProject=this.testproect.find(e=>e.id==t.id),null==this.currentTestProject&&(this.currentTestProject={});break;default:this.projecthidden="none",this.samplehidden="none",this.testprojecthidden="none"}}getData(){this.taskTreeData=[],this.treeData=[],this.service.getroletaskdispatchs(this.contactid).subscribe(t=>{this.contactservice.getcontactproject(this.contactid+"").subscribe(e=>{var r,s;if(this.currentcontact=e.contact,this.projects=e.projects,null!=this.currentcontact&&null!=this.currentcontact.contactcustomers){this.delegatecustomer="",this.testcustomer="",this.paycustomer="";var c=this.currentcontact.contactcustomers.filter(t=>1==t.customertype);if(c.length>0)for(var i=0;i<c.length;i++)0!=i&&(this.delegatecustomer=this.delegatecustomer+","),this.delegatecustomer=this.delegatecustomer+c[i].customername;var o=this.currentcontact.contactcustomers.find(t=>2==t.customertype);if(this.paycustomer=(null==o?void 0:o.customername)+"",o=this.currentcontact.contactcustomers.find(t=>3==t.customertype),this.testcustomer=(null==o?void 0:o.customername)+"",this.servicetype="",this.servicetype=(null===(r=this.currentcontact.service)||void 0===r?void 0:r.label)+"",this.ispanding=1==this.currentcontact.isjudgement?"\u662f":"\u5426",this.seal="",null!=this.currentcontact.seal)for(i=0;i<this.currentcontact.seal.length;i++)this.seal=this.seal+this.currentcontact.seal[i].label+",";this.samplesource=(null===(s=this.currentcontact.samplesource)||void 0===s?void 0:s.label)+"",this.settreeData(),this.treeData=t,this.currentkeys=[],t.map(t=>{this.treeCom.addNode(t),t.taskdispatchs.map(t=>{this.currentkeys.push(t.testid)})});var n=this.treeCom.nodes.find(t=>t.id==this.treeCom.activatedId);null!=n&&this.projecttreeCom.nodes.map(t=>{this.recursionNodeDisable(t,n)})}})})}settreeData(){this.projects.map(t=>{this.projecttreeCom.addNode({id:t.id,pid:void 0,label:t.projectnumber}),t.samples.map(e=>{this.projecttreeCom.addNode({id:e.id,pid:t.id,label:e.samplename}),this.samples.push(e),e.testprojects.map(t=>{this.testproect.push(t),this.projecttreeCom.addNode({id:t.id,pid:e.id,checked:!1,label:t.testproject})})})})}}return t.\u0275fac=function(e){return new(e||t)(p.Ib(i.a),p.Ib(o.a),p.Ib(m),p.Ib(a.a),p.Ib(n.a),p.Ib(c.a),p.Ib(c.e),p.Ib(l.a),p.Ib(v.c))},t.\u0275cmp=p.Cb({type:t,selectors:[["app-taskdispatch"]],viewQuery:function(t,e){var r;1&t&&(p.Bc(w,!0),p.Bc(x,!0)),2&t&&(p.ic(r=p.Wb())&&(e.projecttreeCom=r.first),p.ic(r=p.Wb())&&(e.treeCom=r.first))},features:[p.vb],decls:86,vars:32,consts:[[2,"overflow","auto"],[2,"height","15px"],["icon","ado-check","type","primary","plain","",3,"click"],[2,"height","20px"],["span","12"],["span","6"],["span","4"],[2,"height","30px"],["span","3"],[2,"overflow","scroll","height","680px"],["au-adaption","",3,"data","nodeHeight","activatedChange"],["treeCom",""],["span","5"],[2,"overflow","scroll","height","630px"],["checkbox","","au-adaption","","expandedLevel","0",3,"data","nodeHeight","activatedChange","checkboxChange"],["projecttreeCom",""],["span","14"],["span","15"]],template:function(t,e){1&t&&(p.Ob(0,"div",0),p.Jb(1,"x-row",1),p.Ob(2,"x-row"),p.Ob(3,"x-button",2),p.Vb("click",(function(){return e.submit()})),p.wc(4,"\u63d0\u4ea4"),p.Nb(),p.Nb(),p.Jb(5,"x-row",3),p.Ob(6,"x-row"),p.Ob(7,"x-col",4),p.wc(8),p.Nb(),p.Ob(9,"x-col",5),p.wc(10),p.Nb(),p.Ob(11,"x-col",5),p.wc(12),p.Nb(),p.Nb(),p.Jb(13,"x-row",3),p.Ob(14,"x-row"),p.Ob(15,"x-col",6),p.wc(16),p.Nb(),p.Ob(17,"x-col",6),p.wc(18),p.Nb(),p.Ob(19,"x-col",6),p.wc(20),p.Nb(),p.Ob(21,"x-col",6),p.wc(22),p.Nb(),p.Nb(),p.Jb(23,"x-row",7),p.Ob(24,"x-row"),p.Ob(25,"x-col",8),p.Ob(26,"div",9),p.Ob(27,"h4"),p.wc(28,"\u5de5\u4f5c\u7ec4"),p.Nb(),p.Ob(29,"x-tree",10,11),p.Vb("activatedChange",(function(t){return e.action(t)})),p.Nb(),p.Nb(),p.Nb(),p.Ob(31,"x-col",12),p.Ob(32,"h4"),p.wc(33,"\u9879\u76ee"),p.Nb(),p.Ob(34,"div",13),p.Ob(35,"x-tree",14,15),p.Vb("activatedChange",(function(t){return e.projectaction(t)}))("checkboxChange",(function(t){return e.checkaction(t)})),p.Nb(),p.Nb(),p.Nb(),p.Ob(37,"x-col",16),p.Ob(38,"div"),p.Ob(39,"x-row"),p.Ob(40,"h4"),p.wc(41,"\u9879\u76ee"),p.Nb(),p.Nb(),p.Ob(42,"x-row"),p.Ob(43,"x-col",12),p.wc(44),p.Nb(),p.Ob(45,"x-col",12),p.wc(46),p.Nb(),p.Nb(),p.Ob(47,"x-row"),p.Ob(48,"x-col",12),p.wc(49),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Ob(50,"x-col",16),p.Ob(51,"div"),p.Ob(52,"x-row"),p.Ob(53,"h4"),p.wc(54,"\u6837\u54c1"),p.Nb(),p.Nb(),p.Ob(55,"x-row"),p.Ob(56,"x-col",12),p.wc(57),p.Nb(),p.Ob(58,"x-col",12),p.wc(59),p.Nb(),p.Ob(60,"x-col",12),p.wc(61),p.Nb(),p.Ob(62,"x-col",12),p.wc(63),p.Nb(),p.Nb(),p.Ob(64,"x-row"),p.Ob(65,"x-col",12),p.wc(66),p.Nb(),p.Ob(67,"x-col",12),p.wc(68),p.Nb(),p.Ob(69,"x-col",12),p.wc(70),p.Nb(),p.Ob(71,"x-col",12),p.wc(72),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Ob(73,"x-col",16),p.Ob(74,"div"),p.Ob(75,"x-row"),p.Ob(76,"h4"),p.wc(77,"\u76d1\u6d4b\u9879\u76ee"),p.Nb(),p.Nb(),p.Ob(78,"x-row"),p.Ob(79,"x-col",12),p.wc(80),p.Nb(),p.Ob(81,"x-col",17),p.wc(82),p.Nb(),p.Nb(),p.Ob(83,"x-row"),p.Ob(84,"x-col",6),p.wc(85),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Nb()),2&t&&(p.yb(8),p.yc("\u59d4\u6258\u5ba2\u6237:",e.delegatecustomer,""),p.yb(2),p.yc("\u4ed8\u6b3e\u5ba2\u6237:",e.paycustomer,""),p.yb(2),p.yc("\u53d7\u68c0\u5ba2\u6237:",e.testcustomer,""),p.yb(4),p.yc("\u6837\u54c1\u6765\u6e90:",e.samplesource,""),p.yb(2),p.yc("\u662f\u5426\u5224\u5b9a:",e.ispanding,""),p.yb(2),p.yc("\u8d44\u8d28\u76d6\u7ae0:",e.seal,""),p.yb(2),p.yc("\u670d\u52a1\u7c7b\u578b:",e.servicetype,""),p.yb(7),p.ec("data",e.treeData)("nodeHeight",1.875),p.yb(6),p.ec("data",e.taskTreeData)("nodeHeight",1.875),p.yb(3),p.rc("display",e.projecthidden),p.yb(6),p.yc("\u7f16\u53f7:",e.currentProject.projectnumber,""),p.yb(2),p.yc("\u9886\u57df:",null==e.currentProject.domain?null:e.currentProject.domain.label,""),p.yb(3),p.yc("\u62a5\u544a:",e.currentProject.reportcount,""),p.yb(2),p.rc("display",e.samplehidden),p.yb(6),p.yc("\u76d1\u6d4b\u7c7b\u578b:",null==e.currentSample.testtype?null:e.currentSample.testtype.label,""),p.yb(2),p.yc("\u6837\u54c1\u72b6\u6001:",null==e.currentSample.status?null:e.currentSample.status.label,""),p.yb(2),p.yc("\u4fdd\u5b58\u72b6\u6001:",null==e.currentSample.store?null:e.currentSample.store.label,""),p.yb(2),p.yc("\u5904\u7406\u65b9\u5f0f:",null==e.currentSample.process?null:e.currentSample.process.label,""),p.yb(3),p.yc("\u6267\u884c\u6807\u51c6:",e.currentSample.executestandard,""),p.yb(2),p.yc("\u6837\u54c1\u7b49\u7ea7:",e.currentSample.executegrade,""),p.yb(2),p.yc("\u6837\u54c1\u6570\u91cf:",e.currentSample.samplequality,""),p.yb(2),p.yc("\u6837\u54c1\u5305\u88c5:",e.currentSample.wrapherproperties,""),p.yb(2),p.rc("display",e.testprojecthidden),p.yb(6),p.yc("\u68c0\u6d4b\u9879\u76ee:",e.currentTestProject.testproject,""),p.yb(2),p.yc("\u68c0\u6d4b\u6807\u51c6:",e.currentTestProject.methodname,""),p.yb(3),p.zc("\u68c0\u6d4b\u9650\u503c:",e.currentTestProject.limitmin,"-",e.currentTestProject.limitmax,""))},directives:[y.c,f.a,y.a,j.a,N.a],styles:[""]}),t})()}];let g=(()=>{class t{}return t.\u0275mod=p.Gb({type:t}),t.\u0275inj=p.Fb({factory:function(e){return new(e||t)},imports:[[c.i.forChild(O)],c.i]}),t})();var k=r("hHlV"),C=r("gjGi"),S=r("873N"),D=r("iaau");let I=(()=>{class t{}return t.\u0275mod=p.Gb({type:t}),t.\u0275inj=p.Fb({factory:function(e){return new(e||t)},imports:[[s.c,g,k.a,C.a,j.b,y.b,S.a,D.a]]}),t})()},iaau:function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));var s=r("fXoL");let c=(()=>{class t{}return t.\u0275mod=s.Gb({type:t}),t.\u0275inj=s.Fb({factory:function(e){return new(e||t)}}),t})()}}]);