(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"873N":function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var i=r("ofXK"),s=r("fXoL");let o=(()=>{class t{}return t.\u0275mod=s.Gb({type:t}),t.\u0275inj=s.Fb({factory:function(e){return new(e||t)},imports:[[i.c]]}),t})()},BzWU:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var i=r("LvDl");let s=(()=>{class t{static JsNewGuid(){for(var t="",e=1;e<=32;e++)t+=Math.floor(16*Math.random()).toString(16),8!=e&&12!=e&&16!=e&&20!=e||(t+="-");return t}static setafterdelete(t,e){var r=e.findIndex(e=>e.id==t);return e.splice(r,1),r}static cloneobject(t){var e={};for(var r in t)e[r]=t[r];return e}static deepClone(e){var r={};if(e&&"object"==typeof e)for(var s in e)null!=e[s]&&e.hasOwnProperty(s)&&(r[s]=Object(i.isArray)(e[s])?t.deepcloneobjectarray(e[s]):e[s]&&"object"==typeof e[s]?t.deepClone(e[s]):e[s]);return r}static deepcloneobjectarray(e){for(var r=[],i=0;i<e.length;i++)r.push(t.deepClone(e[i]));return r}static cloneobjectarray(e){for(var r=[],i=0;i<e.length;i++)r.push(t.cloneobject(e[i]));return r}static GetRandomStr(t,e,r){var i="",s=e,o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];t&&(s=Math.round(Math.random()*(r-e))+e);for(var c=0;c<s;c++)i+=o[Math.round(Math.random()*(o.length-1))];return i}static RndNum(t){for(var e="",r=0;r<t;r++)e+=Math.floor(10*Math.random());return e}}return t.num=t.RndNum(5),t})()},GTjD:function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));var i=r("bRdP"),s=r("NtM8"),o=r("fXoL");let c=(()=>{class t extends i.a{constructor(t){super(t,{controller:{name:"samples",servicetype:"businessprocess"}}),this.http=t}supplimentupdatesamples(t){var e,r;return this.http.post((null===(e=this.option.controller)||void 0===e?void 0:e.name)+"/supplimentupdatesamples",{sampledatas:t},null===(r=this.option.controller)||void 0===r?void 0:r.servicetype)}getsamplestandardprice(t){var e,r;return this.http.post((null===(e=this.option.controller)||void 0===e?void 0:e.name)+"/getsamplestandardprice",{testprojects:t},null===(r=this.option.controller)||void 0===r?void 0:r.servicetype)}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(s.a))},t.\u0275prov=o.Eb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},K7LP:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));class i{constructor(t){this.indexService=t,this.auth={};let e=this.indexService.menuChange.subscribe(t=>{this.baseInit(),e.unsubscribe()})}baseInit(){var t,e,r,i,s;this.menu=null===(e=null===(t=this.indexService.auth.user.permissions)||void 0===t?void 0:t.menus)||void 0===e?void 0:e.find(t=>t.router==this.indexService.session.activatedPage),this.actions=null===(i=null===(r=this.indexService.auth.user.permissions)||void 0===r?void 0:r.actions)||void 0===i?void 0:i.filter(t=>{var e;return t.menuId==(null===(e=this.menu)||void 0===e?void 0:e.id)}),null===(s=this.actions)||void 0===s||s.forEach(t=>this.auth[t.code]=!0)}unAuth(t){return!this.auth[t]}}},LZRM:function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));var i=r("bRdP"),s=r("NtM8"),o=r("fXoL");let c=(()=>{class t extends i.a{constructor(t){super(t,{controller:{name:"contacts",servicetype:"businessprocess"}}),this.http=t}updatecontactinfo(t){var e,r;return this.http.post((null===(e=this.option.controller)||void 0===e?void 0:e.name)+"/updatecontactinfo",t,null===(r=this.option.controller)||void 0===r?void 0:r.servicetype)}getcontactproject(t){var e,r;return this.http.post((null===(e=this.option.controller)||void 0===e?void 0:e.name)+"/getcontactproject",{contactid:t},null===(r=this.option.controller)||void 0===r?void 0:r.servicetype)}addcontactproject(t){var e,r;return this.http.post((null===(e=this.option.controller)||void 0===e?void 0:e.name)+"/addcontactproject",t,null===(r=this.option.controller)||void 0===r?void 0:r.servicetype)}updatecontacttest(t){var e,r;return this.http.post((null===(e=this.option.controller)||void 0===e?void 0:e.name)+"/updatecontacttest",t,null===(r=this.option.controller)||void 0===r?void 0:r.servicetype)}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(s.a))},t.\u0275prov=o.Eb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},MOn6:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var i=r("XNiG"),s=r("3pM9"),o=r("1G5W"),c=r("ofXK"),n=r("fXoL");let a=(()=>{class t{constructor(t,e,r){this.elementRef=t,this.renderer=e,this.doc=r,this.outerHeight=0,this._unSubject=new i.a}ngAfterViewInit(){this.setSubject()}ngOnDestroy(){var t;this._unSubject.next(),this._unSubject.unsubscribe(),null===(t=this._resizeObserver)||void 0===t||t.disconnect()}setSubject(){Object(s.A)(this.container,this.doc.documentElement).pipe(Object(o.a)(this._unSubject)).subscribe(t=>{this._resizeObserver=t.resizeObserver,this.setAdaptionHeight()})}setAdaptionHeight(){this.renderer.setStyle(this.elementRef.nativeElement,"height",this.doc.documentElement.clientHeight-this.outerHeight+"px")}}return t.\u0275fac=function(e){return new(e||t)(n.Ib(n.l),n.Ib(n.D),n.Ib(c.e))},t.\u0275dir=n.Db({type:t,selectors:[["","au-adaption",""]],inputs:{outerHeight:"outerHeight",container:"container"}}),t})()},XseO:function(t,e,r){"use strict";r.r(e),r.d(e,"TaskdispatchModule",(function(){return D}));var i=r("ofXK"),s=r("tyNb"),o=r("wTjX"),c=r("TPaT"),n=r("LZRM"),a=r("GTjD"),l=r("Puy/"),d=r("K7LP"),u=r("BzWU"),h=r("NtM8"),p=r("bRdP"),b=r("fXoL");let v=(()=>{class t extends p.a{constructor(t){super(t,{controller:{name:"roletestproject",servicetype:"collectionreceive"}}),this.http=t}getroletaskdispatchs(t){var e,r;return this.http.post((null===(e=this.option.controller)||void 0===e?void 0:e.name)+"/getroletaskdispatchs",{contactid:t},null===(r=this.option.controller)||void 0===r?void 0:r.servicetype)}addRoleTaskDispatch(t,e){var r,i;return this.http.post((null===(r=this.option.controller)||void 0===r?void 0:r.name)+"/addroletaskdispatch",{contactid:t,roletestproect:e},null===(i=this.option.controller)||void 0===i?void 0:i.servicetype)}}return t.\u0275fac=function(e){return new(e||t)(b.Sb(h.a))},t.\u0275prov=b.Eb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var m=r("qMpK"),y=r("SfH5"),f=r("GvSL"),j=r("/pOC"),x=r("MOn6");const N=["projecttreeCom"],w=["treeCom"],g=[{path:"",component:(()=>{class t extends d.a{constructor(t,e,r,i,s,o,c,n,a){super(t),this.indexService=t,this.flowservice=e,this.service=r,this.sampleservice=i,this.contactservice=s,this.actroute=o,this.router=c,this.globalaudit=n,this.msg=a,this.taskid="",this.treeLoading=!0,this.treeData=[],this.currentRoletest={},this.currentkeys=[],this.taskTreeData=[],this.projects=[],this.delegatecustomer="",this.testcustomer="",this.paycustomer="",this.servicetype="",this.ispanding="",this.seal="",this.samplesource="",this.samples=[],this.testproect=[],this.testprojecthidden="none",this.projecthidden="none",this.samplehidden="none",this.currentSample={},this.currentProject={},this.currentTestProject={},this.contactid="",null!=o&&o.params.subscribe(t=>{this.contactid=t.contactid,this.taskid=t.taskid,this.getData()})}submit(){this.service.addRoleTaskDispatch(this.contactid,this.treeData).subscribe(t=>{this.msg.success("\u5206\u914d\u6210\u529f")})}ngOnInit(){}action(t){var e;console.log(t),this.currentRoletest=t,this.projecttreeCom.setCheckedKeys();var r=[];null===(e=t.taskdispatchs)||void 0===e||e.map(t=>{r.push(t.testid)}),this.projecttreeCom.setCheckedKeys(r),this.projecttreeCom.nodes.map(e=>{this.recursionNodeDisable(e,t)})}recursionNodeDisable(t,e){var r,i;if(null!=e)if(2==t.level){var s=this.currentkeys.findIndex(e=>e==t.id),o=null===(r=e.taskdispatchs)||void 0===r?void 0:r.findIndex(e=>e.testid==t.id);this.projecttreeCom.updateNode(t,{id:t.id,pid:t.pid,label:t.label,disabled:!1}),null!=s&&-1!=s&&-1==o&&(console.log(o),console.log(s),this.projecttreeCom.updateNode(t,{id:t.id,pid:t.pid,label:t.label,disabled:!0}))}else 2!=t.level&&(null===(i=t.children)||void 0===i||i.map(t=>{this.recursionNodeDisable(t,e)}))}checkaction(t){var e,r,i,s;if(2==t.level&&t.checked)t.disabled||(this.currentkeys.push(t.id),null===(e=this.currentRoletest.taskdispatchs)||void 0===e||e.push({roleid:this.currentRoletest.id,id:u.a.JsNewGuid(),testid:t.id}));else if(2!=t.level||t.checked)2!=t.level&&(null===(s=t.children)||void 0===s||s.map(t=>{this.checkaction(t)}));else{var o=null===(r=this.currentRoletest.taskdispatchs)||void 0===r?void 0:r.findIndex(e=>e.testid==t.id);null!=o&&-1!=o&&(null===(i=this.currentRoletest.taskdispatchs)||void 0===i||i.splice(o,1)),null!=(o=this.currentkeys.findIndex(e=>e==t.id))&&-1!=o&&this.currentkeys.splice(o,1)}}projectaction(t){switch(this.testprojecthidden="none",this.projecthidden="none",this.samplehidden="none",t.level){case 0:this.projecthidden="inline",this.samplehidden="none",this.testprojecthidden="none",this.currentProject=this.projects.find(e=>e.id==t.id);break;case 1:this.projecthidden="none",this.samplehidden="inline",this.testprojecthidden="none",this.currentSample=this.samples.find(e=>e.id==t.id),null==this.currentSample&&(this.currentSample={}),console.log(this.currentSample);break;case 2:this.projecthidden="none",this.samplehidden="none",this.testprojecthidden="inline",this.currentTestProject=this.testproect.find(e=>e.id==t.id),null==this.currentTestProject&&(this.currentTestProject={});break;default:this.projecthidden="none",this.samplehidden="none",this.testprojecthidden="none"}}getData(){this.taskTreeData=[],this.treeData=[],this.service.getroletaskdispatchs(this.contactid).subscribe(t=>{this.contactservice.getcontactproject(this.contactid+"").subscribe(e=>{var r,i;if(this.currentcontact=e.contact,this.projects=e.projects,null!=this.currentcontact&&null!=this.currentcontact.contactcustomers){this.delegatecustomer="",this.testcustomer="",this.paycustomer="";var s=this.currentcontact.contactcustomers.filter(t=>1==t.customertype);if(s.length>0)for(var o=0;o<s.length;o++)0!=o&&(this.delegatecustomer=this.delegatecustomer+","),this.delegatecustomer=this.delegatecustomer+s[o].customername;var c=this.currentcontact.contactcustomers.find(t=>2==t.customertype);if(this.paycustomer=(null==c?void 0:c.customername)+"",c=this.currentcontact.contactcustomers.find(t=>3==t.customertype),this.testcustomer=(null==c?void 0:c.customername)+"",this.servicetype="",this.servicetype=(null===(r=this.currentcontact.service)||void 0===r?void 0:r.label)+"",this.ispanding=1==this.currentcontact.isjudgement?"\u662f":"\u5426",this.seal="",null!=this.currentcontact.seal)for(o=0;o<this.currentcontact.seal.length;o++)this.seal=this.seal+this.currentcontact.seal[o].label+",";this.samplesource=(null===(i=this.currentcontact.samplesource)||void 0===i?void 0:i.label)+"",this.settreeData(),this.treeData=t,this.currentkeys=[],t.map(t=>{this.treeCom.addNode(t),t.taskdispatchs.map(t=>{this.currentkeys.push(t.testid)})});var n=this.treeCom.nodes.find(t=>t.id==this.treeCom.activatedId);null!=n&&this.projecttreeCom.nodes.map(t=>{this.recursionNodeDisable(t,n)})}})})}settreeData(){this.projects.map(t=>{this.projecttreeCom.addNode({id:t.id,pid:void 0,label:t.projectnumber}),t.samples.map(e=>{this.projecttreeCom.addNode({id:e.id,pid:t.id,label:e.samplename}),this.samples.push(e),e.testprojects.map(t=>{this.testproect.push(t),this.projecttreeCom.addNode({id:t.id,pid:e.id,checked:!1,label:t.testproject})})})})}}return t.\u0275fac=function(e){return new(e||t)(b.Ib(o.a),b.Ib(c.a),b.Ib(v),b.Ib(a.a),b.Ib(n.a),b.Ib(s.a),b.Ib(s.e),b.Ib(l.a),b.Ib(m.c))},t.\u0275cmp=b.Cb({type:t,selectors:[["app-taskdispatch"]],viewQuery:function(t,e){var r;1&t&&(b.Bc(N,!0),b.Bc(w,!0)),2&t&&(b.ic(r=b.Wb())&&(e.projecttreeCom=r.first),b.ic(r=b.Wb())&&(e.treeCom=r.first))},features:[b.vb],decls:86,vars:32,consts:[[2,"overflow","auto"],[2,"height","15px"],["icon","ado-check","type","primary","plain","",3,"click"],[2,"height","20px"],["span","12"],["span","6"],["span","4"],[2,"height","30px"],["span","3"],[2,"overflow","scroll","height","680px"],["au-adaption","",3,"data","nodeHeight","activatedChange"],["treeCom",""],["span","5"],[2,"overflow","scroll","height","630px"],["checkbox","","au-adaption","","expandedLevel","0",3,"data","nodeHeight","activatedChange","checkboxChange"],["projecttreeCom",""],["span","14"],["span","15"]],template:function(t,e){1&t&&(b.Ob(0,"div",0),b.Jb(1,"x-row",1),b.Ob(2,"x-row"),b.Ob(3,"x-button",2),b.Vb("click",(function(){return e.submit()})),b.wc(4,"\u63d0\u4ea4"),b.Nb(),b.Nb(),b.Jb(5,"x-row",3),b.Ob(6,"x-row"),b.Ob(7,"x-col",4),b.wc(8),b.Nb(),b.Ob(9,"x-col",5),b.wc(10),b.Nb(),b.Ob(11,"x-col",5),b.wc(12),b.Nb(),b.Nb(),b.Jb(13,"x-row",3),b.Ob(14,"x-row"),b.Ob(15,"x-col",6),b.wc(16),b.Nb(),b.Ob(17,"x-col",6),b.wc(18),b.Nb(),b.Ob(19,"x-col",6),b.wc(20),b.Nb(),b.Ob(21,"x-col",6),b.wc(22),b.Nb(),b.Nb(),b.Jb(23,"x-row",7),b.Ob(24,"x-row"),b.Ob(25,"x-col",8),b.Ob(26,"div",9),b.Ob(27,"h4"),b.wc(28,"\u5de5\u4f5c\u7ec4"),b.Nb(),b.Ob(29,"x-tree",10,11),b.Vb("activatedChange",(function(t){return e.action(t)})),b.Nb(),b.Nb(),b.Nb(),b.Ob(31,"x-col",12),b.Ob(32,"h4"),b.wc(33,"\u9879\u76ee"),b.Nb(),b.Ob(34,"div",13),b.Ob(35,"x-tree",14,15),b.Vb("activatedChange",(function(t){return e.projectaction(t)}))("checkboxChange",(function(t){return e.checkaction(t)})),b.Nb(),b.Nb(),b.Nb(),b.Ob(37,"x-col",16),b.Ob(38,"div"),b.Ob(39,"x-row"),b.Ob(40,"h4"),b.wc(41,"\u9879\u76ee"),b.Nb(),b.Nb(),b.Ob(42,"x-row"),b.Ob(43,"x-col",12),b.wc(44),b.Nb(),b.Ob(45,"x-col",12),b.wc(46),b.Nb(),b.Nb(),b.Ob(47,"x-row"),b.Ob(48,"x-col",12),b.wc(49),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Ob(50,"x-col",16),b.Ob(51,"div"),b.Ob(52,"x-row"),b.Ob(53,"h4"),b.wc(54,"\u6837\u54c1"),b.Nb(),b.Nb(),b.Ob(55,"x-row"),b.Ob(56,"x-col",12),b.wc(57),b.Nb(),b.Ob(58,"x-col",12),b.wc(59),b.Nb(),b.Ob(60,"x-col",12),b.wc(61),b.Nb(),b.Ob(62,"x-col",12),b.wc(63),b.Nb(),b.Nb(),b.Ob(64,"x-row"),b.Ob(65,"x-col",12),b.wc(66),b.Nb(),b.Ob(67,"x-col",12),b.wc(68),b.Nb(),b.Ob(69,"x-col",12),b.wc(70),b.Nb(),b.Ob(71,"x-col",12),b.wc(72),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Ob(73,"x-col",16),b.Ob(74,"div"),b.Ob(75,"x-row"),b.Ob(76,"h4"),b.wc(77,"\u76d1\u6d4b\u9879\u76ee"),b.Nb(),b.Nb(),b.Ob(78,"x-row"),b.Ob(79,"x-col",12),b.wc(80),b.Nb(),b.Ob(81,"x-col",17),b.wc(82),b.Nb(),b.Nb(),b.Ob(83,"x-row"),b.Ob(84,"x-col",6),b.wc(85),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Nb()),2&t&&(b.yb(8),b.yc("\u59d4\u6258\u5ba2\u6237:",e.delegatecustomer,""),b.yb(2),b.yc("\u4ed8\u6b3e\u5ba2\u6237:",e.paycustomer,""),b.yb(2),b.yc("\u53d7\u68c0\u5ba2\u6237:",e.testcustomer,""),b.yb(4),b.yc("\u6837\u54c1\u6765\u6e90:",e.samplesource,""),b.yb(2),b.yc("\u662f\u5426\u5224\u5b9a:",e.ispanding,""),b.yb(2),b.yc("\u8d44\u8d28\u76d6\u7ae0:",e.seal,""),b.yb(2),b.yc("\u670d\u52a1\u7c7b\u578b:",e.servicetype,""),b.yb(7),b.ec("data",e.treeData)("nodeHeight",1.875),b.yb(6),b.ec("data",e.taskTreeData)("nodeHeight",1.875),b.yb(3),b.rc("display",e.projecthidden),b.yb(6),b.yc("\u7f16\u53f7:",e.currentProject.projectnumber,""),b.yb(2),b.yc("\u9886\u57df:",null==e.currentProject.domain?null:e.currentProject.domain.label,""),b.yb(3),b.yc("\u62a5\u544a:",e.currentProject.reportcount,""),b.yb(2),b.rc("display",e.samplehidden),b.yb(6),b.yc("\u76d1\u6d4b\u7c7b\u578b:",null==e.currentSample.testtype?null:e.currentSample.testtype.label,""),b.yb(2),b.yc("\u6837\u54c1\u72b6\u6001:",null==e.currentSample.status?null:e.currentSample.status.label,""),b.yb(2),b.yc("\u4fdd\u5b58\u72b6\u6001:",null==e.currentSample.store?null:e.currentSample.store.label,""),b.yb(2),b.yc("\u5904\u7406\u65b9\u5f0f:",null==e.currentSample.process?null:e.currentSample.process.label,""),b.yb(3),b.yc("\u6267\u884c\u6807\u51c6:",e.currentSample.executestandard,""),b.yb(2),b.yc("\u6837\u54c1\u7b49\u7ea7:",e.currentSample.executegrade,""),b.yb(2),b.yc("\u6837\u54c1\u6570\u91cf:",e.currentSample.samplequality,""),b.yb(2),b.yc("\u6837\u54c1\u5305\u88c5:",e.currentSample.wrapherproperties,""),b.yb(2),b.rc("display",e.testprojecthidden),b.yb(6),b.yc("\u68c0\u6d4b\u9879\u76ee:",e.currentTestProject.testproject,""),b.yb(2),b.yc("\u68c0\u6d4b\u6807\u51c6:",e.currentTestProject.methodname,""),b.yb(3),b.zc("\u68c0\u6d4b\u9650\u503c:",e.currentTestProject.limitmin,"-",e.currentTestProject.limitmax,""))},directives:[y.c,f.a,y.a,j.a,x.a],styles:[""]}),t})()}];let O=(()=>{class t{}return t.\u0275mod=b.Gb({type:t}),t.\u0275inj=b.Fb({factory:function(e){return new(e||t)},imports:[[s.i.forChild(g)],s.i]}),t})();var k=r("hHlV"),S=r("gjGi"),C=r("873N"),I=r("iaau");let D=(()=>{class t{}return t.\u0275mod=b.Gb({type:t}),t.\u0275inj=b.Fb({factory:function(e){return new(e||t)},imports:[[i.c,O,k.a,S.a,j.b,y.b,C.a,I.a]]}),t})()},iaau:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var i=r("fXoL");let s=(()=>{class t{}return t.\u0275mod=i.Gb({type:t}),t.\u0275inj=i.Fb({factory:function(e){return new(e||t)}}),t})()}}]);